{"posts":[{"title":"æ€æ­»ä¸€åªçŸ¥æ›´é¸Ÿè¯»ä¹¦æ„Ÿæ‚Ÿ","content":"æœ€è¿‘åœ¨é—²æš‡æ—¶é—´è¯»äº†ç¾å›½ä½œå®¶å“ˆç€Â·æçš„æˆåä½œã€Šæ€æ­»ä¸€åªçŸ¥æ›´é¸Ÿã€‹ï¼Œè¿™æ˜¯ä¸€æœ¬è¶Šè¯»è¶Šèƒ½æ„Ÿå—åˆ°å¾ˆæ£’çš„ä½œå“ã€‚è¿™ä¸ªæ•…äº‹è®²çš„æ˜¯ä¸€äº›å…³äºç§æ—æ­§è§†çš„ï¼Œæ•…äº‹å‘ç”Ÿçš„æ—¶æœŸè™½ç„¶å·²ç»è·ç¦»å—åŒ—æˆ˜äº‰å¾ˆä¹…äº†ï¼Œä½†é‚£æ—¶å€™ä»ç„¶æœ‰ä¸€éƒ¨åˆ†äººæŠŠé»‘äººç§°ä¸º&quot;é»‘é¬¼&quot;ã€‚å…¶å®æˆ‘åœ¨æœ¬ä¹¦æ›´å¤šè¯»åˆ°çš„æ˜¯å…³äºæ•™å…»ã€æ¶µå…»ä¸å‹‡æ•¢ï¼Œæˆ‘æœ€å–œæ¬¢æ–‡ä¸­å¥³ä¸»äººå…¬çš„çˆ¶äº²-é˜¿è¿ªå…‹æ–¯ï¼Œåœ¨ä»–èº«ä¸Šæœ‰ç€ä¼˜ç§€çš„å“è´¨ä¸å‹‡æ•¢ï¼Œå¯¹äºå­©å­çš„å½±å“ä¹Ÿå¾ˆå¤§ï¼Œè¿™æ‰æ˜¯çœŸæ­£ä½“ä¼šåˆ°çˆ¶æ¯æ˜¯å­©å­æœ€å¥½çš„è€å¸ˆã€‚ å°è¯´ä¸»è¦æ˜¯é€šè¿‡ä¸€ä¸ª5å²çš„å°å¥³å­©å™è¿°çš„ï¼Œè¿™ä¸ªå°å¥³å­©å«æ–¯åº“ç‰¹ï¼Œæˆ‘è§‰å¾—å†™çš„å¾ˆå¥½çš„åœ°æ–¹å°±åœ¨äºå¾ˆå¤šåœ°æ–¹å¾ˆå·§å¦™ï¼Œä¹Ÿç•™ç»™è¯»è€…æ€è€ƒçš„ç©ºé—´ï¼Œæ˜¯ä¸€ä¸ªå°å¥³å­©å¯¹å½“æ—¶äº‹ç‰©çš„çœ‹æ³•ï¼Œæœ‰æ—¶å€™çœŸçš„å¾ˆæ„Ÿå¹5å²çš„æ—¶å€™å¯ä»¥æœ‰è¿™äº›ç¨€å¥‡å¤æ€ªçš„æƒ³æ³•ï¼Œå¥½åƒè‡ªå·±åœ¨5å²çš„æ—¶å€™ä»€ä¹ˆéƒ½ä¸ä¼šæƒ³ã€‚æ•…äº‹è®²è¿°çš„æ˜¯ä¸€åä½œä¸ºå¾‹å¸ˆçš„çˆ¶äº²ï¼Œåœ¨æ¥å—äº†ä¸ºä¸€åé»‘äººè¾©æŠ¤çš„æ¡ˆä»¶ä¸­ä¸æ–­ç»å†èº«è¾¹çš„äººçš„ä¸€äº›ä¸å¥½çš„çœ‹æ³•ï¼Œç”šè‡³å­©å­ä¹Ÿå› æ­¤å—åˆ°åŒå­¦çš„å†·çœ¼ç›¸å¯¹ï¼Œä½†æ˜¯çˆ¶äº²å§‹ç»ˆè¡¨ç°çš„å¾ˆç»…å£«ï¼Œå¹¶ä¸”å‹‡æ•¢æ·¡ç„¶çš„é¢å¯¹ã€‚ å…³äºçˆ¶äº²çš„æ¶µå…»ï¼Œæˆ‘è§‰å¾—ä¸€ä¸ªäººå¦‚æœæ˜¯å¾ˆæœ‰æ¶µå…»æ˜¯ä¼šå½±å“èº«è¾¹çš„å®¶äººçš„ã€‚å°è¯´ä¸­çš„æ–¯åº“ç‰¹è¿˜æœ‰ä¸€ä¸ªå“¥å“¥ï¼Œå¥¹ä»¬å®¶é‡Œè¿˜æœ‰ä¸€ä¸ªé»‘äººå®¶åº­ä¿å§†åå«å¡æ³¢å¦®ï¼Œåœ¨å¥¹ä»¬å®¶é‡Œçš„ç›¸å¤„çš„éå¸¸èæ´½ï¼Œå¥¹ä»¬ä¸€å®¶äººå®Œå…¨ä¿¡ä»»å¡æ³¢å¦®ï¼Œå¡æ³¢å¦®ä¹Ÿå®Œå…¨è§‰å¾—è‡ªå·±æ˜¯å®¶é‡Œçš„ä¸€ä»½å­ï¼Œæ‚‰å¿ƒç…§æ–™ï¼ŒæŠŠå®¶é‡Œçš„ä¸€åˆ‡æ­ç†å¥½ä¹‹ä½™ï¼Œåœ¨ä¸¤ä¸ªå­©å­çš„æ•™è‚²ä¸Šä¹Ÿéƒ½èƒ½æœ‰æ­£ç¡®çš„å¼•å¯¼ã€‚ä¾‹å¦‚æ–‡ä¸­å†™åˆ°ï¼Œå°å¥³å­©å«åŒå­¦å»å®¶é‡Œåƒé¥­ï¼Œåœ¨å®¶é‡Œåƒé¥­å‰å’Œè¿™ä¸ªåŒå­¦æ‰“äº†ä¸€æ¶ï¼Œç„¶åå½“è¿™ä¸ªåŒå­¦åƒäº†ä¸€ç½ç³–æµ†åï¼Œå¼€å§‹æŠ±æ€¨åŒå­¦ï¼Œç„¶åå¡æ³¢å¦®æŠŠæ–¯åº“ç‰¹å«åˆ°å¨æˆ¿å¹¶å¯¹å¥¹è¯´ï¼šâ€œæœ‰äº›äººä¸åƒæˆ‘ä»¬è¿™æ ·åƒé¥­ï¼Œå¯æ˜¯ä½ ä¸èƒ½åœ¨é¥­æ¡Œä¸Šç»™äººå®¶å½“é¢æŒ‡å‡ºæ¥ã€‚é‚£å­©å­æ˜¯ä½ çš„å®¢äººï¼Œå°±ç®—ä»–è¦åƒæ¡Œå¸ƒï¼Œä½ ä¹Ÿè¦éšä»–ä¾¿ã€‚â€ç„¶åæ–¯åº“ç‰¹è¯´ï¼šâ€œä»–ä¸æ˜¯å®¢äººï¼Œä»–åªæ˜¯ä¸€ä¸ªåå®å®‰å®¶çš„äººâ€ï¼Œç„¶åå¡æ³¢å¦®ç”Ÿæ°”çš„æ‰“æ–­åˆ°â€œä½ ç»™æˆ‘é—­å˜´ï¼ä¸ç®¡ä»–æ˜¯è°ï¼Œåªè¦è¸è¿›è¿™å®¶é—¨ï¼Œå°±æ˜¯ä½ çš„å®¢äººã€‚åˆ«å†è®©æˆ‘é€®åˆ°ä½ åˆå¯¹äººå®¶è¯´ä¸‰é“å››ï¼Œå¥½åƒä½ æœ‰å¤šé«˜è´µä¼¼çš„ï¼ä½ ä»¬å®¶äººä¹Ÿè®¸æ¯”åå®å®‰å®¶çš„äººè¦å¥½ï¼Œå¯æ˜¯ä½ è¿™æ ·ç¾è¾±äººå®¶ï¼Œå°±æ˜¯ä¸€é’±ä¸å€¼ï¼â€ã€‚æ‰€ä»¥æˆ‘è§‰å¾—å­©å­èƒ½æ˜äº‹ç†ï¼Œæ˜¯ç¦»ä¸å¼€èº«è¾¹çš„æ•™è‚²ä¸å½±å“çš„ï¼Œåœ¨åé¢è¿˜æœ‰ä¸¤ä¸ªæ®µè½è®©æˆ‘å¾ˆæ·±åˆ»ï¼Œä¸€ä¸ªæ˜¯åœ¨å¡æ³¢å¦®ç»™å¥¹ç©¿äº†ä¸€ä»¶å¹²å‡€æ•´æ´çš„è¡£æœçš„æ—¶å€™ï¼Œå¥¹åœ¨åšäº‹çš„æ—¶å€™å°å¿ƒç¿¼ç¿¼çš„æ€•å¼„è„äº†è¡£æœï¼Œå› ä¸ºé‚£æ ·å¡æ³¢å¦®å°±ä¼šé‡æ–°åœ¨æ´—çƒ«ä¸€éï¼Œè€Œä¸”é‚£æ—¶å€™å¡æ³¢å¦®å·²ç»å¤Ÿå¿™äº†ã€‚è¿˜æœ‰ä¸€æ®µæ˜¯åœ¨çˆ¶äº²åšäº†é»‘äººçš„è¾©æŠ¤å¾‹å¸ˆåï¼Œæ–¯åº“ç‰¹åˆ°å­¦æ ¡è¢«åŒå­¦å˜²ç¬‘ï¼Œå¥¹æœ¬æƒ³å¥½å¥½ä¿®ç†ä¸€é¡¿åŒå­¦ï¼Œä½†æ˜¯è®©å¥¹ä¸è¿™ä¹ˆåšçš„åŸå› æ˜¯å› ä¸ºçˆ¶äº²å‘Šè¯‰äº†å¥¹ä¸å…è®¸å› ä¸ºè¿™ä»¶äº‹å’Œåˆ«äººæ‰“æ¶ï¼Œå¥¹ç­”åº”äº†ï¼Œå¥¹æ€•è¿èƒŒç­”åº”çˆ¶äº²çš„è¯è€Œè®©çˆ¶äº²ä¼¤å¿ƒã€‚è€Œä¸”æˆ‘è®¤ä¸ºé˜¿è¿ªå…‹æ–¯æ˜¯ä¸€ä¸ªçœŸæ­£çš„å›å­ï¼Œåœ¨é‡åˆ°äº‹æƒ…ä¸ä½†æ²‰ç€å†·é™ï¼Œè¿˜æœ‰å‹‡æ•¢ä¸æ¸©æƒ…ï¼Œå¯¹ä»»ä½•äººæˆ–äº‹éƒ½å¾ˆæ¸©æš–ï¼Œä¾‹å¦‚æ™šä¸Šå¿«å›åˆ°å®¶çš„æ—¶å€™ä¼šæå‰ç†„ç­æ±½è½¦çš„å‘åŠ¨æœºæ¥æŠŠè½¦æºœå›å»ï¼Œå°±æ˜¯æ€•æ‰“æ‰°å®¶äººã€‚ å…³äºæ•™å…»ä»¥åŠå¯¹å­©å­çš„æ•™è‚²ä¸Šï¼Œé˜¿è¿ªå…‹æ–¯ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ¦œæ ·ï¼Œåœ¨å­©å­å»è°ƒçš®çš„å¯¹é‚»å±…åšå‡ºæ¶ä½œå‰§çš„æ—¶å€™ï¼Œä¼šå‘Šè¯‰å­©å­è¦å¦‚ä½•å°Šé‡åˆ«äººã€‚è¿˜æœ‰æ–‡ä¸­æœ€åçˆ¶äº²ä¸æƒ³ä¸ºäº†è®©å­©å­é€ƒé¿è´£ä»»è€Œéšç’çœŸç›¸æ‰€è¯´çš„è¯ï¼šâ€œä½ ä¹Ÿæœ‰å­©å­ï¼Œåªä¸è¿‡æˆ‘å¹´é¾„æ¯”ä½ å¤§ã€‚ç­‰æˆ‘çš„å­©å­é•¿å¤§æˆäººä¹‹åï¼Œå¦‚æœæˆ‘è¿˜æ´»ç€ï¼Œä¹Ÿå·²ç»æ˜¯ä¸ªè€å®¶ä¼™äº†ï¼Œå¯ç°åœ¨æˆ‘â€”â€”å¦‚æœä»–ä»¬ä¸ä¿¡ä»»æˆ‘ï¼Œä¹Ÿå°±ä¸ä¼šä¿¡ä»»ä»»ä½•äººã€‚æ°å§†å’Œæ–¯åº“ç‰¹çŸ¥é“å½“æ—¶å‘ç”Ÿäº†ä»€ä¹ˆã€‚å¦‚æœä»–ä»¬å¬è§æˆ‘åœ¨é•‡ä¸Šè®²çš„æ˜¯å¦ä¸€ä¸ªæ•…äº‹â€”â€”èµ«å…‹ï¼Œé‚£æ ·æˆ‘å°±ä¼šæ°¸è¿œå¤±å»ä»–ä»¬å•Šã€‚æˆ‘ç»å¯¹ä¸èƒ½å®¶é‡Œä¸€å¥—å¤–é¢ä¸€å¥—ã€‚â€æœ‰å¤šå°‘å®¶é•¿æ•™è‚²å­©å­çš„è¯è¿è‡ªå·±éƒ½åšä¸åˆ°ã€‚è¿˜æœ‰æ–‡ä¸­å½“å“¥å“¥æ°å§†å› ä¸ºæ³•åº­çš„ä¸å…¬å¹³åˆ¤å†³è€Œå¯¹æ–¯åº“ç‰¹å‘ç«çš„æ—¶å€™ï¼Œçˆ¶äº²å¯¹å¥³å„¿è¯´ï¼šâ€œæ°å§†åœ¨åŠªåŠ›å¿˜æ‰ä¸€äº›äº‹æƒ…ï¼Œå¯å®é™…ä¸Šåªæ˜¯æš‚æ—¶æ”¾åœ¨ä¸€è¾¹ã€‚ç­‰è¿‡ä¸€æ®µæ—¶é—´ï¼Œä»–å°±ä¼šé‡æ–°æ€è€ƒè¿™ä¸€åˆ‡ï¼ŒæŠŠäº‹æƒ…æƒ³ä¸ªæ˜ç™½ã€‚ç­‰ä»–å¯ä»¥çµå¢ƒæ€è€ƒé—®é¢˜çš„æ—¶å€™ï¼Œå°±ä¼šæ¢å¤è‡ªå·±åŸæ¥çš„æ ·å­â€ã€‚æˆ‘è§‰å¾—è¿™æ®µè¯å……åˆ†ä½“ç°äº†çˆ¶äº²æ˜¯ç†è§£å­©å­å½“æ—¶çš„å¿ƒæƒ…ï¼Œè€Œåœ¨é‡åˆ°è¿™ç§äº‹æƒ…çš„æ—¶å€™çˆ¶äº²çš„æ€åº¦ä¸æ˜¯é€ƒé¿ä¹Ÿä¸æ˜¯æ¬ºéª—è‡ªå·±ï¼Œè€Œä¸”è‡ªå·±å»åŠªåŠ›ï¼Œç„¶åæŠŠåŠªåŠ›çš„ç»“æœå‘Šè¯‰å­©å­ä»¬ï¼Œåœ¨æœ‰å¸Œæœ›çš„æ—¶å€™å°±å‘Šè¯‰å­©å­ä»¬æœ‰å¸Œæœ›ï¼Œåœ¨ä¸éœ€è¦æ‹…å¿ƒçš„æ—¶å€™å°±å‘Šè¯‰å­©å­è¿˜ä¸æ˜¯è¯¥æ‹…å¿ƒçš„æ—¶å€™ã€‚ æœ€åæˆ‘è¦è¯´çš„æ˜¯å…³äºå‹‡æ•¢ï¼Œæˆ‘è®¤ä¸ºæ–‡ä¸­çš„é˜¿è¿ªå…‹æ–¯ï¼Œæ˜¯ä¸æƒ³æ¥è¿™ä¸ªè¾©æŠ¤é»‘äººçš„æ¡ˆå­çš„ï¼Œä½†æ˜¯åœ¨ä»–æ¥äº†ä¹‹åï¼Œå¹¶äº†è§£çš„çœŸæƒ³ä¹‹åï¼Œåœ¨å½“æ—¶å‘¨å›´çš„éƒ¨åˆ†äººéƒ½å¯¹ä»–å†·è¨€å†·è¯­çš„æƒ…å†µä¸‹ï¼Œä»–ä¾ç„¶ä¹‰æ— åé¡¾çš„å»ç»´æŠ¤é»‘äººï¼Œå»ç»´æŠ¤æ­£ä¹‰ï¼Œå¹¶åœ¨æ¥å—åˆ°ä¸å…¬å¹³çš„åˆ¤å†³ä¸å¨èƒä¹‹åä¾ç„¶è¦ä¸Šè¯‰\bï¼Œæˆ‘è§‰å¾—æ— è®ºæ˜¯èˆ†è®ºã€å¨èƒè¿˜æ˜¯å…¶ä»–å› ç´ ä¸‹éƒ½éœ€è¦å¾ˆå¤§çš„å‹‡æ°”æ¥é¢å¯¹ï¼Œè€Œä¸”å¥¹çŸ¥é“ä»–è¿™ä¹ˆåšä¼šå¸¦æ¥çš„å¯èƒ½æ˜¯å¤±è´¥ä¸åˆ«äººçš„è®®è®ºï¼Œæˆ–è€…æ˜¯æ›´å¤§çš„é£æ³¢ã€‚æ­£æ˜¯å› ä¸ºçˆ¶äº²çš„å‹‡æ•¢ï¼Œæ‰€ä»¥å­©å­ä»¬ä¹Ÿæ˜¯å‹‡æ•¢çš„ï¼Œåœ¨çˆ¶äº²é¢ä¸´å±é™©çš„æ—¶å€™å‹‡æ•¢çš„å†²å‡ºå»ç»´æŠ¤è‡ªå·±çš„çˆ¶äº²ï¼Œåœ¨çˆ¶äº²å¿™çš„æ—¶å€™ä¸è®©çˆ¶äº²æ‹…å¿ƒæ¥è‡ªå·±é¢å¯¹è¯¥é¢å¯¹çš„äº‹ã€‚ å…¶å®æ–‡ä¸­è¿˜æœ‰å¾ˆå¤šäººç‰©å’Œå€¼å¾—æˆ‘ä»¬æ·±æ€çš„åœ°æ–¹ï¼Œæœ¬æ–‡æ˜¯æƒ³ç»™è‡ªå·±åšä¸€ä¸ªè¯»ä¹¦ç¬”è®°ä¸æ„Ÿæ‚Ÿã€‚ ","link":"http://xuanguofeng.com/post/ssyzzgn/"},{"title":"é—®é¢˜æ—¥å¿—-RecyclerViewåœ¨notifyæ—¶ç„¦ç‚¹ä¸¢å¤±","content":"åœ¨è¿›è¡ŒTVå¼€å‘çš„æ—¶å€™ç»å¸¸éœ€è¦å¤„ç†ç„¦ç‚¹é—®é¢˜ã€‚æœ€è¿‘å‘ç°åœ¨RecyclerViewåˆ—è¡¨ä¸­å¦‚æœéœ€è¦æ›´æ–°æ•°æ®çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨notifyDataSetChangedçš„æ—¶å€™ï¼Œä¼šå¯¼è‡´ç„¦ç‚¹ä¸¢å¤±ã€‚ è§£å†³åŠæ³• @Override public long getItemId(int position) { return position; } åœ¨adapterä¸­é‡å†™getItemIdæ–¹æ³•ã€‚ mListAdapter.setHasStableIds(true); ç„¶åè°ƒç”¨adapterçš„setHasStableIdsæ–¹æ³•ä¼ å…¥trueï¼Œå°±èƒ½è§£å†³ã€‚ ","link":"http://xuanguofeng.com/post/recyclerview/"},{"title":"EventBusæºç åˆ†æ","content":"EventBus is an open-source library for Android and Java using the publisher/subscriber pattern for loose coupling. EventBus enables central communication to decoupled classes with just a few lines of code â€“ simplifying the code, removing dependencies, and speeding up app development. è¿™æ˜¯æ¥è‡ªå®˜ç½‘çš„ä¸€æ®µä»‹ç»ã€‚ ä½¿ç”¨ å…¶å®ä½¿ç”¨å¾ˆç®€å•ï¼Œå¤§æ¦‚å°±æ˜¯å››ä¸ªæ­¥éª¤ã€‚ æ­¥éª¤ä¸€ï¼šæ³¨å†Œ EventBus.getDefault().register(this); æ­¥éª¤äºŒï¼šç¼–å†™æ¥æ”¶äº‹ä»¶ä»£ç  @Subscribe(threadMode = ThreadMode.MAIN) public void onEvent(String message) { mTextView.setText(message); } æ­¥éª¤ä¸‰ï¼šåœ¨éœ€è¦çš„åœ°æ–¹å‘é€äº‹ä»¶ EventBus.getDefault().post(&quot;è¿™æ˜¯ä¸€ä¸ªäº‹ä»¶ï¼Œå¯ä»¥æ˜¯Objectï¼Œæ¥æ”¶æ–¹å°†ä¼šæ¥æ”¶&quot;); æ­¥éª¤å››ï¼šæ³¨é”€ EventBus.getDefault().unregister(this); æºç  æ—¢ç„¶ä¸»è¦åˆ†ä¸ºäº†ä¸Šé¢çš„å››ä¸ªæ­¥éª¤ï¼Œæ‰€ä»¥æºç å¯ä»¥ä»å››ä¸ªæ­¥éª¤æ–¹é¢å…¥æ‰‹ã€‚ åˆå§‹åŒ– é¦–å…ˆæ‰€æœ‰çš„æµç¨‹éƒ½è¦å…ˆè°ƒç”¨EventBus.getDefault()ã€‚ static volatile EventBus defaultInstance; public static EventBus getDefault() { if (defaultInstance == null) { synchronized (EventBus.class) { if (defaultInstance == null) { defaultInstance = new EventBus(); } } } return defaultInstance; } è¿™é‡Œçœ‹åˆ°æ˜¯ä¸€ä¸ªå•ä¾‹æ¨¡å¼ï¼Œè€Œä¸”ä¹Ÿä½¿ç”¨volatileå…³é”®å­—ï¼Œä¸»è¦æ˜¯ä¿è¯å¹¶å‘æ—¶å€™çš„å¯è§æ€§ã€‚çœ‹EventBusçš„æ„é€ ä¹Ÿèƒ½å‘ç°æ˜¯ä½¿ç”¨äº†builderæ¨¡å¼æ¥åˆ›å»ºEventBusã€‚ registeræ³¨å†Œ public void register(Object subscriber) { Class&lt;?&gt; subscriberClass = subscriber.getClass(); List&lt;SubscriberMethod&gt; subscriberMethods = subscriberMethodFinder.findSubscriberMethods(subscriberClass);//æ ¹æ®å½“å‰æ³¨å†Œå¯¹è±¡æŸ¥æ‰¾è¿™ä¸ªå¯¹è±¡ç›¸å…³çš„è®¢é˜…æ–¹æ³• synchronized (this) { for (SubscriberMethod subscriberMethod : subscriberMethods) { subscribe(subscriber, subscriberMethod);//å¾ªç¯å°†æ³¨å†Œç±»ä¸è®¢é˜…æ–¹æ³•åˆ›å»ºè®¢é˜…å…³ç³» } } } è¿™æ®µä»£ç å…¶å®åŒ…å«ä¸€ä¸ªé‡è¦çš„ç±»å°±æ˜¯ï¼šsubscriberMethodFinderï¼Œè®¢é˜…æ–¹æ³•çš„æŸ¥æ‰¾ç±»ï¼Œregisterçš„æ—¶å€™å…ˆæŸ¥æ‰¾è®¢é˜…æ–¹æ³•ï¼Œè¿™ä¸ªè®¢é˜…æ–¹æ³•å…¶å®å°±æ˜¯æˆ‘ä»¬åœ¨æ³¨å†Œçš„ç±»é‡Œé¢é€šè¿‡@Subscribeæ³¨è§£äº§ç”Ÿçš„æ–¹æ³•ã€‚ List&lt;SubscriberMethod&gt; findSubscriberMethods(Class&lt;?&gt; subscriberClass) { List&lt;SubscriberMethod&gt; subscriberMethods = METHOD_CACHE.get(subscriberClass);//å…ˆä»ç¼“å­˜ä¸­æŸ¥æ‰¾ if (subscriberMethods != null) { return subscriberMethods;//ç¼“å­˜ä¸­æœ‰çš„è¯ç›´æ¥è¿”å› } if (ignoreGeneratedIndex) {//é€šè¿‡getDefaulté»˜è®¤ä¸ºfalse subscriberMethods = findUsingReflection(subscriberClass);//é€šè¿‡åå°„æŸ¥æ‰¾ } else { subscriberMethods = findUsingInfo(subscriberClass);//ä»indexä¸­æŸ¥æ‰¾ï¼Œè¿™é‡Œåªæœ‰é€šè¿‡å®ç°EventBusBuilderçš„addindexæ–¹æ³•æ—¶æ‰ä¼šæœ‰ï¼Œå¦åˆ™é»˜è®¤è¿˜æ˜¯ä¼šé€šè¿‡åå°„æŸ¥æ‰¾ã€‚ } if (subscriberMethods.isEmpty()) {//åˆ¤æ–­å¦‚æœè®¢é˜…æ–¹æ³•ä¸ºç©ºçš„è¯å°†ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ throw new EventBusException(&quot;Subscriber &quot; + subscriberClass + &quot; and its super classes have no public methods with the @Subscribe annotation&quot;); } else {//ä¸ä¸ºç©ºçš„è¯ æ·»åŠ åˆ°ç¼“å­˜ä¸­ã€‚ METHOD_CACHE.put(subscriberClass, subscriberMethods); return subscriberMethods; } } è¿™ä¸ªæ–¹æ³•å…¶å®ä¸»è¦æ˜¯åˆ¤æ–­æ€ä¹ˆæŸ¥æ‰¾è®¢é˜…æ–¹æ³•ï¼Œå…¶å®å¤šæ•°æƒ…å†µè¿˜æ˜¯é€šè¿‡åå°„æŸ¥æ‰¾ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„å°±æ˜¯å¦‚æœæˆ‘ä»¬æ³¨å†Œäº†ï¼Œå¦‚æœæ²¡æœ‰é€šè¿‡ @Subscribe(threadMode = ThreadMode.MAIN)è¿™ç§æ³¨è§£æ·»åŠ è®¢é˜…æ–¹æ³•ï¼Œä¼šæŠ›å‡ºEventBusExceptionå¼‚å¸¸ã€‚å¦‚ä¸‹ æ¥ä¸‹æ¥ä¸»è¦åˆ†æä»åå°„ä¸­æŸ¥æ‰¾è®¢é˜…æ–¹æ³• private List&lt;SubscriberMethod&gt; findUsingReflection(Class&lt;?&gt; subscriberClass) { //ä»£ç çœç•¥ä¸»è¦è°ƒç”¨ findUsingReflectionInSingleClassæ–¹æ³•ã€‚ } private void findUsingReflectionInSingleClass(FindState findState) { Method[] methods; try { // This is faster than getMethods, especially when subscribers are fat classes like Activities methods = findState.clazz.getDeclaredMethods(); } catch (Throwable th) { // Workaround for java.lang.NoClassDefFoundError, see https://github.com/greenrobot/EventBus/issues/149 methods = findState.clazz.getMethods(); findState.skipSuperClasses = true; } //å‰é¢ä¸»è¦æ˜¯é€šè¿‡åå°„æ ¹æ®æ³¨å†Œçš„ç±»è·å–æ–¹æ³•æ•°ç»„ã€‚ for (Method method : methods) {//å¾ªç¯æ‰€æœ‰æ–¹æ³• int modifiers = method.getModifiers();//è·å–æ–¹æ³•çš„ä¿®é¥°ç¬¦ if ((modifiers &amp; Modifier.PUBLIC) != 0 &amp;&amp; (modifiers &amp; MODIFIERS_IGNORE) == 0) { Class&lt;?&gt;[] parameterTypes = method.getParameterTypes();//è·å–å‚æ•°ç±»å‹ if (parameterTypes.length == 1) {//å¦‚æœä¸€ä¸ªå‚æ•°çš„è¯ç»§ç»­ï¼Œå¦åˆ™ä¼šæŠ¥é”™ Subscribe subscribeAnnotation = method.getAnnotation(Subscribe.class);//è·å–å®šä¹‰çš„æ³¨è§£ if (subscribeAnnotation != null) {//å¦‚æœèƒ½æ­£å¸¸è·å–åˆ°æ³¨è§£ Class&lt;?&gt; eventType = parameterTypes[0]; if (findState.checkAdd(method, eventType)) { ThreadMode threadMode = subscribeAnnotation.threadMode(); findState.subscriberMethods.add(new SubscriberMethod(method, eventType, threadMode, subscribeAnnotation.priority(), subscribeAnnotation.sticky()));//å¦‚æœæ£€æŸ¥æ­£å¸¸çš„è¯å°†ä¼šåˆ›å»ºä¸€ä¸ªSubscriberMethodæ·»åŠ åˆ°findStateé‡Œé¢çš„è®¢é˜…æ–¹æ³•é›†åˆ } } } else if (strictMethodVerification &amp;&amp; method.isAnnotationPresent(Subscribe.class)) { String methodName = method.getDeclaringClass().getName() + &quot;.&quot; + method.getName(); throw new EventBusException(&quot;@Subscribe method &quot; + methodName + &quot;must have exactly 1 parameter but has &quot; + parameterTypes.length); } } else if (strictMethodVerification &amp;&amp; method.isAnnotationPresent(Subscribe.class)) { String methodName = method.getDeclaringClass().getName() + &quot;.&quot; + method.getName(); throw new EventBusException(methodName + &quot; is a illegal @Subscribe method: must be public, non-static, and non-abstract&quot;); } } } ç”±äºstrictMethodVerificationå¦‚æœé€šè¿‡getDefault()æ–¹å¼çš„è¯é»˜è®¤ä¸ºfalseæ‰€ä»¥ä¸ä¼šèµ°åé¢çš„ä»£ç ã€‚SubscriberMethodè¿™ä¸ªç±»å¾ˆæ˜æ˜¾å°±æ˜¯å¯¹åº”ä¸€ä¸ªè®¢é˜…çš„æ–¹æ³•åŒ…æ‹¬ä¸€äº›å±æ€§ã€‚ public class SubscriberMethod { final Method method;//æ–¹æ³• final ThreadMode threadMode;//çº¿ç¨‹ç±»å‹å¯¹åº”POSTINGã€MAINã€MAIN_ORDEREDã€BACKGROUNDã€ASYNC final Class&lt;?&gt; eventType;//åœ¨åå°„æ—¶å€™è·å–çš„å‚æ•°ç±»å‹ final int priority;//ä¼˜å…ˆçº§ final boolean sticky;//æ˜¯å¦æ˜¯ç²˜æ€§äº‹ä»¶ /** Used for efficient comparison */ String methodString; //çœç•¥åé¢ä»£ç ã€‚ã€‚ã€‚ å†å›æ¥çœ‹registeré‡Œé¢æœ‰ä¸€ä¸ªå¾ªç¯è®¢é˜…çš„è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯subscribe()è¿™ä¸ªæ–¹æ³•ã€‚ // Must be called in synchronized block private void subscribe(Object subscriber, SubscriberMethod subscriberMethod) { Class&lt;?&gt; eventType = subscriberMethod.eventType; Subscription newSubscription = new Subscription(subscriber, subscriberMethod);//Subscriptionå…¶å®å°±æ˜¯æ ¹æ®æ³¨å†Œå¯¹è±¡å’Œæ–¹æ³•åˆ›å»ºçš„ä¸€ä¸ªè®¢é˜…å…³ç³»çš„ç»´æŠ¤ç±»ï¼Œé‡Œé¢é‡å†™äº†equalså’ŒhashCodeæ–¹æ³•ã€‚ CopyOnWriteArrayList&lt;Subscription&gt; subscriptions = subscriptionsByEventType.get(eventType);//subscriptionsByEventTypeæ˜¯ä¸€ä¸ªè®¢é˜…è€…é˜Ÿåˆ— if (subscriptions == null) {//é‡Œé¢æ²¡æœ‰è®¢é˜…è€…çš„è¯åˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—å¹¶æ ¹æ®keyæ·»åŠ subscriptions subscriptions = new CopyOnWriteArrayList&lt;&gt;(); subscriptionsByEventType.put(eventType, subscriptions); } else { if (subscriptions.contains(newSubscription)) {//å¦‚æœåŒ…å«äº†æŠ›å‡ºå¼‚å¸¸ throw new EventBusException(&quot;Subscriber &quot; + subscriber.getClass() + &quot; already registered to event &quot; + eventType); } } int size = subscriptions.size(); for (int i = 0; i &lt;= size; i++) { if (i == size || subscriberMethod.priority &gt; subscriptions.get(i).subscriberMethod.priority) { subscriptions.add(i, newSubscription);//æ ¹æ®ä¼˜å…ˆçº§å°†è®¢é˜…å…³ç³»æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­ break; } } List&lt;Class&lt;?&gt;&gt; subscribedEvents = typesBySubscriber.get(subscriber);//typesBySubscriberä¿å­˜çš„æ˜¯è®¢é˜…è€…ä¸è®¢é˜…è€…çš„äº‹ä»¶çš„mapï¼Œåç»­é€šè¿‡è¿™ä¸ªè§£é™¤æ³¨å†Œå’Œåˆ¤æ–­æ˜¯å¦æ³¨å†Œ if (subscribedEvents == null) { subscribedEvents = new ArrayList&lt;&gt;(); typesBySubscriber.put(subscriber, subscribedEvents); } subscribedEvents.add(eventType);//å°†äº‹ä»¶æ·»åŠ åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­ if (subscriberMethod.sticky) {//å¦‚æœæ˜¯ç²˜æ€§äº‹ä»¶ å°†ä¼šç«‹å³å‘é€æ‰§è¡Œ if (eventInheritance) { // Existing sticky events of all subclasses of eventType have to be considered. // Note: Iterating over all events may be inefficient with lots of sticky events, // thus data structure should be changed to allow a more efficient lookup // (e.g. an additional map storing sub classes of super classes: Class -&gt; List&lt;Class&gt;). Set&lt;Map.Entry&lt;Class&lt;?&gt;, Object&gt;&gt; entries = stickyEvents.entrySet(); for (Map.Entry&lt;Class&lt;?&gt;, Object&gt; entry : entries) { Class&lt;?&gt; candidateEventType = entry.getKey(); if (eventType.isAssignableFrom(candidateEventType)) { Object stickyEvent = entry.getValue(); checkPostStickyEventToSubscription(newSubscription, stickyEvent); } } } else { Object stickyEvent = stickyEvents.get(eventType); checkPostStickyEventToSubscription(newSubscription, stickyEvent); } } } ç²˜æ€§äº‹ä»¶ä¸»è¦å°±æ˜¯å¯ä»¥å…ˆå‘é€ï¼Œç„¶ååœ¨æ³¨å†Œçš„è¯ä¹Ÿå¯ä»¥ç›´æ¥æ”¶åˆ°äº‹ä»¶ã€‚å…¶å®æ•´ä¸ªæ³¨å†Œæµç¨‹å°±æ˜¯å°†æ—¶é—´æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­ï¼Œä¸è¿‡è¿™é‡Œçš„é˜Ÿåˆ—ä¹Ÿä¸æ­¢ä¸€ä¸ªã€‚è¿™é‡Œæœ‰å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„æ¦‚å¿µåé¢ä¹Ÿè¦ç”¨çš„åˆ°ã€‚ postå‘é€äº‹ä»¶ public void post(Object event) { PostingThreadState postingState = currentPostingThreadState.get();//é€šè¿‡ThreadLocalç»´æŠ¤ä¸€ä¸ªPostingThreadStateé‡Œé¢æœ‰å¯¹åº”çš„queue List&lt;Object&gt; eventQueue = postingState.eventQueue; eventQueue.add(event);//å°†eventäº‹ä»¶æ·»åŠ åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­ if (!postingState.isPosting) {//isPostingé»˜è®¤ä¸ºfalse postingState.isMainThread = isMainThread();//åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦ä¸»çº¿ç¨‹å¹¶ä¿å­˜çŠ¶æ€ postingState.isPosting = true; if (postingState.canceled) {//åˆ¤æ–­çŠ¶æ€æ˜¯å¦è¢«canceled throw new EventBusException(&quot;Internal error. Abort state was not reset&quot;); } try { while (!eventQueue.isEmpty()) {//å¾ªç¯æ¶ˆæ¯é˜Ÿåˆ—ä¸æ–­è°ƒç”¨postSingleEvent postSingleEvent(eventQueue.remove(0), postingState);//è¿™é‡Œç”¨çš„æ˜¯removeä¹Ÿå°±æ˜¯è¯´äº‹ä»¶æ‰§è¡Œä¸€ä¸ªç§»é™¤ä¸€ä¸ª } } finally { postingState.isPosting = false; postingState.isMainThread = false; } } } è¿™ä¸ªæ–¹æ³•ä¸»è¦æ˜¯åˆ›å»ºå¯¹åº”çš„PostingThreadStateï¼Œè¿™æ˜¯ä¸€ä¸ªç®€å•çš„å¯¹è±¡ï¼Œå¯ä»¥ç†è§£ä¸ºçº¿ç¨‹å‘é€çŠ¶æ€ç„¶åé‡Œé¢æœ‰ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—å’Œä¸€äº›çŠ¶æ€å€¼ã€‚PostingThreadStateæ˜¯é€šè¿‡ThreadLocalä¿å­˜çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ˜¯å’Œçº¿ç¨‹ç»‘å®šçš„ã€‚ä¸‹é¢çœ‹postSingleEventæ–¹æ³•ï¼š private void postSingleEvent(Object event, PostingThreadState postingState) throws Error { Class&lt;?&gt; eventClass = event.getClass(); boolean subscriptionFound = false;//ä¿å­˜æ˜¯å¦èƒ½æ‰¾åˆ°è®¢é˜…å…³ç³»çš„æ ‡è®° if (eventInheritance) {//é»˜è®¤ä¸ºtrue æ˜¯å¦æ”¯æŒç»§æ‰¿å…³ç³» List&lt;Class&lt;?&gt;&gt; eventTypes = lookupAllEventTypes(eventClass); int countTypes = eventTypes.size(); for (int h = 0; h &lt; countTypes; h++) { Class&lt;?&gt; clazz = eventTypes.get(h); subscriptionFound |= postSingleEventForEventType(event, postingState, clazz);//é€šè¿‡postSingleEventForEventTypeæ–¹æ³•å‘é€äº‹ä»¶ } } else {//å¦‚æœfalseä¸æŸ¥æ‰¾ç»§æ‰¿å…³ç³» subscriptionFound = postSingleEventForEventType(event, postingState, eventClass); } if (!subscriptionFound) { if (logNoSubscriberMessages) { logger.log(Level.FINE, &quot;No subscribers registered for event &quot; + eventClass); } if (sendNoSubscriberEvent &amp;&amp; eventClass != NoSubscriberEvent.class &amp;&amp; eventClass != SubscriberExceptionEvent.class) { post(new NoSubscriberEvent(this, event)); } } } private boolean postSingleEventForEventType(Object event, PostingThreadState postingState, Class&lt;?&gt; eventClass) { CopyOnWriteArrayList&lt;Subscription&gt; subscriptions; synchronized (this) { subscriptions = subscriptionsByEventType.get(eventClass);//subscriptionsByEventTypeä¹‹å‰åœ¨æ³¨å†Œçš„æ—¶å€™ä¿å­˜çš„è®¢é˜…è€…é˜Ÿåˆ—ï¼Œåœ¨è¿™é‡Œæ ¹æ®keyæŸ¥è¯¢åˆ°è¿™ä¸ªäº‹ä»¶çš„æ‰€æœ‰è®¢é˜…è€… } if (subscriptions != null &amp;&amp; !subscriptions.isEmpty()) { for (Subscription subscription : subscriptions) {//è¿­ä»£æ‰€æœ‰çš„è®¢é˜…è€…ç»´æŠ¤postingState postingState.event = event; postingState.subscription = subscription; boolean aborted = false; try { postToSubscription(subscription, event, postingState.isMainThread);//æ ¹æ®subscriptionå’Œäº‹ä»¶ å»è¿›è¡Œçº¿ç¨‹åˆ†å‘ç„¶åè°ƒç”¨ aborted = postingState.canceled; } finally { postingState.event = null; postingState.subscription = null; postingState.canceled = false; } if (aborted) { break; } } return true; } return false; } private void postToSubscription(Subscription subscription, Object event, boolean isMainThread) { switch (subscription.subscriberMethod.threadMode) { case POSTING: invokeSubscriber(subscription, event); break; case MAIN: if (isMainThread) { invokeSubscriber(subscription, event); } else { mainThreadPoster.enqueue(subscription, event); } break; case MAIN_ORDERED: if (mainThreadPoster != null) { mainThreadPoster.enqueue(subscription, event); } else { // temporary: technically not correct as poster not decoupled from subscriber invokeSubscriber(subscription, event); } break; case BACKGROUND: if (isMainThread) { backgroundPoster.enqueue(subscription, event); } else { invokeSubscriber(subscription, event); } break; case ASYNC: asyncPoster.enqueue(subscription, event); break; default: throw new IllegalStateException(&quot;Unknown thread mode: &quot; + subscription.subscriberMethod.threadMode); } } ä¸Šé¢è¿™æ®µä»£ç å…¶å®å°±æ˜¯æ ¹æ®ä¹‹å‰ç»‘å®šçš„Subscriptioné‡Œçš„Methodåˆ¤æ–­çº¿ç¨‹æ¨¡å¼ï¼Œç„¶åæ ¹æ®ä¸åŒçš„æ–¹å¼å¤„ç†äº‹ä»¶ï¼Œå…¶å®è¿™å‡ ç§æ–¹å¼ä¸»è¦æ˜¯é€šè¿‡Posterçš„å®ç°ç±»ã€‚ ä¸»è¦æ˜¯æœ‰4ç§æ–¹å¼ï¼šåå°„ç›´æ¥è°ƒç”¨ã€åœ¨ä¸»çº¿ç¨‹å‘å°„äº‹ä»¶ã€åœ¨å•ç‹¬å­çº¿ç¨‹å‘é€ã€å¼‚æ­¥å‘é€ã€‚å…¶å®æ— è®ºå“ªç§æ–¹å¼æœ€åéƒ½æ˜¯é€šè¿‡invokeSubscriber()æ–¹æ³•è¿”å›åˆ°Eventbusé€šè¿‡åå°„è°ƒç”¨ï¼Œåªä¸è¿‡é€šè¿‡Handlerã€é“¾è¡¨ã€é˜Ÿåˆ—å’Œçº¿ç¨‹æ± ç­‰æŠ€æœ¯æ‰‹æ®µå®ç°åœ¨åœ¨åå°æˆ–è€…ä¸»çº¿ç¨‹æ‰§è¡Œã€‚å…¶å®çº¿ç¨‹æ± åœ¨EventBusBuilderä¸­å·²ç»åœ¨åˆå§‹åŒ–çš„æ—¶å€™å°±åˆ›å»ºäº†ã€‚ void invokeSubscriber(Subscription subscription, Object event) { try { subscription.subscriberMethod.method.invoke(subscription.subscriber, event); } catch (InvocationTargetException e) { handleSubscriberException(subscription, event, e.getCause()); } catch (IllegalAccessException e) { throw new IllegalStateException(&quot;Unexpected exception&quot;, e); } } è¿™å°±æ˜¯æœ€ç»ˆé€šè¿‡åå°„è°ƒç”¨æ–¹æ³•ã€‚ è§£æ³¨å†Œ /** Unregisters the given subscriber from all event classes. */ public synchronized void unregister(Object subscriber) { List&lt;Class&lt;?&gt;&gt; subscribedTypes = typesBySubscriber.get(subscriber); if (subscribedTypes != null) { for (Class&lt;?&gt; eventType : subscribedTypes) { unsubscribeByEventType(subscriber, eventType); } typesBySubscriber.remove(subscriber); } else { logger.log(Level.WARNING, &quot;Subscriber to unregister was not registered before: &quot; + subscriber.getClass()); } } å…¶å®è§£æ³¨å†Œä¸»è¦å°±æ˜¯åœ¨ä¹‹å‰åˆ†æçš„typesBySubscriberé›†åˆå’ŒsubscriptionsByEventTypeé›†åˆæ ¹æ®subscriberç§»é™¤æ‰ã€‚ æ€»ç»“ å…¶å®æ–‡ç« ä¸­æœ‰ä¸€äº›ç»†èŠ‚æ²¡æœ‰å†™å‡ºæ¥ï¼Œä¸è¿‡ç¬”è€…å·²ç»çœ‹è¿‡äº†ï¼Œå»ºè®®è¯»è€…è‡ªå·±ä¹Ÿæƒ³æƒ³æœ‰ä»€ä¹ˆé—®é¢˜å»çœ‹çœ‹ï¼Œè¿™é‡Œåˆ†æçš„æ˜¯åŸºæœ¬æµç¨‹ã€‚ EventBusæ„Ÿè§‰å¯ä»¥åˆ†å¼€ä¸¤ä¸ªè¯Event Busï¼Œè€Œä¸”ä¸»è¦è¿˜æ˜¯ä»¥EventBusè¿™ç±»ä¸ºä¸»å»¶ä¼¸å‡ºæ¥çš„ä¸€äº›å¤„ç†ç±»ï¼Œæ¯”å¦‚SubscriberMethodFinderã€EventBusBuilderï¼ŒPosterç­‰ç­‰ï¼Œç„¶ååˆå›åˆ°EventBusæ¥å¤„ç†ç›¸å…³çš„é€»è¾‘ã€‚ Thanks Android æ¡†æ¶å­¦ä¹ ï¼šæºç åˆ†æ EventBus 3.0 å¦‚ä½•å®ç°äº‹ä»¶æ€»çº¿ ","link":"http://xuanguofeng.com/post/eventbus-yuan-ma-fen-xi/"},{"title":"é—®é¢˜æ—¥å¿—-Frescoåº“çš„libimagepipeline.soé—®é¢˜","content":"ä½¿ç”¨äº†Frescoçš„å›¾ç‰‡åº“ä¼šå‘ç°åœ¨éƒ¨åˆ†æœºå‹ä¸Šä¼šæŠ¥java.lang.UnsatisfiedLinkError: couldn't find DSO to load: libimagepipeline.so caused by: dlopen failed: &quot;/data/data/cn.krcom.tv/lib-main/libimagepipeline.so&quot; is 64-bit instead of 32-bité”™è¯¯ã€‚ é—®é¢˜æè¿° java.lang.UnsatisfiedLinkError: couldn't find DSO to load: libimagepipeline.so caused by: dlopen failed: &quot;/data/data/cn.krcom.tv/lib-main/libimagepipeline.so&quot; is 64-bit instead of 32-bit at com.facebook.soloader.SoLoader.initSoSources(SoLoader.java) doLoadLibraryBySoName(SoLoader.java) makeNonZipPath(SoLoader.java) getNativeLoadRuntimeMethod(SoLoader.java) at com.facebook.soloader.SoLoader.init(SoLoader.java) loadLibrary(SoLoader.java) init(SoLoader.java) makePrepareFlags(SoLoader.java) loadLibraryBySoName(SoLoader.java) initSoLoader(SoLoader.java) //åé¢çš„çœç•¥äº† åŸå› ä¸è§£å†³ é¦–å…ˆæœ‰ä¸€å¥logå¾ˆé‡è¦é‚£å°±æ˜¯â€œlibimagepipeline.so caused by: dlopen failed: &quot;/data/data/cn.krcom.tv/lib-main/libimagepipeline.so&quot; is 64-bit instead of 32-bitâ€è¿™é‡Œçš„ä¿¡æ¯èƒ½çœ‹å‡ºæ¥ä¸»è¦æ˜¯libimagepipeline.soçš„soæ–‡ä»¶å¼•èµ·çš„ã€‚ æ‰€ä»¥ä¸»è¦è€ƒè™‘æ˜¯cpuæŒ‡ä»¤é›†ä¸soæ–‡ä»¶çš„å…¼å®¹é—®é¢˜ã€‚å…¶å®å¤§éƒ¨åˆ†soæ˜¯ç›¸äº’å…¼å®¹çš„ï¼Œä½†æ˜¯æŸ¥çœ‹é¡¹ç›®å‘ç°é‡Œé¢åŒæ—¶æœ‰arm64-v8aæ–‡ä»¶å¤¹å’Œarmeabi-v7aï¼Œæ‰€ä»¥é€šè¿‡è§£æapkå‘ç°é‡Œé¢çš„soå¯¹åº”çš„ä¸ä¸€æ ·ã€‚æ‰€ä»¥å‘ç°åœ¨arm64-v8açš„è®¾å¤‡ä¸Šå…ˆæ‰¾åˆ°äº†é‡Œé¢çš„soï¼Œå¦‚æœæœ‰äº›ä¸‰æ–¹åº“æ”¯æŒçš„soæ–‡ä»¶å¤¹ä¸ä¸€è‡´å°±ä¼šå¯¼è‡´crashã€‚ æ‰€ä»¥è¦è§£å†³çš„è¯é¦–å…ˆè¦ä¿è¯æ”¯æŒçš„ç›®å½•é‡Œçš„soæ–‡ä»¶æ˜¯ä¸€æ ·çš„ã€‚æˆ–è€…å¯ä»¥åªä½¿ç”¨ä¸€ä¸ªå…¼å®¹çš„æ–‡ä»¶å¤¹ã€‚ å‚è€ƒæ–‡ç« ï¼š https://developer.android.com/ndk/guides/abis https://blog.csdn.net/u013531824/article/details/53931307 https://www.jianshu.com/p/ad95c885c2f8 ","link":"http://xuanguofeng.com/post/wen-ti-ri-zhi-fresco-ku-de-libimagepipelineso-wen-ti/"},{"title":"é—®é¢˜æ—¥å¿—-ä½ç‰ˆæœ¬Didn't find class \"~FileProvider\"","content":"ç”±äºåœ¨ä½ç‰ˆæœ¬çš„ç³»ç»Ÿä¸­ï¼Œä¼šæç¤ºDidn't find class &quot;android.support.v4.content.FileProvider&quot;é—®é¢˜ï¼Œæ‰€ä»¥æŸ¥æ‰¾äº†ä¸‹è§£å†³æ–¹æ¡ˆã€‚ é—®é¢˜æè¿° ç”±äºåœ¨é¡¹ç›®ä¸­ä½¿ç”¨äº†providerï¼Œå¹¶å¦‚ä¸‹é…ç½® &lt;provider android:name=&quot;android.support.v4.content.FileProvider&quot; android:authorities=&quot;${applicationId}.fileprovider&quot; android:exported=&quot;false&quot; android:grantUriPermissions=&quot;true&quot;&gt; &lt;meta-data android:name=&quot;android.support.FILE_PROVIDER_PATHS&quot; android:resource=&quot;@xml/file_paths&quot; /&gt; &lt;/provider&gt; è€Œä¸”ç”±äºé¡¹ç›®ä¸­çš„æ–¹æ³•æ•°å¤§äº65536ï¼Œæ‰€ä»¥è¦åœ¨defaultConfigä¸­ä½¿ç”¨å¦‚ä¸‹æ–¹å¼è¿›è¡Œå¯¹dexæ‹†åˆ†æ‰“åŒ… multiDexEnabled true è¿™æ ·å°±å¯èƒ½ä¼šå¯¼è‡´å¦‚ä¸‹é—®é¢˜ï¼š Caused by: java.lang.ClassNotFoundException: Didn't find class &quot;android.support.v4.content.FileProvider&quot; on path: DexPathList[[zip file &quot;/data/app/cn.krcom.tv.beta-1.apk&quot;],nativeLibraryDirectories=[/data/app-lib/é¡¹ç›®çš„åŒ…å-1, /system/lib]] at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:56) at java.lang.ClassLoader.loadClass(ClassLoader.java:497) at java.lang.ClassLoader.loadClass(ClassLoader.java:457) at android.app.ActivityThread.installProvider(ActivityThread.java:4762) at android.app.ActivityThread.installContentProviders(ActivityThread.java:4369) at android.app.ActivityThread.handleBindApplication(ActivityThread.java:4309) at android.app.ActivityThread.access$1500(ActivityThread.java:135) at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1256) at android.os.Handler.dispatchMessage(Handler.java:102) at android.os.Looper.loop(Looper.java:136) at android.app.ActivityThread.main(ActivityThread.java:5001) at java.lang.reflect.Method.invokeNative(Native Method) at java.lang.reflect.Method.invoke(Method.java:515) at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:785) at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:601) at dalvik.system.NativeStart.main(Native Method) åŸå› ä¸è§£å†³æ–¹å¼ äºæ˜¯å°±æŸ¥æ‰¾é—®é¢˜ï¼Œå…¶å®åŸå› åœ¨å®˜æ–¹æ–‡æ¡£çš„åˆ†åŒ…æ–¹æ³•ä¸­æ—©å·²å†™æ˜ã€‚ä¹Ÿè¯´æ˜äº†åŸå›  é…ç½®æ‚¨çš„åº”ç”¨è¿›è¡Œ Dalvik å¯æ‰§è¡Œæ–‡ä»¶åˆ†åŒ… ä¸»è¦è§£å†³åŠæ³•å°±æ˜¯ å¼•å…¥multidex compile 'com.android.support:multidex:1.0.3' åœ¨Applicationä¸­åˆå§‹åŒ– public class MyApplication extends MultiDexApplication { ... } æˆ–è€…ç›´æ¥è°ƒç”¨ MultiDex.install(this); ","link":"http://xuanguofeng.com/post/ã€é—®é¢˜æ—¥å¿—ã€‘ä½ç‰ˆæœ¬dexæ‹†åˆ†é—®é¢˜/"},{"title":"AsyncTaskæºç è§£æ","content":"AsyncTaskæ˜¯ç”¨æ¥åœ¨å®ç°åœ¨å­çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ååˆ‡æ¢åˆ°UIçº¿ç¨‹ï¼Œå¸¸è§çš„æ¯”å¦‚ä¸‹è½½ä»»åŠ¡çš„æ›´æ–°ï¼Œæ‰§è¡Œä¸‹è½½ååœ¨UIçº¿ç¨‹å®æ—¶æ›´æ–°è¿›åº¦æ¡ã€‚ç”±äºæ˜¯åŸºæœ¬çš„APIæ‰€ä»¥è¿˜æ˜¯å¾ˆæœ‰å¿…è¦äº†è§£æºç çš„ã€‚ ä½¿ç”¨ ä½¿ç”¨å…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œä¸»è¦æ˜¯å®ç°AsyncTaskç±»ï¼Œç„¶åæ‰§è¡Œexcuteæ–¹æ³•ã€‚å…¶ä¸­æœ‰3ä¸ªå‚æ•°å’Œ4ä¸ªæ–¹æ³•æ˜¯å¿…é¡»è¦æŒæ¡çš„ã€‚ private class MyAsyncTask extends AsyncTask&lt;String, String, String&gt; { @Override protected void onPreExecute() { super.onPreExecute(); } @Override protected void onPostExecute(String s) { super.onPostExecute(s); } @Override protected void onProgressUpdate(String... values) { super.onProgressUpdate(values); } @Override protected String doInBackground(String... strings) { return null; } } onPreExecute è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨UIçº¿ç¨‹æ‰§è¡Œï¼Œå¹¶ä¸”åœ¨åå°ä»»åŠ¡å¼€å§‹å‰æ‰§è¡Œã€‚ doInBackground è¿™ä¸ªåœ¨çº¿ç¨‹æ‰§è¡Œï¼Œè¿™é‡Œä¸»è¦æ˜¯åšè€—æ—¶ä»»åŠ¡ã€‚è¿™ä¸ªæ–¹æ³•æœ‰å‚æ•°å’Œè¿”å›å€¼ï¼Œå‚æ•°å°±æ˜¯åœ¨è°ƒç”¨executeä¼ è¿›æ¥çš„å‚æ•°ï¼Œè¿”å›å€¼å°±æ˜¯æˆ‘ä»¬ç»è¿‡ä¸€äº›åˆ—æ“ä½œåè¿”å›ç»™onProgressUpdateæ–¹æ³•çš„ï¼Œä¸»è¦ç”¨äºUIçš„æ›´æ–°ã€‚ä¾‹å¦‚æˆ‘ä¸‹è½½åˆ°50%ç„¶ååŒå¿—UIå®æ—¶æ›´æ–°ã€‚ onProgressUpdate ä»æ–¹æ³•åçœ‹å°±æ˜¯æ›´æ–°è¿›åº¦ï¼Œè¿™ä¸ªå‚æ•°å°±æ˜¯doInBackgroundä¸­è¿”å›çš„ã€‚ onPostExecute è¿™ä¸ªæ–¹æ³•å°±æ˜¯ä»»åŠ¡æ‰§è¡Œå®Œæˆåè¦æ‰§è¡Œçš„æ–¹æ³•ã€‚å‚æ•°ä¹Ÿæ˜¯æ‰§è¡Œçš„ç»“æœã€‚ ä¸‰ä¸ªå‚æ•° æŒæ¡äº†è¿™4ä¸ªæ–¹æ³•ï¼Œè¿™ä¸‰ä¸ªå‚æ•°å°±å¾ˆå®¹æ˜“ç†è§£äº†ã€‚ ç¬¬ä¸€ä¸ªï¼Œæ˜¯ä¼ å…¥çš„å‚æ•°ã€‚ ç¬¬äºŒä¸ªï¼Œæ˜¯æ‰§è¡Œä»»åŠ¡æ—¶è¿›åº¦æ›´æ–°çš„å€¼ã€‚ ç¬¬ä¸‰ä¸ªï¼Œä»»åŠ¡æ‰§è¡Œç»“æŸçš„è¿”å›å€¼ã€‚ æºç  å…¶å®æºç æ— éå°±æ˜¯çœ‹å†…éƒ¨çš„æ ¸å¿ƒæœºåˆ¶ï¼Œå’Œè¿™å‡ ä¸ªæ–¹æ³•çš„è°ƒç”¨æµç¨‹ã€‚æœ€ç›´è§‚çš„å°±ä»executeæ–¹æ³•å¼€å§‹ã€‚ @MainThread public final AsyncTask&lt;Params, Progress, Result&gt; execute(Params... params) { return executeOnExecutor(sDefaultExecutor, params); } è¿™é‡Œç›´æ¥è°ƒç”¨äº†executeOnExecutorï¼Œä¼ å…¥äº†sDefaultExecutorå’Œå‚æ•°ã€‚ @MainThread public final AsyncTask&lt;Params, Progress, Result&gt; executeOnExecutor(Executor exec, Params... params) { if (mStatus != Status.PENDING) { switch (mStatus) { case RUNNING: throw new IllegalStateException(&quot;Cannot execute task:&quot; + &quot; the task is already running.&quot;); case FINISHED: throw new IllegalStateException(&quot;Cannot execute task:&quot; + &quot; the task has already been executed &quot; + &quot;(a task can be executed only once)&quot;); } } mStatus = Status.RUNNING; onPreExecute(); mWorker.mParams = params; exec.execute(mFuture); return this; } å…ˆçœ‹ä¸‹è¿™ä¸ªå‡½æ•°é‡Œé¢éƒ½åšäº†ä»€ä¹ˆï¼Œåœ¨åˆ†æsDefaultExecutorã€‚executeOnExecutorè¿™ä¸ªå‡½æ•°æ˜¯publicçš„æ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ªå‡½æ•°æ‰§è¡Œä»»åŠ¡ã€‚å¦‚æœæˆ‘ä»¬é€šè¿‡executeOnExecutor()è¿™ä¸ªæ–¹æ³•çš„è¯å°±è¦è‡ªå·±åˆ›å»ºä¸€ä¸ªExecutorï¼Œå› ä¸ºé»˜è®¤çš„Executoræ˜¯ä½¿ç”¨é˜Ÿåˆ—ç»´æŠ¤åŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œå¤šä»»åŠ¡æ—¶ä¼šè¢«æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­ï¼Œåé¢ä¼šè®²åˆ°ã€‚ é¦–å…ˆï¼Œè¿›æ¥å…ˆåˆ¤æ–­çŠ¶æ€ï¼Œå¦‚æœå¦‚æœä¸æ˜¯æ²¡æ‰§è¡Œè¿‡çš„è¦æŠ›å‡ºå¼‚å¸¸ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¦‚æœæ‰§è¡Œä¸¤æ¬¡ä»»åŠ¡ä¼šæŠ¥java.lang.IllegalStateExceptionè¿™ä¸ªé”™çš„åŸå› ã€‚ å…¶æ¬¡ï¼Œå°†çŠ¶æ€æ”¹ä¸ºæ­£åœ¨æ‰§è¡Œã€‚ ç„¶åï¼Œæ‰§è¡ŒonPreExecute()æ–¹æ³•ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¿™ä¸ªæ–¹æ³•åœ¨ä¸»çº¿ç¨‹ï¼Œè€Œä¸”åœ¨ä»»åŠ¡å‰æ‰§è¡Œã€‚ å†ç„¶åå¼€å§‹æ‰§è¡ŒExecutorçš„ä»»åŠ¡ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥åˆ†æsDefaultExecutoräº†ã€‚ ç±»é‡Œå¯ä»¥çœ‹åˆ° private static volatile Executor sDefaultExecutor = SERIAL_EXECUTOR; public static final Executor SERIAL_EXECUTOR = new SerialExecutor(); è¿™ä¸¤ä¸ªå¸¸é‡å…¶å®å°±æ˜¯é»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªExecutor private static class SerialExecutor implements Executor { final ArrayDeque&lt;Runnable&gt; mTasks = new ArrayDeque&lt;Runnable&gt;(); Runnable mActive; public synchronized void execute(final Runnable r) { mTasks.offer(new Runnable() { public void run() { try { r.run(); } finally { scheduleNext(); } } }); if (mActive == null) { scheduleNext(); } } protected synchronized void scheduleNext() { if ((mActive = mTasks.poll()) != null) { THREAD_POOL_EXECUTOR.execute(mActive); } } } è¿™ä¸ªSerialExecutoré‡Œé¢ç»´æŠ¤äº†ä¸€ä¸ªé˜Ÿåˆ—ï¼Œç„¶åé€šè¿‡offer()åœ¨é˜Ÿåˆ—çš„æœ«å°¾åŠ å…¥ä»»åŠ¡ï¼Œé€šè¿‡poll()åœ¨å¤´éƒ¨æ£€ç´¢å‡ºä»»åŠ¡å¹¶åˆ é™¤ï¼Œæ£€ç´¢åèµ‹å€¼ç»™mActiveã€‚å› ä¸ºé¦–æ¬¡mActiveä¸ºnullï¼Œæ‰€ä»¥åŠ å…¥äº†åˆ¤æ–­mActive==nullçš„æ—¶å€™æ‰§è¡ŒscheduleNext(),åé¢å†æœ‰ä»»åŠ¡æ¥çš„è¯mActiveå°±ä¸æ˜¯nulläº†ï¼Œæ‰€ä»¥æ˜¯åœ¨runableä¸­ï¼Œé€šè¿‡finallyè°ƒç”¨äº†scheduleNext()ï¼Œè¿™æ—¶å€™å°±ä¼šç­‰ä»»åŠ¡æ‰§è¡Œå®Œæˆååœ¨æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚è¿™å°±æ˜¯ä¸Šé¢è¯´çš„ä¸ºä»€ä¹ˆé»˜è®¤çš„SerialExecutoråªèƒ½åŒæ—¶åœ¨ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ã€‚ /** * An {@link Executor} that can be used to execute tasks in parallel. */ public static final Executor THREAD_POOL_EXECUTOR; static { ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor( CORE_POOL_SIZE, MAXIMUM_POOL_SIZE, KEEP_ALIVE_SECONDS, TimeUnit.SECONDS, sPoolWorkQueue, sThreadFactory); threadPoolExecutor.allowCoreThreadTimeOut(true); THREAD_POOL_EXECUTOR = threadPoolExecutor; } è¿™ä¸ªä¸»è¦å°±æ˜¯é€šè¿‡å„ç§é»˜è®¤ä¸ºçš„å‚æ•°åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹æ± å»æ‰§è¡Œä»»åŠ¡ã€‚ è¿™å°±æ˜¯ä¸»è¦æµç¨‹ï¼Œä½†æ˜¯åœ¨è¿™ä¸ªæµç¨‹ä¸­è¿˜å¿½ç•¥äº†å¾ˆå¤šå†…å®¹ï¼Œåœ¨æˆ‘ä»¬äº†è§£äº†æ•´ä½“æ¡†æ¶æµç¨‹åï¼Œåœ¨å»å¡«å……æˆ‘ä»¬æƒ³çŸ¥é“çš„ç»†èŠ‚ï¼Œå°±æ›´å®¹æ˜“ç†è§£äº†ã€‚ é¦–å…ˆçœ‹executeOnExecutor()æ–¹æ³•ä¸­æœ‰ä¸¤ä¸ªå¾ˆé‡è¦çš„å†…å®¹ä¸€ä¸ªæ˜¯mWorkerå’ŒmFutureã€‚å…¶å®æ‰§è¡Œä»»åŠ¡çš„æ—¶å€™ä¼ å…¥äº†mFutureï¼Œè€ŒmFutureæ˜¯ä¸€ä¸ªmFutureTaskçœŸæ­£æ‰§è¡Œçš„æ˜¯mWorkerã€‚ /** * Creates a new asynchronous task. This constructor must be invoked on the UI thread. */ public AsyncTask() { this((Looper) null); } /** * Creates a new asynchronous task. This constructor must be invoked on the UI thread. * * @hide */ public AsyncTask(@Nullable Handler handler) { this(handler != null ? handler.getLooper() : null); } /** * Creates a new asynchronous task. This constructor must be invoked on the UI thread. * * @hide */ public AsyncTask(@Nullable Looper callbackLooper) { mHandler = callbackLooper == null || callbackLooper == Looper.getMainLooper() ? getMainHandler() : new Handler(callbackLooper); mWorker = new WorkerRunnable&lt;Params, Result&gt;() { public Result call() throws Exception { mTaskInvoked.set(true); Result result = null; try { Process.setThreadPriority(Process.THREAD_PRIORITY_BACKGROUND); //noinspection unchecked result = doInBackground(mParams); Binder.flushPendingCommands(); } catch (Throwable tr) { mCancelled.set(true); throw tr; } finally { postResult(result); } return result; } }; mFuture = new FutureTask&lt;Result&gt;(mWorker) { @Override protected void done() { try { postResultIfNotInvoked(get()); } catch (InterruptedException e) { android.util.Log.w(LOG_TAG, e); } catch (ExecutionException e) { throw new RuntimeException(&quot;An error occurred while executing doInBackground()&quot;, e.getCause()); } catch (CancellationException e) { postResultIfNotInvoked(null); } } }; } åœ¨æ„é€ é‡Œåˆ›å»ºäº†ä¸‰éƒ¨åˆ†å†…å®¹ï¼ŒmHandlerã€mWorkerã€mFutur å¯ä»¥çœ‹åˆ°é¦–å…ˆä¼šåˆ›å»ºhandlerå› ä¸ºï¼Œçº¿ç¨‹é€šä¿¡è¿˜æ˜¯éœ€è¦ä¾é Handlerã€‚ç„¶åmWorkerä¸­ä¸»è¦å°±æ˜¯æ‰§è¡ŒdoInBackground()ç„¶åå°†resultä¼ ç»™postResultã€‚ private Result postResult(Result result) { @SuppressWarnings(&quot;unchecked&quot;) Message message = getHandler().obtainMessage(MESSAGE_POST_RESULT, new AsyncTaskResult&lt;Result&gt;(this, result)); message.sendToTarget(); return result; } postResultä¸»è¦å°±æ˜¯é€šè¿‡handlerå‘é€ä¸€ä¸ªwhatä¸ºMESSAGE_POST_RESULTï¼Œobjä¸ºresultçš„messageã€‚ private static class InternalHandler extends Handler { public InternalHandler(Looper looper) { super(looper); } @SuppressWarnings({&quot;unchecked&quot;, &quot;RawUseOfParameterizedType&quot;}) @Override public void handleMessage(Message msg) { AsyncTaskResult&lt;?&gt; result = (AsyncTaskResult&lt;?&gt;) msg.obj; switch (msg.what) { case MESSAGE_POST_RESULT: // There is only one result result.mTask.finish(result.mData[0]); break; case MESSAGE_POST_PROGRESS: result.mTask.onProgressUpdate(result.mData); break; } } } è¿™æ—¶å€™çœ‹handleMessageæ˜¯æ€ä¹ˆå¤„ç†çš„ã€‚ è¿™é‡Œä¸»è¦æ˜¯è°ƒç”¨åŒºåˆ†whatæ˜¯å®Œæˆè¿˜æ˜¯æœªå®Œæˆå®Œæˆçš„è¯å°±æ˜¯è°ƒç”¨finishæ–¹æ³•ï¼Œæœªå®Œæˆå°±æ˜¯onProgressUpdateæ–¹æ³•ï¼Œ private void finish(Result result) { if (isCancelled()) { onCancelled(result); } else { onPostExecute(result); } mStatus = Status.FINISHED; } åœ¨çœ‹finishæ–¹æ³•å°±æ˜¯åˆ¤æ–­æ˜¯å¦å–æ¶ˆç„¶åè°ƒç”¨onPostExecutæ–¹æ³•å°†ç»“æœä¼ å…¥ã€‚ hadlerMessageè¿˜å¤„ç†ä¸€ä¸ªå°±æ˜¯æ›´æ–°è¿›åº¦ï¼Œé‚£è¿™ä¸ªmessageæ˜¯åœ¨å“ªé‡Œå‘çš„å‘¢ï¼Ÿ protected final void publishProgress(Progress... values) { if (!isCancelled()) { getHandler().obtainMessage(MESSAGE_POST_PROGRESS, new AsyncTaskResult&lt;Progress&gt;(this, values)).sendToTarget(); } } å¯ä»¥çœ‹åˆ°æ˜¯é€šè¿‡publishProgressè¿™ä¸ªæ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¦‚æœéœ€è¦æ›´æ–°è¿›åº¦çš„è¯è¦è‡ªå·±åœ¨doInBackgroundè¿™ä¸ªæ–¹æ³•é‡Œè°ƒç”¨publishProgress()æ–¹æ³•ä¼ å…¥è¿›åº¦ã€‚ç„¶ååœ¨æ‰ä¼šåœ¨onProgressUpdate()è¿™ä¸ªæ–¹æ³•ä¸­æ”¶åˆ°ã€‚ æ€»ç»“ è‡³æ­¤ æ•´ä¸ªæµç¨‹ä¹Ÿå°±æ¸…æ™°äº†ï¼Œè¿™å››ä¸ªæ–¹æ³•æ˜¯åˆ†åˆ«åœ¨å“ªé‡Œè°ƒç”¨çš„åœ¨èƒ½å®ç°å¼‚æ­¥ç„¶åæ›´æ–°UIçš„åŠŸèƒ½ï¼Œå…¶å®åŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯ç”¨äº†ä¸€ä¸ªçº¿åŸæ± ç„¶åæˆ‘ä»¬åœ¨å­çº¿ç¨‹å®æ—¶é€šè¿‡Handlerå‘é€Messageåˆ°UIçº¿ç¨‹ä¸­æ‰§è¡Œè¿›åº¦çš„ä»»åŠ¡ï¼Œé»˜è®¤é€šè¿‡ä¸€ä¸ªé˜Ÿåˆ—ç»´æŠ¤ä»»åŠ¡ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰Executoræ¥å®ç°å¤šçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ã€‚ ","link":"http://xuanguofeng.com/post/AsyncTaskæºç è§£æ/"},{"title":"Hello Gridea","content":"ğŸ‘ æ¬¢è¿ä½¿ç”¨ Gridea ï¼ âœï¸ Gridea ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ... Github Gridea ä¸»é¡µ ç¤ºä¾‹ç½‘ç«™ ç‰¹æ€§ğŸ‘‡ ğŸ“ ä½ å¯ä»¥ä½¿ç”¨æœ€é…·çš„ Markdown è¯­æ³•ï¼Œè¿›è¡Œå¿«é€Ÿåˆ›ä½œ ğŸŒ‰ ä½ å¯ä»¥ç»™æ–‡ç« é…ä¸Šç²¾ç¾çš„å°é¢å›¾å’Œåœ¨æ–‡ç« ä»»æ„ä½ç½®æ’å…¥å›¾ç‰‡ ğŸ·ï¸ ä½ å¯ä»¥å¯¹æ–‡ç« è¿›è¡Œæ ‡ç­¾åˆ†ç»„ ğŸ“‹ ä½ å¯ä»¥è‡ªå®šä¹‰èœå•ï¼Œç”šè‡³å¯ä»¥åˆ›å»ºå¤–éƒ¨é“¾æ¥èœå• ğŸ’» ä½ å¯ä»¥åœ¨ ğ–¶ğ—‚ğ—‡ğ–½ğ—ˆğ—ğ—Œ æˆ– ğ–¬ğ–ºğ–¼ğ–®ğ–² è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å®¢æˆ·ç«¯ ğŸŒ ä½ å¯ä»¥ä½¿ç”¨ ğ–¦ğ—‚ğ—ğ—ğ—ğ–» ğ–¯ğ–ºğ—€ğ–¾ğ—Œ æˆ– Coding Pages å‘ä¸–ç•Œå±•ç¤ºï¼Œæœªæ¥å°†æ”¯æŒæ›´å¤šå¹³å° ğŸ’¬ ä½ å¯ä»¥è¿›è¡Œç®€å•çš„é…ç½®ï¼Œæ¥å…¥ Gitalk æˆ– DisqusJS è¯„è®ºç³»ç»Ÿ ğŸ‡¬ğŸ‡§ ä½ å¯ä»¥ä½¿ç”¨ä¸­æ–‡ç®€ä½“æˆ–è‹±è¯­ ğŸŒ ä½ å¯ä»¥ä»»æ„ä½¿ç”¨åº”ç”¨å†…é»˜è®¤ä¸»é¢˜æˆ–ä»»æ„ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œå¼ºå¤§çš„ä¸»é¢˜è‡ªå®šä¹‰èƒ½åŠ› ğŸ–¥ ä½ å¯ä»¥è‡ªå®šä¹‰æºæ–‡ä»¶å¤¹ï¼Œåˆ©ç”¨ OneDriveã€ç™¾åº¦ç½‘ç›˜ã€iCloudã€Dropbox ç­‰è¿›è¡Œå¤šè®¾å¤‡åŒæ­¥ ğŸŒ± å½“ç„¶ Gridea è¿˜å¾ˆå¹´è½»ï¼Œæœ‰å¾ˆå¤šä¸è¶³ï¼Œä½†è¯·ç›¸ä¿¡ï¼Œå®ƒä¼šä¸åœå‘å‰ğŸƒ æœªæ¥ï¼Œå®ƒä¸€å®šä¼šæˆä¸ºä½ ç¦»ä¸å¼€çš„ä¼™ä¼´ å°½æƒ…å‘æŒ¥ä½ çš„æ‰åå§ï¼ ğŸ˜˜ Enjoy~ ","link":"http://xuanguofeng.com/post/hello-gridea/"},{"title":"ã€Flutterç¬”è®°ã€‘ä¹‹Widgetçš„ä¸€äº›æ€»ç»“","content":"å¯ä»¥è¯´flutterä¸­æ˜¯åŸºäºWidgetsçš„ï¼Œä¸€ä¸ªTextViewæ˜¯Widgetsï¼Œä¸€ä¸ªå¸ƒå±€ä¹Ÿæ˜¯ä¸€ä¸ªWidgetsã€‚ä½¿ç”¨Widgetså»ç»„è£…å‡ºä½ æƒ³è¦çš„ UIï¼Œäº†è§£Widgetsä¹Ÿæ˜¯éå¸¸é‡è¦çš„ã€‚ Flutteré»˜è®¤ä¹Ÿæä¾›äº†ä¸°å¯Œæˆ‘Widgetsï¼ŒåŒ…æ‹¬Android Material Designé£æ ¼çš„æ§ä»¶ï¼Œä¹Ÿæœ‰iOSé£æ ¼çš„Cupertinoç»„ä»¶åº“ã€‚è€Œä¸”æ‰€æœ‰ç»„ä»¶çš„ä½¿ç”¨æ–¹å¼å‡ ä¹æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥åœ¨å†™UIçš„æ—¶å€™åªè¦å¯¹è¿™äº›ç»„ä»¶è¿›è¡Œç»„è£…å³å¯ã€‚ ä¸€äº›å¸¸ç”¨ç»„ä»¶çš„å¸¸ç”¨ç”¨æ³•ã€‚ import 'package:flutter/material.dart'; void main() { runApp( new Center( child: new Text( 'Hello, world!', textDirection: TextDirection.ltr, ), ), ); } è¿™æ˜¯ä¸€æ®µhello wordä»£ç ï¼Œé¦–å…ˆ runApp æ˜¯ç¨‹åºçš„å…¥å£ï¼Œæ¥ä¸‹æ¥ä¾¿æ˜¯ä¸€ä¸ªWidgetsï¼ŒCenterè¿™æ˜¯ä¸€å¸ƒå±€ Widgets,ç„¶åé‡Œé¢æ˜¯ä¸€ä¸ªText Widgetsã€‚ åœ¨Flutterä¸­å°±æ˜¯è¿™æ ·çš„ï¼Œå¯èƒ½ä¸æ˜¯æ‰€æœ‰Widgetséƒ½æœ‰é€šç”¨çš„æ–¹æ³•ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡åŒ…è£¹åµŒå¥—æ¥å®ç°ã€‚ä¾‹å¦‚ texté»˜è®¤æ²¡æœ‰äº‹ä»¶ï¼Œå¯ä»¥é€šè¿‡äº‹ä»¶Widgetsè¿›è¡ŒåµŒå¥—å®ç°ã€‚ StatelessWidget å’Œ StatefulWidget æˆ‘ä»¬å†™çš„æ§ä»¶åŸºæœ¬éƒ½è¦ç»§æ‰¿è¿™ä¸¤ä¸ªï¼Œè¿™ä¸¤ä¸ªçš„ä¸»è¦åŒºåˆ«æ˜¯çœ‹é¡µé¢æ˜¯å¦éœ€è¦åŠ¨æ€åˆ·æ–°ï¼Œå»ºè®®ä¸éœ€è¦åˆ·æ–°æ—¶ä½¿ç”¨StatelessWidgetï¼Œå¦‚æœéœ€è¦åˆ·æ–°çš„è¯å¯ä»¥ä½¿ç”¨StatefulWidgetå¹¶é€šè¿‡è°ƒç”¨setStateæ¥é€šçŸ¥æ¡†æ¶æ”¹å˜çŠ¶æ€ã€‚ é‡Œé¢çš„buildå‡½æ•°å¼ widgets çš„å…¥å£å‡½æ•°ï¼Œå¯ä»¥åœ¨é‡Œé¢åˆ›å»ºå…¶ä»–çš„widgetsã€‚æ¡†æ¶å°†ä¼šä¸€æ¬¡æ„å»ºè¿™äº›widgetsï¼Œç›´åˆ°æœ€åº•å±‚çš„ RenderObject ä¹‹ä¸‹ï¼Œç„¶åè®¡ç®—æœºè¿›è¡Œè®¡ç®—ç›¸å…³çš„å›¾å½¢å¹¶æ¸²æŸ“å‡ºã€‚ ä¸€äº›å¸¸ç”¨Wigets ç”±äºWidgetsçš„æ ·å¼ä»¥åŠç”¨æ³•ï¼Œä¹‹å‰æ€»ç»“äº†ä¸€ä¸ªå•ç‹¬çš„demoï¼Œå¤§å®¶å¯ä»¥çœ‹demoï¼Œé‡Œé¢æœ‰å±•ç¤ºä»¥åŠä»£ç å…·ä½“å®ç°ã€‚ åœ°å€ï¼šhttps://github.com/xuanguofeng/flutter_widgets å¸¸ç”¨Widgets Flutterå†…ç½®äº†ä¸°å¯Œçš„å¸¸ç”¨çš„ç»„ä»¶ï¼ŒåŒ…æ‹¬æ–‡æœ¬ã€æŒ‰é’®ã€å›¾ç‰‡ã€è¡Œã€åˆ—ç­‰ç»„ä»¶ã€‚ Material Designé£æ ¼Widgets Flutterdå¯¹Material Designçš„æ”¯æŒå¾ˆä¸°å¯Œï¼Œä¹Ÿæä¾›äº†å¸‚é¢ç›®å‰æ¯”è¾ƒæµè¡Œçš„é£æ ¼ï¼Œæ¯”å¦‚Androidçš„ä¾§æ»‘ã€åº•éƒ¨çš„å¯¼èˆªç­‰ï¼Œå…·ä½“å¯ä»¥çœ‹æœ¬æ–‡åœ°ä¸‹çš„demoã€‚ Cupertinoçš„iOSé£æ ¼ç»„ä»¶ è¿™é‡Œä¹Ÿæ˜¯ä¸¾äº†ä¸€äº›æ§ä»¶çš„åç§°ï¼Œå¯¹iOSçš„æ”¯æŒä¹Ÿå¾ˆä¸°å¯Œï¼ŒåŒ…å«å¸¸ç”¨çš„titleæ ·å¼ã€åº•éƒ¨å¯¼èˆªã€iOSé£æ ¼çš„æŒ‰é’®ã€Dialodã€åŠ è½½ä¸­çš„loadingç­‰ã€‚ Layout Widgets Layoutçš„æ§ä»¶æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ï¼Œå› ä¸ºå¥½å¤šåŠŸèƒ½è¦é€šè¿‡åµŒå¥—æ¥å®ç°ã€‚ä¾‹å¦‚ marginã€paddingã€äº‹ä»¶çš„widgetsã€material designé£æ ¼çš„å¸ƒå±€ã€ç±»ä¼¼å¸§å¸ƒå±€çš„Stackã€GridViewã€ListViewã€Centerã€Alignç­‰ã€‚ å…¶ä»–è¿˜æœ‰å¾ˆå¤šæ§ä»¶ï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚ æ–‡æ¡£åœ°å€ï¼šhttp://doc.flutter-dev.cn/widgets/ ","link":"http://xuanguofeng.com/post/ã€Flutterç¬”è®°ã€‘ä¹‹Widgetçš„ä¸€äº›æ€»ç»“/"},{"title":"é—®é¢˜æ—¥å¿—-Flutteré¡µé¢è·³è½¬æ— ååº”çš„é—®é¢˜","content":"æè¿°ï¼šåœ¨ä½¿ç”¨Flutteråšé¡µé¢è·³è½¬æ—¶å€™ï¼Œå®˜æ–¹çš„æè¿°ä½¿ç”¨æ–¹æ³•æ˜¯è¿™æ ·çš„ã€‚ void main() { runApp(new MaterialApp( home: new MyAppHome(), // becomes the route named '/' routes: &lt;String, WidgetBuilder&gt; { '/a': (BuildContext context) =&gt; new MyPage(title: 'page A'), '/b': (BuildContext context) =&gt; new MyPage(title: 'page B'), '/c': (BuildContext context) =&gt; new MyPage(title: 'page C'), }, )); } æ¥ç€å°±å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼æ¥æ“ä½œ Routeã€‚ Navigator.of(context).pushNamed('/b'); çœ‹ä¸€äº›ä»£ç ç¡®å®ä¹Ÿæ˜¯è¿™æ ·ä½¿ç”¨çš„ï¼Œä½†æ˜¯ä¹‹å‰è‡ªå·±ä½¿ç”¨çš„æ—¶å€™å°±æ˜¯æ— æ³•è·³è½¬ã€‚ æç¤ºï¼š The context used to push or pop routes from the Navigator must be that of a widget that is a descendant of a Navigator widget. è§£å†³æ­¥éª¤ ä¸Šç½‘æŸ¥è¯¢èµ„æ–™ï¼Œæ­¤æ—¶Flutterçš„èµ„æ–™è¿˜ä¸æ˜¯å¾ˆå¤šã€‚ è§£å†³æ–¹æ³• class _FWMainAppState extends State&lt;FWMainApp&gt; { @override Widget build(BuildContext context) { return MaterialApp( theme: ThemeData( primaryColor: AppColors.colorPrimary, accentColor: Colors.blue), home: _Home(), routes: &lt;String, WidgetBuilder&gt;{ '/BtnSamplePage': (BuildContext context) =&gt; BtnSamplePage(), '/TextSamplePage': (BuildContext context) =&gt; TextSamplePage(), '/DialogSamplePage': (BuildContext context) =&gt; DialogSamplePage(), '/LayoutSamplePage': (BuildContext context) =&gt; LayoutSamplePage(), }, ); } } ä¸»è¦çœ‹home:ç”±äºè¿™æ˜¯é¦–é¡µä¹‹å‰åœ¨homeæ˜¯ç›´æ¥åˆ›å»ºçš„æ§ä»¶ï¼Œä¸€ç›´æç¤ºå¤±è´¥ã€‚ åæ¥é€šè¿‡homeï¼šåé¢å¼•å…¥ä¸€ä¸ªç±»ï¼Œåœ¨ç±»é‡Œåˆ›å»ºæƒ³è¦åˆ›å»ºçš„æ§ä»¶å°±è§£å†³äº†ã€‚ class _Home extends StatelessWidget { @override Widget build(BuildContext context) { return new Scaffold( appBar: AppBar( title: Text(AppStrings.appBarTitle), actions: &lt;Widget&gt;[ new IconButton( icon: const Icon(Icons.build), onPressed: () async {}, tooltip: 'tool', ) ], ), body: _body, ); } } ","link":"http://xuanguofeng.com/post/é—®é¢˜æ—¥å¿—-Flutteré¡µé¢è·³è½¬æ— ååº”çš„é—®é¢˜/"},{"title":"ã€Flutterç¬”è®°ã€‘ä¹‹Dartä¸Javaçš„ä¸€äº›ç›´è§‚åŒºåˆ«","content":"Dart æ˜¯ Flutter çš„ä¸»è¦å¼€å‘è¯­è¨€ï¼ŒFlutter æ˜¯ä¸€ä¸ªæ¥è‡ª Google ç”¨äºç§»åŠ¨åº”ç”¨å¼€å‘çš„ SDKã€‚å…¶å®å¯¹äºJavaå¼€å‘äººå‘˜æ¥è¯´Dartï¼Œè¿˜æ˜¯ç›¸å¯¹å¥½ç†è§£çš„ï¼Œè¿™ç¯‡ç¬”è®°å°†è®°å½•åˆå­¦Dartæ—¶ï¼Œç›¸æ¯”è¾ƒJavaçš„ä¸€äº›åŒºåˆ«ã€‚ ##åŒºåˆ« æ„é€ å‡½æ•° åœ¨Dartçš„æ„é€ ä¸­å¯ä»¥æ²¡æœ‰æ–¹æ³•ä½“ã€‚ //è¿™æ ·å†™å¾ˆç®€å• User(this.cadence, this.speed, this.gear); //ä¹Ÿå¯ä»¥å†™æˆè¿™æ · Bicycle(int cadence, int speed, int gear) { this.cadence = cadence; this.speed = speed; this.gear = gear; } å¯é€‰å‚æ•° åœ¨Dartä¸­å¯ä»¥ä½¿ç”¨å¯é€‰å‚æ•°ã€æ— è®ºæ˜¯æ„é€ è¿˜æ˜¯æ™®é€šæ–¹æ³•ã€‚ Book({this.money = 100, this.size = 0, this.author = null}); è°ƒç”¨çš„æ—¶å€™è¦æŒ‡å®šå‚æ•°å main() { print(Book(money:100 , size: 88, author:'test')); print(Book(money:99, size:100)); print(Rectangle()); } å…³é”®å­— åœ¨ Dart ä¸­æ²¡æœ‰è¯¸å¦‚ publicã€privateã€protected è¿™æ ·çš„å…³é”®è¯ã€‚ å¦‚æœä¸€ä¸ªæ ‡è¯†ç¬¦ä»¥ (_) å¼€å¤´ï¼Œåˆ™è¯¥æ ‡è¯†ç¬¦ åœ¨åº“å†…æ˜¯ç§æœ‰çš„ Dart2ä¸­ï¼Œå¯ä»¥ä¸ä½¿ç”¨newå…³é”®å­—åˆ›å»ºï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ã€‚ å˜é‡ Dartä¸­å˜é‡åˆå§‹å€¼ä¸ºnullï¼Œå³ä½¿æ˜¯intç±»å‹ä¹Ÿæ˜¯nullã€‚ Dartæ”¯æŒè‡ªè¯†åˆ«ï¼Œå¯ä»¥æ˜¯ç”¨varå®šä¹‰å˜é‡ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æŒ‡å®šå…·ä½“ç±»å‹ã€‚ å¦‚æœä½ ä»¥åä¸æ‰“ç®—ä¿®æ”¹ä¸€ä¸ªå˜é‡ï¼Œä½¿ç”¨ final æˆ–è€… constã€‚ ä¸€ä¸ª final å˜é‡åªèƒ½èµ‹å€¼ä¸€æ¬¡ï¼›ä¸€ä¸ª const å˜é‡æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ã€‚ åŸºæœ¬ç±»å‹ intå’Œdoubleæ˜¯numçš„å­ç±»ã€‚æ²¡æœ‰floatç±»å‹ã€‚ Dartä¸­æ‰€æœ‰çš„ç±»éƒ½æ˜¯Objectçš„å­ç±»ã€‚ Stringå¯ä»¥ä½¿ç”¨å•å¼•å·æˆ–è€…åŒå¼•å·ã€‚ Stringæ”¯æŒæ¨¡æ¿ï¼Œä½¿ç”¨ ${expression} çš„æ–¹å¼æ¥å®ç°å­—ç¬¦ä¸²æ¨¡æ¿çš„æ•ˆæœï¼Œå¦‚æœè¯¥è¡¨è¾¾å¼ä»…ä»…æ˜¯ä¸€ä¸ªæ ‡è¯†ç¬¦ï¼Œè¿˜å¯ä»¥å»æ‰èŠ±æ‹¬å· $variableNameã€‚ å­—ç¬¦ä¸²å‰åŠ rä»£è¡¨åŸå§‹å­—ç¬¦ä¸²ã€‚ åªæœ‰trueå’Œflaseæ˜¯boolç±»å‹ï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡ä¹Ÿæ˜¯ç¼–è¯‘æ—¶å¸¸é‡ã€‚å½“Dartéœ€è¦ä¸€ä¸ªå¸ƒå°”å€¼çš„æ—¶å€™ï¼Œåªæœ‰trueå¯¹è±¡æ‰è¢«è®¤ä¸ºtrue,å…¶ä»–éƒ½æ˜¯falseã€‚ æ–¹æ³• Dartæ˜¯ä¸€ä¸ªçœŸæ­£é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œæ–¹æ³•ä¹Ÿæ˜¯å¯¹è±¡å¹¶ä¸”å…·æœ‰ä¸€ç§ç±»å‹Functionã€‚ å¯ä»¥ä½¿ç”¨ä¸Šæ–‡è¯´çš„å¯é€‰æ–¹æ³•ã€‚ æ”¯æŒç›´æ¥è®¾ç½®é»˜è®¤å‚æ•°å€¼ã€‚ æ‰€æœ‰å‡½æ•°éƒ½è¿”å›ä¸€ä¸ªå€¼ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šè¿”å›å€¼ï¼Œåˆ™ é»˜è®¤æŠŠè¯­å¥ return null; ä½œä¸ºå‡½æ•°çš„æœ€åä¸€ä¸ªè¯­å¥æ‰§è¡Œã€‚ å¯ä»¥æŠŠæ–¹æ³•å½“åšå‚æ•°è°ƒç”¨å¦ä¸€ä¸ªæ–¹æ³•ã€‚ printElement(element) { print(element); } var list = [1, 2, 3]; // Pass printElement as a parameter. list.forEach(printElement); æ–¹æ³•ä¹Ÿå¯ä»¥èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ var loudify = (msg) =&gt; '!!! ${msg.toUpperCase()} !!!'; assert(loudify('hello') == '!!! HELLO !!!'); æ“ä½œç¬¦ ?? expr1 ?? expr2 å¦‚æœ expr1 æ˜¯ non-nullï¼Œè¿”å›å…¶å€¼ï¼› å¦åˆ™æ‰§è¡Œ expr2 å¹¶è¿”å›å…¶ç»“æœã€‚ .? å¯ä»¥é¿å…è¡¨è¾¾å¼å·¦è¾¹å¯¹è±¡ä¸ºnullæ—¶å€™æŠ›å‡ºå¼‚å¸¸ã€‚ çº§è”æ“ä½œç¬¦,çº§è”æ“ä½œç¬¦ (..) å¯ä»¥åœ¨åŒä¸€ä¸ªå¯¹è±¡ä¸Š è¿ç»­è°ƒç”¨å¤šä¸ªå‡½æ•°ä»¥åŠè®¿é—®æˆå‘˜å˜é‡ã€‚ querySelector('#button') // Get an object. ..text = 'Confirm' // Use its members. ..classes.add('important') ..onClick.listen((e) =&gt; window.alert('Confirmed!')); ç±»å‹åˆ¤å®šæ“ä½œç¬¦ asã€ isã€ å’Œ is! æ“ä½œç¬¦æ˜¯åœ¨è¿è¡Œæ—¶åˆ¤å®šå¯¹è±¡ ç±»å‹çš„æ“ä½œç¬¦ï¼š as ç±»å‹è½¬æ¢ is å¦‚æœå¯¹è±¡æ˜¯æŒ‡å®šçš„ç±»å‹è¿”å› True is! å¦‚æœå¯¹è±¡æ˜¯æŒ‡å®šçš„ç±»å‹è¿”å› False åªæœ‰å½“ obj å®ç°äº† T çš„æ¥å£ï¼Œ obj is T æ‰æ˜¯ trueã€‚ä¾‹å¦‚ obj is Object æ€»æ˜¯ trueã€‚ æ–­è¨€ Dartä¸­æ”¯æŒassertè¿™ä¸ªæ–­è¨€æ–¹æ³•ã€‚å¦‚æœæ–¹æ³•ç»“æœtrue,ç»§ç»­æ‰§è¡Œï¼Œå¦‚æœfalseåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚è¿™ä¸ªæ–¹æ³•åœ¨æ­£å¼åŒ…ä¸­å°†ä¸æ‰§è¡Œã€‚ // assert(æ¡ä»¶); ##æ€»ç»“ Dartå’ŒJavaè¿˜æ˜¯å¾ˆç›¸ä¼¼çš„ï¼Œå¯¹äºJavaç¨‹åºå‘˜ä¹Ÿæ˜¯ç›¸å¯¹å®¹æ˜“ä¸Šæ‰‹çš„ï¼Œç”±äºç°åœ¨æ˜¯åˆå­¦ï¼Œåªæ€»ç»“äº†ä¸€äº›å¸¸ç”¨çš„ï¼Œå½“ç„¶åŒºåˆ«è¿œè¿œä¸æ­¢è¿™äº›ï¼Œæ€»ç»“å¤§å¤šæ˜¯Dartä¸­æœ‰çš„Javaä¸­æ²¡æœ‰çš„ä¸œè¥¿ï¼Œä¼šä¸æ–­è¡¥å……ã€‚ ","link":"http://xuanguofeng.com/post/ã€Flutterç¬”è®°ã€‘ä¹‹Dartä¸Javaçš„ä¸€äº›ç›´è§‚åŒºåˆ«/"},{"title":"ã€Flutterç¬”è®°ã€‘ä¹‹Flutterçš„ç†è§£","content":"ç›®å‰å¯¹Flutterçš„ç†è§£è¿˜æ˜¯å¾ˆå°‘çš„ï¼Œåªæ˜¯æƒ³ä½œä¸ºä¸€ä¸ªç¬”è®°ï¼Œåœ¨ä¸æ–­ç†è§£çš„åŸºç¡€ä¸Šè¿›è¡Œä¸æ–­çš„ä¿®æ”¹ä¸å®Œå–„ï¼ŒæŸ¥æ¼è¡¥ç¼ºï¼Œçœ‹çœ‹è‡ªå·±å­¦ä¹‹å‰ä¸å­¦ä¹‹åæ˜¯çš„ç†è§£æ˜¯ä¸€ä¸ªä»€ä¹ˆçŠ¶æ€ã€‚ Flutterä»‹ç» Flutter æ˜¯è°·æ­Œçš„ç§»åŠ¨ç«¯ UI æ¡†æ¶ï¼Œå¯åœ¨æçŸ­çš„æ—¶é—´å†…æ„å»º Android å’Œ iOS ä¸Šé«˜è´¨é‡çš„åŸç”Ÿçº§åº”ç”¨ã€‚ Flutter å¯ä¸ç°æœ‰ä»£ç ä¸€èµ·å·¥ä½œ, å®ƒè¢«ä¸–ç•Œå„åœ°çš„å¼€å‘è€…å’Œç»„ç»‡ä½¿ç”¨, å¹¶ä¸” Flutter æ˜¯å…è´¹å’Œå¼€æºçš„. è¿™æ˜¯å®˜ç½‘çš„ä»‹ç»ï¼Œå¤§æ ‡é¢˜æ˜¯â€œä»¥æçŸ­çš„æ—¶é—´æ„å»ºä¼˜é›…çš„åŸç”Ÿçº§åº”ç”¨â€ï¼Œå¯ä»¥äº†è§£åˆ°Flutteræ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œé€šè¿‡è¿™ä¸ªæ¡†æ¶å¯ä»¥ä½¿ç”¨Dartè¯­è¨€é€šè¿‡ä¸€å¥—ä»£ç æ„å»ºAndroidå’ŒiOSåº”ç”¨ç¨‹åºã€‚ Flutteré‡Œé¢åŒæ—¶æä¾›äº†ä¸¤ç§UIåº“çš„é£æ ¼ï¼Œç¬¬ä¸€ç§è‚¯å®šæ˜¯Material Designé£æ ¼ï¼Œè¿˜è¦å°±æ˜¯Cupertinoé£æ ¼ï¼Œä¹Ÿå°±æ˜¯iOSä¸­é‡‡ç”¨çš„é£æ ¼ã€‚ ä¸ªäººç†è§£åº”è¯¥æ˜¯Flutterå°è£…äº†ä¸€å¥—å®Œæ•´çš„UIçš„APIï¼Œåœ¨å¼€å‘æ—¶å€™å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œé€šè¿‡å®˜ç½‘ä»‹ç»äº†è§£åº”è¯¥ä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨Androidå’ŒiOSä¸­çš„åŸç”ŸAPIã€‚ ä¸ºä»€ä¹ˆä½¿ç”¨Dartè¯­è¨€ï¼Ÿ ä¸ªäººå¯¹å…¶ä»–è¯­è¨€å¹¶æ²¡æœ‰äº†è§£é‚£ä¹ˆæ·±ï¼Œè¿™ä¸ªé—®é¢˜åªæ˜¯è¯´ä¸‹è‡ªå·±çš„æƒ³æ³•å’Œåœ¨ç½‘ä¸ŠæŸ¥åˆ°çš„ä¸€äº›äººçš„è§è§£ã€‚ é¦–å…ˆæˆ‘ä¸€çœ¼çœ‹ä¸Šå»ï¼Œæ„Ÿè§‰Dartçš„æ ¼å¼å¹¶ä¸å‹å¥½ï¼Œç›¸æ¯”Kotlinè§‰å¾—æ›´æ˜¯å¯è¯»æ€§å·®å¾ˆå¤šï¼Œæ®çŸ¥ä¹ä¸Šä¸€ä½å¤§ç¥è¯´å’ŒFlutterçš„å·¥ç¨‹å¸ˆå’¨è¯¢ï¼Œæ˜¯å› ä¸ºDartçš„å›¢é˜Ÿè·ç¦»ä»–ä»¬å¾ˆè¿‘ï¼Œèƒ½å¾ˆå¥½çš„å¾—åˆ°æ”¯æŒï¼Œä¸çŸ¥é“æ˜¯å¦ç©ç¬‘ã€‚ç”¨Dartä»£ç å†™é¡µé¢è¿˜æ˜¯å¾ˆå®¹æ˜“ç†è§£çš„ï¼Œè‡³äºä¸mxlç›¸æ¯”å“ªç§æ–¹å¼æ›´å¥½ç°åœ¨æˆ‘è¿˜ä½“ä¼šä¸å¥½ï¼Œå› ä¸ºè¿˜æ²¡æœ‰æ·±åº¦æ˜¯ä½¿ç”¨Dartã€‚ DartåŒæ—¶æ”¯æŒAOTç¼–è¯‘å’ŒJITç¼–è¯‘ï¼ŒDartçš„ç¼–è¯‘å’Œæ‰§è¡Œä¸ä»…éå¸¸çµæ´»ï¼Œè€Œä¸”é€Ÿåº¦å¾ˆå¿«ã€‚è¿˜æœ‰æˆ‘è§‰å¾—Dartæ˜¯ç›¸å¯¹å®¹æ˜“å­¦ä¹ çš„ã€‚ç”¨Flautterçš„æ—¶å€™è¿˜æ”¯æŒçƒ­é‡è½½ï¼Œè¿™ç›¸æ¯”Instant Runçš„ä½“éªŒè¦å¥½å¾ˆå¤šçš„ï¼Œç¡®å®æé«˜äº†æ•ˆç‡ï¼Œä¸ä¼šå› ä¸ºåªæ”¹äº†ä¸€ç‚¹é¡µé¢è€Œç¼–è¯‘å¥½ä¹…çš„çŠ¶å†µã€‚Dartæ˜¯åŸºäºå•çº¿ç¨‹æ¨¡å‹çš„è¯­è¨€ï¼Œä½†æ˜¯ä¹Ÿæœ‰è‡ªå·±çš„æœºåˆ¶å«isolateã€‚ä¹‹é—´æ— æ³•ç›´æ¥å…±äº«å†…å­˜ï¼Œè¿™ä¹Ÿå°±æ˜¯é¿å…äº†å¤§éƒ¨åˆ†ä½¿ç”¨é”çš„æƒ…å†µã€‚ è¿˜æœ‰å°±æ˜¯è¿™æ˜¯Googleè‡ªå·±çš„è¯­è¨€ï¼Œä¹Ÿæ˜¯å¼€æºçš„ï¼Œä¸ä¼šæƒ¹å‡º88äº¿ç¾å…ƒçš„çš„å®˜å¸å§ã€‚æ€»ä½“æ„Ÿè§‰é€šè¿‡äº†è§£ï¼Œè¿˜æ˜¯ä¸€é—¨å¾ˆä¼˜ç§€çš„è¯­è¨€ï¼Œè€Œä¸”åœ¨Googleå†…å¤–æ®è¯´ä¹Ÿå¾—åˆ°å¾ˆå¥½çš„ä½¿ç”¨ï¼Œè€Œä¸”éšç€Flutterä»¥åŠæ–°ç³»ç»Ÿçš„æ¨å‡ºï¼Œè¿™é—¨è¯­è¨€ä¹Ÿæœ‰å¯èƒ½è¶Šæ¥è¶Šå¥½ï¼Œä¸è¿‡åé¢æƒ…å†µè°ä¹Ÿè¯´ä¸å¥½ï¼Œè¿˜è¦çœ‹Googleæ€ä¹ˆæ”¯æŒä¸æ¨å¹¿ã€‚ Flutteræ˜¯å¦‚ä½•æ¸²æŸ“ç•Œé¢çš„ï¼Ÿ ç§»åŠ¨è®¾å¤‡ä¸­æœ‰GPUå’ŒCPUï¼Œä¸€èˆ¬æ˜¯GPUæ§åˆ¶å°†æ•°æ®æ¸²æŸ“åˆ°æ˜¾ç¤ºè®¾å¤‡ä¸Šçš„ï¼ŒGPUä¸»è¦æ˜¯é€šè¿‡å‘å‡ºVSyncåŒæ­¥ä¿¡å·å»å¸§æ•°æ®æ¥ä¼ é€’ç»™æ˜¾ç¤ºå™¨ã€‚ FPSè¡¨ç¤ºæ¯ç§’ä¼ é€’çš„å¸§æ•°ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨ç†æƒ³æƒ…å†µä¸‹60FPSå°±æ„Ÿè§‰ä¸åˆ°çˆ±çœ‹ï¼Œè¿™æ„å‘³ç€æ¯ä¸ªç»˜åˆ¶æ—¶é•¿åº”è¯¥åœ¨16msä»¥å†…ï¼ŒAndroidç³»ç»Ÿæ¯éš”16mså‘å‡ºVSyncä¿¡å·ï¼Œè§¦å‘å¯¹UIè¿›è¡Œæ¸²æŸ“ï¼Œå¦‚æœæ¯æ¬¡æ¸²æŸ“éƒ½æˆåŠŸï¼Œè¿™æ ·å°±èƒ½å¤Ÿè¾¾åˆ°åˆ˜ç•…çš„ç”»é¢æ‰€éœ€çš„60FPSã€‚å¦‚æœæŸä¸ªæ“ä½œèŠ±è´¹å››ä»¶æ¯”è¾ƒåƒé•¿ æ¯”å¦‚ç”¨äº†30msï¼Œç³»ç»Ÿåœ¨å¾—åˆ°VSyncä¿¡å·æ—¶å°±æ— æ³•è¿›è¡Œæ­£å¸¸æ¸²æŸ“ï¼Œè¿™æ ·å°±å‘ç”Ÿäº†ä¸¢å¸§ç°è±¡ï¼Œå°±ä¼šæ„Ÿè§‰å¡é¡¿ã€‚ æ‰€ä»¥ç©æ¸¸æˆçš„æ—¶å€™éœ€è¦æ›´å¥½çš„CPUä¸GPUçš„æ”¯æŒã€‚ Flutteråªå…³å¿ƒå‘GPUæä¾›è§†å›¾æ•°æ®ï¼Œåªå…³å¿ƒVSyncä¿¡å·ï¼Œç„¶åé€šè¿‡Googleè‡ªå·±çš„Skiaæ¸²æŸ“å¼•æ“æƒ³GPUæä¾›æ•°æ®ã€‚æ‰€ä»¥è¯´Flutteræ˜¯ç›´æ¥é€šè¿‡Skiaè‡ªå·±è¿›è¡Œæ¸²æŸ“ï¼Œè€Œä¸æ˜¯è°ƒç”¨æŸäº›APIï¼Œè¿™ä¹Ÿæ˜¯Flutterä¸€ç›´å®£ç§°åŸç”Ÿä½“éªŒçš„åŸå› ã€‚ Flutterå‰æ™¯å¦‚ä½•ï¼Œæ˜¯å¦å€¼å¾—å­¦ä¹ ï¼Ÿ è¿™ä¸ªæ¯ä¸ªäººçš„çœ‹æ³•ä¸åŒï¼Œä¸ªäººè®¤ä¸ºå‰æ™¯è¿˜å¯ä»¥ï¼Œä¸React NativeåŸç†ä¸åŒï¼ŒFlutteræ˜¯é€šè¿‡è‡ªå·±æ¸²æŸ“ï¼Œå¯èƒ½ä¼šä½“éªŒä¼šæ›´å¥½ã€‚ä½¿ç”¨Dartè¯­è¨€ï¼Œè¿™é—¨è¯­è¨€ç›®å‰çœ‹æ¥è¯´å¯¹äºæœ‰ç¼–ç¨‹ç»éªŒçš„äººæ¥è¯´å¯èƒ½è¿˜æ˜¯ç›¸å¯¹å®¹æ˜“äº›çš„ï¼Œè€Œæ”¯æŒåº“ç›®å‰æ¥çœ‹ä¹Ÿè¿˜å¯ä»¥ï¼Œä¹Ÿè¦çœ‹Googleåç»­çš„åŠ¨ä½œå§ã€‚ å¯¹äºå…¬å¸æ¥è¯´å¦‚æœç»´æŠ¤ä¸€å¥—ä»£ç æ¥å®ç°ä¸¤ä¸ªç«¯æ— ç–‘æ—¶é—´å¥½äº‹ï¼Œä»èŠ‚çº¦æˆæœ¬ã€åˆ°æ–¹ä¾¿ç»´æŠ¤ã€ç•Œé¢ç»Ÿä¸€éƒ½æ˜¯å¾ˆå¥½çš„ï¼Œä½†æ˜¯Flutterå•†ç”¨åº”è¯¥ä»æœ‰ä¸€æ®µè·ç¦»å§ã€‚ å¦‚æœæœ‰æ—¶é—´åˆæœ‰å…´è¶£çš„è¯ï¼Œå¯ä»¥æä¸€ä¸‹çš„ï¼Œæ¯•ç«Ÿç¨‹åºå‘˜å°±æ˜¯åœ¨ä¸æ–­å­¦ä¹ çš„é“è·¯ä¸Šã€‚ ","link":"http://xuanguofeng.com/post/ã€Flutterç¬”è®°ã€‘ä¹‹Flutterçš„ç†è§£/"},{"title":"ã€Flutterç¬”è®°ã€‘ä¹‹ç¯å¢ƒæ­å»º","content":"Flutter æ˜¯ Google ç”¨ä»¥å¸®åŠ©å¼€å‘è€…åœ¨ iOS å’Œ Android ä¸¤ä¸ªå¹³å°å¼€å‘é«˜è´¨é‡åŸç”Ÿ UI çš„ç§»åŠ¨ SDKã€‚Flutter å…¼å®¹ç°æœ‰çš„ä»£ç ï¼Œå…è´¹ä¸”å¼€æºã€‚ä½¿ç”¨Dartè¯­è¨€ã€‚ åŸºäºAndroid Studioç¯å¢ƒæ­å»º æ”¯æŒflutterçš„IDE ç›®å‰æœ‰Android Studioã€ IntelliJã€Visual Studioã€‚ å®‰è£… Flutter å’Œ Dart æ’ä»¶ åœ¨Android Studioä¸­å®‰è£…è¿™ä¸¤ä¸ªæ’ä»¶ã€‚ Flutter æ’ä»¶å¯ä»¥æé«˜ Flutter åœ¨å¼€å‘è¿‡ç¨‹ä¸­çš„å¼€å‘æ•ˆç‡ï¼ˆè¿è¡Œï¼Œè°ƒè¯•ï¼Œçƒ­é‡è½½ç­‰ç­‰ï¼‰ã€‚ Dart æ’ä»¶ææå‡äº†ä»£ç å±‚é¢çš„å¼€å‘æ•ˆç‡ï¼ˆåœ¨ä½ æ•²ä»£ç çš„åŒæ—¶è¿›è¡Œä»£ç æ ¡éªŒï¼Œä»£ç è‡ªåŠ¨è¡¥å…¨ç­‰ç­‰ï¼‰ã€‚ å®‰è£…æ­¥éª¤ å¯åŠ¨ Android Studioã€‚ æ‰“å¼€æ’ä»¶è®¾ç½®ï¼ˆåœ¨ macOS ä¸Šè·¯å¾„ä¸º Preferences&gt;Pluginsï¼Œåœ¨ Windows å’Œ Linux ä¸Šè·¯å¾„ä¸º File&gt;Settings&gt;Pluginsï¼‰ã€‚ å½“å¼¹å‡ºå¯¹è¯æ¡†æç¤ºè¦å®‰è£… Dart æ’ä»¶çš„æ—¶å€™ï¼Œç‚¹å‡» Yes æ¥å—ã€‚ å¦‚æœå¼¹å‡º Restart éœ€è¦é‡å¯ç¼–è¾‘å™¨çš„æ—¶å€™ï¼Œç‚¹å‡» Yes æ¥å—ã€‚ ã€æ³¨æ„ã€‘ ç¬¬ä¸€æ¬¡è¿è¡Œæ—¶å€™è¦é€‰æ‹©æŒ‡å®šçš„æ–‡ä»¶å¤¹ï¼Œç„¶åç‚¹å‡»install SDK æ¥å®‰è£…Flutter SDKç¯å¢ƒï¼Œå¯èƒ½éœ€è¦ä¸‹è½½ä¸€ä¼šã€‚ Hello Word åœ¨Android Studioä¸­åˆ›å»ºé¡¹ç›®çš„æ—¶å€™ä¼šæœ‰New Flutter Projecté€‰é¡¹è¿™æ—¶å€™å¦‚æœæœ¬åœ°æ²¡æœ‰Flutterç¯å¢ƒçš„è¯ ä¼šè®©ä½ ä¸‹è½½ã€‚ åˆ›å»ºåå¯ä»¥çœ‹åˆ°IDEçš„å³ä¸Šè§’æœ‰äº›åŠŸèƒ½æŒ‰é’®ã€‚ å¯ä»¥çœ‹åˆ°è¿™é‡Œä¸ä½†æœ‰Androidçš„ç›®å½•ï¼Œè¿˜æœ‰iOSçš„ç›®å½•ï¼Œè¿è¡Œçš„æ—¶å€™å¦‚æœæœ‰iOSè®¾å¤‡ä»¥åŠæ¨¡æ‹Ÿå™¨çš„è¯ æ˜¯å¯ä»¥ç›´æ¥é€‰æ‹©è¿è¡Œçš„ã€‚ å³ä¾§é—ªç”µçš„æ ‡å¿—æ”¯æŒçƒ­é‡è½½ç¼–è¯‘è¿è¡Œã€‚ ç”±äºæˆ‘æ˜¯macç”µè„‘ï¼Œç‰¹æ„é€‰äº†ä¸€ä¸ªiOSæ¨¡æ‹Ÿå™¨ï¼Œåœ¨Android Studioç›´æ¥è¿è¡Œåœ¨iOSè®¾å¤‡ä¸Šè¿˜æ˜¯å¾ˆçˆ½çš„ã€‚ ","link":"http://xuanguofeng.com/post/ã€Flutterç¬”è®°ã€‘ä¹‹ç¯å¢ƒæ­å»º/"},{"title":"Androidçƒ­é—¨å¼€æºæ¡†æ¶-OkHttpæºç æ¢ç©¶äº”","content":"å‰é¢åŸºæœ¬ä»‹ç»äº†OkHttpçš„æµç¨‹ä»¥åŠæºç ï¼Œè¿™é‡Œçœ‹æœ€åä¸€ä¸ªé‡è¦çš„æ ¸å¿ƒæºç OkHttpä¸­çš„æ‹¦æˆªå™¨ã€‚ æ‹¦æˆªå™¨æœºåˆ¶ æ‹¦æˆªå™¨æ˜¯OkHttpä¸­ä¸€ä¸ªå¼ºå¤§çš„æœºåˆ¶ï¼Œèƒ½å®ç°ç½‘ç»œç›‘å¬ï¼Œè¯·æ±‚ä»¥åŠå“åº”é‡å†™ï¼Œè¯·ç¤ºå¤±è´¥é‡è¯•ç­‰åŠŸèƒ½ã€‚ æ‹¦æˆªå™¨é“¾ getResponseWithInterceptorChain æ–¹æ³• ä¹‹å‰è¯´åˆ°ä¸»è¦æ˜¯é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥è¿”å›responseé‚£ä¹ˆæ¥çœ‹çœ‹è¿™ä¸ªæ–¹æ³•é‡Œç©¶ç«Ÿæ˜¯åšäº†ä»€ä¹ˆå‘¢ Response getResponseWithInterceptorChain() throws IOException { // Build a full stack of interceptors. List&lt;Interceptor&gt; interceptors = new ArrayList&lt;&gt;(); interceptors.addAll(client.interceptors()); interceptors.add(retryAndFollowUpInterceptor); interceptors.add(new BridgeInterceptor(client.cookieJar())); interceptors.add(new CacheInterceptor(client.internalCache())); interceptors.add(new ConnectInterceptor(client)); if (!forWebSocket) { interceptors.addAll(client.networkInterceptors()); } interceptors.add(new CallServerInterceptor(forWebSocket)); Interceptor.Chain chain = new RealInterceptorChain(interceptors, null, null, null, 0, originalRequest, this, eventListener, client.connectTimeoutMillis(), client.readTimeoutMillis(), client.writeTimeoutMillis()); return chain.proceed(originalRequest); } é¦–å…ˆæ·»åŠ è‡ªå®šä¹‰é…ç½®çš„æ‹¦æˆªå™¨ ç„¶åä»¥æ­¤æ·»åŠ ç³»ç»Ÿå†…ç½®çš„æ‹¦æˆªå™¨ ç„¶ååˆ›å»ºRealInterceptorChainå¹¶æŠŠè¿™ä¸ªé›†åˆæ·»åŠ è¿›å»ï¼Œè¿™ä¸ªå°±æ˜¯ä¸ªæ‹¦æˆªå™¨é“¾ é€šè¿‡chain.proceed(originalRequest);è¿™ä¸ªæ–¹æ³•æ‰§è¡Œ proceedè¿™ä¸ªæ–¹æ³•ä¹Ÿå¾ˆé‡è¦ å¯ä»¥çœ‹ä¸€ä¸‹ public Response proceed(Request request, StreamAllocation streamAllocation, HttpCodec httpCodec, RealConnection connection) throws IOException { if (index &gt;= interceptors.size()) throw new AssertionError(); calls++; // If we already have a stream, confirm that the incoming request will use it. if (this.httpCodec != null &amp;&amp; !this.connection.supportsUrl(request.url())) { throw new IllegalStateException(&quot;network interceptor &quot; + interceptors.get(index - 1) + &quot; must retain the same host and port&quot;); } // If we already have a stream, confirm that this is the only call to chain.proceed(). if (this.httpCodec != null &amp;&amp; calls &gt; 1) { throw new IllegalStateException(&quot;network interceptor &quot; + interceptors.get(index - 1) + &quot; must call proceed() exactly once&quot;); } //æ³¨æ„å¤„ // Call the next interceptor in the chain. RealInterceptorChain next = new RealInterceptorChain(interceptors, streamAllocation, httpCodec, connection, index + 1, request, call, eventListener, connectTimeout, readTimeout, writeTimeout); Interceptor interceptor = interceptors.get(index); Response response = interceptor.intercept(next); // Confirm that the next interceptor made its required call to chain.proceed(). if (httpCodec != null &amp;&amp; index + 1 &lt; interceptors.size() &amp;&amp; next.calls != 1) { throw new IllegalStateException(&quot;network interceptor &quot; + interceptor + &quot; must call proceed() exactly once&quot;); } // Confirm that the intercepted response isn't null. if (response == null) { throw new NullPointerException(&quot;interceptor &quot; + interceptor + &quot; returned null&quot;); } if (response.body() == null) { throw new IllegalStateException( &quot;interceptor &quot; + interceptor + &quot; returned a response with no body&quot;); } return response; } è¿™é‡Œä¸»è¦çœ‹æ ‡æ³¨çš„æ³¨æ„å¤„ è¿™é‡Œä¸»è¦é€šè¿‡index+1åˆ›å»ºäº†ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œä¹Ÿå°±è¡Œç¨‹äº†æ‹¦æˆªå™¨é“¾ ç„¶åé€šè¿‡æ¯ä¸ªæ‹¦æˆªå™¨ä¸­éƒ½æœ‰interceptè¿™ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¸­è¿”å›responseç„¶åè¿›è¡Œè¿”å›ã€‚ è¿™é‡Œæœ‰ä¸ªæµç¨‹æ˜¯å¾ˆæœ‰æ„æ€çš„å°±æ˜¯åœ¨proceed()æ–¹æ³•é‡Œä¼šä¼šè¿”å›ä¸€ä¸ªResponse è€Œ è¿™ä¸ªResponseæ˜¯é€šè¿‡intercep()è¿™ä¸ªæ–¹æ³•å¹¶ä¼ å…¥ä¸€ä¸ªæ‹¦æˆªå™¨è¿”å›çš„ï¼Œè€Œåœ¨å„ä¸ªæ‹¦æˆªå™¨ä¸­åˆé€šè¿‡ä¼ å…¥çš„æ‹¦æˆªå™¨è°ƒå›å»ï¼Œè¿™ä¹Ÿæ˜¯æ‹¦æˆªå™¨æµç¨‹çš„æ ¸å¿ƒæœºåˆ¶ã€‚ä»è€Œå®ç°äº†æ‹¦æˆªå™¨é“¾ï¼Œåªæœ‰æ‰€æœ‰çš„æ‹¦æˆªå™¨æ‰§è¡Œå®Œæ¯•åï¼Œä¸€ä¸ªç½‘ç»œè¯·æ±‚çš„å“åº”response æ‰ä¼šè¢«è¿”å›ã€‚ å†…ç½®æ‹¦æˆªå™¨ OkHttpä¸­çš„å†…ç½®è¿æ¥å™¨éƒ½åŸºå®ç°äº†é€šç”¨çš„æ¥å£ RetryAndFollowUpInterceptor æ¥å£é‡å®šå‘æ‹¦æˆªå™¨ è¿™ä¸ªæ‹¦æˆªå™¨ä¸»è¦æ˜¯æ ¹æ®ç»“æœåˆ¤æ–­ç„¶åè¿›è¡Œé‡è¯•çš„æ‹¦æˆªå™¨ @Override public Response intercept(Chain chain) throws IOException { Request request = chain.request(); RealInterceptorChain realChain = (RealInterceptorChain) chain; Call call = realChain.call(); EventListener eventListener = realChain.eventListener(); streamAllocation = new StreamAllocation(client.connectionPool(), createAddress(request.url()), call, eventListener, callStackTrace); int followUpCount = 0; Response priorResponse = null; while (true) { if (canceled) {//æ³¨æ„å¤„1 streamAllocation.release(); throw new IOException(&quot;Canceled&quot;); } Response response; boolean releaseConnection = true; try {//æ³¨æ„å¤„2 response = realChain.proceed(request, streamAllocation, null, null); releaseConnection = false; } catch (RouteException e) { // The attempt to connect via a route failed. The request will not have been sent. if (!recover(e.getLastConnectException(), false, request)) { throw e.getLastConnectException(); } releaseConnection = false; continue; } catch (IOException e) { // An attempt to communicate with a server failed. The request may have been sent. boolean requestSendStarted = !(e instanceof ConnectionShutdownException); if (!recover(e, requestSendStarted, request)) throw e; releaseConnection = false; continue; } finally { // We're throwing an unchecked exception. Release any resources. if (releaseConnection) { streamAllocation.streamFailed(null); streamAllocation.release(); } } // Attach the prior response if it exists. Such responses never have a body. if (priorResponse != null) { response = response.newBuilder() .priorResponse(priorResponse.newBuilder() .body(null) .build()) .build(); } Request followUp = followUpRequest(response); if (followUp == null) { if (!forWebSocket) { streamAllocation.release(); } return response; } closeQuietly(response.body()); if (++followUpCount &gt; MAX_FOLLOW_UPS) { streamAllocation.release(); throw new ProtocolException(&quot;Too many follow-up requests: &quot; + followUpCount); } if (followUp.body() instanceof UnrepeatableRequestBody) { streamAllocation.release(); throw new HttpRetryException(&quot;Cannot retry streamed HTTP body&quot;, response.code()); } if (!sameConnection(response, followUp.url())) { streamAllocation.release(); streamAllocation = new StreamAllocation(client.connectionPool(), createAddress(followUp.url()), call, eventListener, callStackTrace); } else if (streamAllocation.codec() != null) { throw new IllegalStateException(&quot;Closing the body of &quot; + response + &quot; didn't close its backing stream. Bad interceptor?&quot;); } request = followUp; priorResponse = response; } } å…·ä½“åˆ†æä¸‹æµç¨‹ é¦–å…ˆä¼šåˆ›å»ºä¸€ä¸ªStreamAllocationå¯¹è±¡ å…¶å®ä¸»è¦çœ‹whileå¾ªç¯é‡Œé¢çš„æ–¹æ³•ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªæ­»å¾ªç¯æ¥è¿›è¡Œå°è¯•ï¼Œé¦–å…ˆä¼šåˆ¤æ–­æ˜¯å¦å–æ¶ˆäº†è¯·æ±‚ï¼Œå¦‚æœå–æ¶ˆè¿›è¡Œé‡Šæ”¾ï¼Œå¹¶æŠ›å‡ºå¼‚å¸¸ï¼Œå¦‚æ³¨æ„å¤„1. ç„¶åä¸»æ³¨æ„å¤„2è¦è¿›è¡Œè¯·æ±‚ï¼Œç„¶åé€šè¿‡catchåˆ¤æ–­å„ç§éœ€è¦é‡æ–°è¿æ¥çš„æƒ…å†µï¼Œå¦‚æœé‡æ–°è¿æ¥å°±é€šè¿‡continueç›´æ¥åœ¨è¿›è¡Œä¸€éå¾ªç¯ã€‚ å½“ä»£ç å¯ä»¥æ‰§è¡Œåˆ° followUpRequest æ–¹æ³•å°±è¡¨ç¤ºè¿™ä¸ªè¯·æ±‚æ˜¯æˆåŠŸçš„ï¼Œä½†æ˜¯æœåŠ¡å™¨è¿”å›çš„çŠ¶æ€ç å¯èƒ½ä¸æ˜¯ 200 ok çš„æƒ…å†µï¼Œè¿™æ—¶è¿˜éœ€è¦å¯¹è¯¥è¯·æ±‚è¿›è¡Œæ£€æµ‹ï¼Œå…¶ä¸»è¦å°±æ˜¯é€šè¿‡è¿”å›ç è¿›è¡Œåˆ¤æ–­çš„ï¼Œç„¶åå¦‚æœæ²¡é—®é¢˜å°±ä¼šè¿”å›respnseå¹¶ç»“æŸå¾ªç¯ã€‚ å¦‚æœæ²¡æœ‰æ­£å¸¸è¿”å›ç»“æœçš„è¯åé¢ä¼šå…³é—­è¯·æ±‚è¿˜ä¼šåšä¸€äº›å¼‚å¸¸æ£€æŸ¥ï¼Œå¦‚é‡æ–°è¿æ¥çš„æ¬¡æ•°æ˜¯å¦è¶…è¿‡äº†æœ€å¤§æ¬¡æ•°ä¹‹ç±»çš„ã€‚ BridgeInterceptor è¯·æ±‚å’Œå“åº”è½¬åŒ–æ‹¦æˆªå™¨ è¿™ä¸ªæ‹¦æˆªå™¨ä¸»è¦è´Ÿè´£è®¾ç½®å†…å®¹é•¿åº¦ï¼Œç¼–ç æ–¹å¼ä»¥åŠä¸€äº›å‹ç¼©ç­‰é…ç½®ï¼Œä¸»è¦æ˜¯æ·»åŠ å¤´éƒ¨ä¿¡æ¯çš„åŠŸèƒ½ã€‚ @Override public Response intercept(Chain chain) throws IOException { Request userRequest = chain.request(); Request.Builder requestBuilder = userRequest.newBuilder(); RequestBody body = userRequest.body(); if (body != null) { MediaType contentType = body.contentType(); if (contentType != null) { requestBuilder.header(&quot;Content-Type&quot;, contentType.toString()); } long contentLength = body.contentLength(); if (contentLength != -1) { requestBuilder.header(&quot;Content-Length&quot;, Long.toString(contentLength)); requestBuilder.removeHeader(&quot;Transfer-Encoding&quot;); } else { requestBuilder.header(&quot;Transfer-Encoding&quot;, &quot;chunked&quot;); requestBuilder.removeHeader(&quot;Content-Length&quot;); } } if (userRequest.header(&quot;Host&quot;) == null) { requestBuilder.header(&quot;Host&quot;, hostHeader(userRequest.url(), false)); } if (userRequest.header(&quot;Connection&quot;) == null) { requestBuilder.header(&quot;Connection&quot;, &quot;Keep-Alive&quot;); } // If we add an &quot;Accept-Encoding: gzip&quot; header field we're responsible for also decompressing // the transfer stream. boolean transparentGzip = false; if (userRequest.header(&quot;Accept-Encoding&quot;) == null &amp;&amp; userRequest.header(&quot;Range&quot;) == null) { transparentGzip = true; requestBuilder.header(&quot;Accept-Encoding&quot;, &quot;gzip&quot;); } List&lt;Cookie&gt; cookies = cookieJar.loadForRequest(userRequest.url()); if (!cookies.isEmpty()) { requestBuilder.header(&quot;Cookie&quot;, cookieHeader(cookies)); } if (userRequest.header(&quot;User-Agent&quot;) == null) { requestBuilder.header(&quot;User-Agent&quot;, Version.userAgent()); } Response networkResponse = chain.proceed(requestBuilder.build()); HttpHeaders.receiveHeaders(cookieJar, userRequest.url(), networkResponse.headers()); Response.Builder responseBuilder = networkResponse.newBuilder() .request(userRequest); if (transparentGzip &amp;&amp; &quot;gzip&quot;.equalsIgnoreCase(networkResponse.header(&quot;Content-Encoding&quot;)) &amp;&amp; HttpHeaders.hasBody(networkResponse)) { GzipSource responseBody = new GzipSource(networkResponse.body().source()); Headers strippedHeaders = networkResponse.headers().newBuilder() .removeAll(&quot;Content-Encoding&quot;) .removeAll(&quot;Content-Length&quot;) .build(); responseBuilder.headers(strippedHeaders); String contentType = networkResponse.header(&quot;Content-Type&quot;); responseBuilder.body(new RealResponseBody(contentType, -1L, Okio.buffer(responseBody))); } return responseBuilder.build(); } è¿™é‡Œé€šè¿‡æ³¨æ„å‡ºå¯ä»¥çœ‹åˆ°å…¶ä¸­ä¸€ä¸ªä¸»è¦çš„åŠŸèƒ½å°±æ˜¯ï¼Œå¦‚æœåˆšå¼€å§‹æˆ‘ä»¬æ²¡æœ‰é…ç½®ä¸€äº›è¯·æ±‚å¤´ä¿¡æ¯ä¼šæ·»åŠ ä¸€äº›é»˜è®¤çš„è¯·æ±‚å¤´ä¿¡æ¯ã€‚ è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªé‡è¦åŠŸèƒ½å°±æ˜¯ åˆ¤æ–­æ˜¯å¦éœ€è¦ä½¿ç”¨Gzipå‹ç¼©åŠŸèƒ½ã€‚ä»¥åŠå°†ç½‘ç»œè¯·æ±‚å›æ¥çš„å“åº”Responseè½¬åŒ–ä¸ºæ°¸åå¯ç”¨çš„response CacheInterceptor ç¼“å­˜æ‹¦æˆªå™¨ @Override public Response intercept(Chain chain) throws IOException { Response cacheCandidate = cache != null ? cache.get(chain.request()) : null; long now = System.currentTimeMillis(); CacheStrategy strategy = new CacheStrategy.Factory(now, chain.request(), cacheCandidate).get(); Request networkRequest = strategy.networkRequest; Response cacheResponse = strategy.cacheResponse; if (cache != null) { cache.trackResponse(strategy); } if (cacheCandidate != null &amp;&amp; cacheResponse == null) { closeQuietly(cacheCandidate.body()); // The cache candidate wasn't applicable. Close it. } // If we're forbidden from using the network and the cache is insufficient, fail. if (networkRequest == null &amp;&amp; cacheResponse == null) { return new Response.Builder() .request(chain.request()) .protocol(Protocol.HTTP_1_1) .code(504) .message(&quot;Unsatisfiable Request (only-if-cached)&quot;) .body(Util.EMPTY_RESPONSE) .sentRequestAtMillis(-1L) .receivedResponseAtMillis(System.currentTimeMillis()) .build(); } // If we don't need the network, we're done. if (networkRequest == null) { return cacheResponse.newBuilder() .cacheResponse(stripBody(cacheResponse)) .build(); } Response networkResponse = null; try { networkResponse = chain.proceed(networkRequest); } finally { // If we're crashing on I/O or otherwise, don't leak the cache body. if (networkResponse == null &amp;&amp; cacheCandidate != null) { closeQuietly(cacheCandidate.body()); } } // If we have a cache response too, then we're doing a conditional get. if (cacheResponse != null) { if (networkResponse.code() == HTTP_NOT_MODIFIED) { Response response = cacheResponse.newBuilder() .headers(combine(cacheResponse.headers(), networkResponse.headers())) .sentRequestAtMillis(networkResponse.sentRequestAtMillis()) .receivedResponseAtMillis(networkResponse.receivedResponseAtMillis()) .cacheResponse(stripBody(cacheResponse)) .networkResponse(stripBody(networkResponse)) .build(); networkResponse.body().close(); // Update the cache after combining headers but before stripping the // Content-Encoding header (as performed by initContentStream()). cache.trackConditionalCacheHit(); cache.update(cacheResponse, response); return response; } else { closeQuietly(cacheResponse.body()); } } Response response = networkResponse.newBuilder() .cacheResponse(stripBody(cacheResponse)) .networkResponse(stripBody(networkResponse)) .build(); if (cache != null) { if (HttpHeaders.hasBody(response) &amp;&amp; CacheStrategy.isCacheable(response, networkRequest)) { // Offer this request to the cache. CacheRequest cacheRequest = cache.put(response); return cacheWritingResponse(cacheRequest, response); } if (HttpMethod.invalidatesCache(networkRequest.method())) { try { cache.remove(networkRequest); } catch (IOException ignored) { // The cache cannot be written. } } } return response; } ä¸»è¦æµç¨‹ï¼Œå…ˆåˆ¤æ–­æ˜¯å¦æœ‰ç¼“å­˜ã€‚ç„¶åå¦‚æœç¼“å­˜ä¸å¯ç”¨ä¼šå…³é—­ï¼Œç„¶ååœ¨ä¼šåˆ¤æ–­ç½‘ç»œç¦æ­¢çš„è¯å’Œç¼“å­˜éƒ½ä¸å¯ç”¨çš„è¯ä¼šåˆ›å»ºä¸€ä¸ªå“åº”è¿”å›504 // If we're forbidden from using the network and the cache is insufficient, fail. if (networkRequest == null &amp;&amp; cacheResponse == null) { return new Response.Builder() .request(chain.request()) .protocol(Protocol.HTTP_1_1) .code(504) .message(&quot;Unsatisfiable Request (only-if-cached)&quot;) .body(Util.EMPTY_RESPONSE) .sentRequestAtMillis(-1L) .receivedResponseAtMillis(System.currentTimeMillis()) .build(); } å¦‚æœå‰é¢çš„æ¡ä»¶éƒ½ä¸ç¬¦åˆï¼Œä¼šè¯»å–ç½‘ç»œç»“æœä¹Ÿå°±æ˜¯ä¼šè·³è½¬åˆ°ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œ if (networkResponse.code() == HTTP_NOT_MODIFIED) è¿™é‡Œä¼šåˆ¤æ–­å¦‚æœæ˜¯304çš„è¯ä½¿ç”¨ç¼“å­˜ï¼Œè¿˜ä¼šå¯¹ç¼“å­˜è¿›è¡Œæ¯”å¯¹å’Œæ›´æ–°ã€‚ç„¶åå¹¶è¿”å›responseã€‚åœ¨è¿™ä¹‹å‰ä¼šå…ˆåˆ¤æ–­cacheResponseæ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºåˆ™èµ°åé¢çš„ä»£ç ï¼Œä¼šåˆ›å»ºä¸€ä¸ªresponseã€‚ ConnectInterceptor ç½‘ç»œè¿æ¥æ‹¦æˆªå™¨ @Override public Response intercept(Chain chain) throws IOException { RealInterceptorChain realChain = (RealInterceptorChain) chain; Request request = realChain.request(); StreamAllocation streamAllocation = realChain.streamAllocation(); // We need the network to satisfy this request. Possibly for validating a conditional GET. boolean doExtensiveHealthChecks = !request.method().equals(&quot;GET&quot;); HttpCodec httpCodec = streamAllocation.newStream(client, chain, doExtensiveHealthChecks); RealConnection connection = streamAllocation.connection(); return realChain.proceed(request, streamAllocation, httpCodec, connection); } è¿™é‡Œçš„StreamAllocationå…¶å®æ˜¯åœ¨é‡å®šå‘æ‹¦æˆªå™¨ä¸­åˆ›å»ºï¼Œä½†æ˜¯ä»–ä¼ å…¥åˆ°ConnectInterceptorä¸­è¿›è¡Œä½¿ç”¨ã€‚ç„¶åä¼šé€šè¿‡streamAllocationæ¥åˆ›å»ºhttpCodecï¼ŒhttpCodecç”¨æ¥ç¼–ç requestå’Œè§£ç responseã€‚ç„¶åä¼šé€šè¿‡streamAllocation.connection();æ¥åˆ›å»ºä¸€ä¸ªRealConnectionï¼ŒRealConnectionä¸»è¦æ¥è¿›è¡Œå®é™…çš„ç½‘ç»œä¼ è¾“ã€‚ç„¶åè¿˜æ˜¯é€šè¿‡proceedæ–¹æ³•ä¼ å…¥åˆ°ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ã€‚ CallServerInterceptor è¿™ä¸ªæ‹¦æˆªå™¨æ˜¯æ‹¦æˆªå™¨é“¾ä¸­æœ€åä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œæ˜¯çœŸæ­£çš„å‘èµ·è¯·æ±‚å’Œå¤„ç†è¿”å›å“åº”çš„æ‹¦æˆªå™¨ã€‚ @Override public Response intercept(Chain chain) throws IOException { RealInterceptorChain realChain = (RealInterceptorChain) chain; HttpCodec httpCodec = realChain.httpStream(); StreamAllocation streamAllocation = realChain.streamAllocation(); RealConnection connection = (RealConnection) realChain.connection(); Request request = realChain.request(); long sentRequestMillis = System.currentTimeMillis(); realChain.eventListener().requestHeadersStart(realChain.call()); httpCodec.writeRequestHeaders(request); realChain.eventListener().requestHeadersEnd(realChain.call(), request); Response.Builder responseBuilder = null; if (HttpMethod.permitsRequestBody(request.method()) &amp;&amp; request.body() != null) { // If there's a &quot;Expect: 100-continue&quot; header on the request, wait for a &quot;HTTP/1.1 100 // Continue&quot; response before transmitting the request body. If we don't get that, return // what we did get (such as a 4xx response) without ever transmitting the request body. if (&quot;100-continue&quot;.equalsIgnoreCase(request.header(&quot;Expect&quot;))) { httpCodec.flushRequest(); realChain.eventListener().responseHeadersStart(realChain.call()); responseBuilder = httpCodec.readResponseHeaders(true); } if (responseBuilder == null) { // Write the request body if the &quot;Expect: 100-continue&quot; expectation was met. realChain.eventListener().requestBodyStart(realChain.call()); long contentLength = request.body().contentLength(); CountingSink requestBodyOut = new CountingSink(httpCodec.createRequestBody(request, contentLength)); BufferedSink bufferedRequestBody = Okio.buffer(requestBodyOut); request.body().writeTo(bufferedRequestBody); bufferedRequestBody.close(); realChain.eventListener() .requestBodyEnd(realChain.call(), requestBodyOut.successfulCount); } else if (!connection.isMultiplexed()) { // If the &quot;Expect: 100-continue&quot; expectation wasn't met, prevent the HTTP/1 connection // from being reused. Otherwise we're still obligated to transmit the request body to // leave the connection in a consistent state. streamAllocation.noNewStreams(); } } httpCodec.finishRequest(); if (responseBuilder == null) { realChain.eventListener().responseHeadersStart(realChain.call()); responseBuilder = httpCodec.readResponseHeaders(false); } Response response = responseBuilder .request(request) .handshake(streamAllocation.connection().handshake()) .sentRequestAtMillis(sentRequestMillis) .receivedResponseAtMillis(System.currentTimeMillis()) .build(); realChain.eventListener() .responseHeadersEnd(realChain.call(), response); int code = response.code(); if (forWebSocket &amp;&amp; code == 101) { // Connection is upgrading, but we need to ensure interceptors see a non-null response body. response = response.newBuilder() .body(Util.EMPTY_RESPONSE) .build(); } else { response = response.newBuilder() .body(httpCodec.openResponseBody(response)) .build(); } if (&quot;close&quot;.equalsIgnoreCase(response.request().header(&quot;Connection&quot;)) || &quot;close&quot;.equalsIgnoreCase(response.header(&quot;Connection&quot;))) { streamAllocation.noNewStreams(); } if ((code == 204 || code == 205) &amp;&amp; response.body().contentLength() &gt; 0) { throw new ProtocolException( &quot;HTTP &quot; + code + &quot; had non-zero Content-Length: &quot; + response.body().contentLength()); } return response; } æµç¨‹ è¿™é‡Œé¦–å…ˆä¼šè·å–åˆ°ä¹‹å‰å„ä¸ªæ‹¦æˆªå™¨ä¸­çš„ä¸€äº›å‚æ•°ï¼Œé¦–å…ˆä¼š httpCodec.writeRequestHeaders(request);é€šè¿‡è¿™ä¸ªhttpCodecå†™å…¥è¯·æ±‚å¤´ä¿¡æ¯ï¼Œç„¶åä¼šå†™å…¥è¯·æ±‚çš„bodyä¿¡æ¯ï¼Œå®Œæˆå†™å…¥åä¼šè°ƒç”¨ httpCodec.finishRequest(); æ–¹æ³•è¡¨ç¤ºå†™å…¥ä¿¡æ¯å®Œæˆã€‚ ç„¶åä¼šè¯»å–å“åº”ä¿¡æ¯ï¼Œä¼šå…ˆè¯»å–å“åº”å¤´ä¿¡æ¯ï¼Œå“åº”å¦‚æœè¯»å–æˆ–è€…åˆ›å»ºå®Œæˆåä¼š é€šè¿‡streamAllocation.noNewStreams();è¿™ä¸ªæ–¹æ³•è¿›è¡Œå…³é—­æµï¼Œè¿˜ä¼šåˆ¤æ–­å¦‚æœå“åº”ç æ˜¯204æˆ–è€…205çš„è¯æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚ å…¶å®è¿™ä¸ªæ‹¦æˆªå™¨é“¾æ— éå°±æ˜¯2ä¸ªå·¥ä½œï¼Œå‘èµ·è¯·æ±‚ï¼Œç„¶åå¤„ç†å“åº”ã€‚è‡³äºä¸­é—´ä¼šæœ‰ä¸€äº›å°è£…è¯·æ±‚ä¿¡æ¯åˆ¤æ–­å“åº”ä¿¡æ¯ç­‰æ“ä½œã€‚ æ€»ç»“ è¿™é‡Œæ‹¦æˆªå™¨çš„æµç¨‹åŸºæœ¬åˆ†æå®Œäº†ï¼Œå…¶å®ä¸»è¦è¿˜æ˜¯çœ‹æ¸…å¤§ä½“æµç¨‹å’Œè®¾è®¡æ€è·¯ï¼Œå…·ä½“ç»†èŠ‚çš„éƒ¨åˆ†æ²¡æœ‰è¿‡å¤šæ·±å…¥ï¼Œå› ä¸ºè¿™äº›æµç¨‹è®¾è®¡æ¨¡å¼æ‰æ˜¯çœŸæ­£è¦å­¦ä¹ çš„é‡ç‚¹ã€‚ä»æºç çœ‹æ¥ å¥½å¤šåœ°æ–¹è¿˜æ˜¯å¾ˆå€¼å¾—å­¦ä¹ çš„ã€‚ ","link":"http://xuanguofeng.com/post/OkHttp_No.5/"},{"title":"Androidçƒ­é—¨å¼€æºæ¡†æ¶-OkHttpæºç æ¢ç©¶å››","content":"æœ¬ç¯‡ç»§ç»­æ¢ç©¶OkHttpï¼Œè¿™æ¬¡ä¸»è¦çœ‹OkHttpä¸­çš„ä¸€ä¸ªæ ¸å¿ƒæœºåˆ¶Dispatcher Dispatcheræ˜¯ä»€ä¹ˆï¼Ÿ /** * Policy on when async requests are executed. * * &lt;p&gt;Each dispatcher uses an {@link ExecutorService} to run calls internally. If you supply your * own executor, it should be able to run {@linkplain #getMaxRequests the configured maximum} number * of calls concurrently. */ è¿™æ˜¯Dispatcherçš„æ³¨é‡Šæ–‡æ¡£ï¼Œå¼‚æ­¥è¯·æ±‚çš„æ‰§è¡Œç­–ç•¥ï¼Œå…¶å®Dispatcherä¸»è¦ç”¨åœ¨å¼‚æ­¥è¯·æ±‚ä¸­ï¼Œä½†æ˜¯åŒæ­¥è¯·æ±‚ä¹Ÿä¼šæ¶‰åŠã€‚å‘é€åŒæ­¥å’Œå¼‚æ­¥è¯·æ±‚éƒ½ä¼šåœ¨Dispatcherä¸­ç®¡ç†å…¶çŠ¶æ€ï¼ŒDispatcherç»´æŠ¤è¯·æ±‚çŠ¶æ€ï¼Œå¹¶ä¸”ç»´æŠ¤ä¸€ä¸ªçº¿ç¨‹æ± ã€‚ private int maxRequests = 64; private int maxRequestsPerHost = 5; private @Nullable Runnable idleCallback; /** Executes calls. Created lazily. */ private @Nullable ExecutorService executorService; /** Ready async calls in the order they'll be run. */ private final Deque&lt;AsyncCall&gt; readyAsyncCalls = new ArrayDeque&lt;&gt;(); /** Running asynchronous calls. Includes canceled calls that haven't finished yet. */ private final Deque&lt;AsyncCall&gt; runningAsyncCalls = new ArrayDeque&lt;&gt;(); /** Running synchronous calls. Includes canceled calls that haven't finished yet. */ private final Deque&lt;RealCall&gt; runningSyncCalls = new ArrayDeque&lt;&gt;(); é¦–å…ˆçœ‹ä¸‹è¿™å‡ ä¸ªæˆå‘˜å˜é‡ æˆå‘˜å˜é‡ å«ä¹‰ maxRequests å¼‚æ­¥è¯·æ±‚ä¸­æœ€å¤§çš„è¯·æ±‚æ•°é‡ maxRequestsPerHost è¯·æ±‚ä¸­æ”¯æŒæœ€å¤§çš„hostæ•°é‡ executorService çº¿ç¨‹æ±  readyAsyncCalls å¼‚æ­¥ä¸­å‡†å¤‡è¯·æ±‚é˜Ÿåˆ— runningAsyncCalls å¼‚æ­¥ä¸­æ­£åœ¨è¿è¡Œçš„è¯·æ±‚é˜Ÿåˆ— runningSyncCalls è¿è¡Œçš„åŒæ­¥è¯·æ±‚é˜Ÿåˆ— ä¹‹å‰ç”¨åˆ°çš„å‡ ä¸ªé‡è¦æ–¹æ³• enqueue()æ–¹æ³• è¿™ä¸ªæ–¹æ³•ä¹‹å‰è¯´è¿‡ä¸»è¦æ˜¯è¿›è¡Œå¼‚æ­¥è¯·æ±‚ã€‚è¿™é‡Œæœ‰ä¸€ä¸ª executorService().execute(call); è¿™ä¸ªæ–¹æ³• public synchronized ExecutorService executorService() { if (executorService == null) { executorService = new ThreadPoolExecutor(0, Integer.MAX_VALUE, 60, TimeUnit.SECONDS, new SynchronousQueue&lt;Runnable&gt;(), Util.threadFactory(&quot;OkHttp Dispatcher&quot;, false)); } return executorService; } è¿™ä¸ªæ–¹æ³•ä¸»è¦æ˜¯åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± ã€‚ finishedæ–¹æ³• private &lt;T&gt; void finished(Deque&lt;T&gt; calls, T call, boolean promoteCalls) { int runningCallsCount; Runnable idleCallback; synchronized (this) { if (!calls.remove(call)) throw new AssertionError(&quot;Call wasn't in-flight!&quot;); if (promoteCalls) promoteCalls(); runningCallsCount = runningCallsCount(); idleCallback = this.idleCallback; } if (runningCallsCount == 0 &amp;&amp; idleCallback != null) { idleCallback.run(); } } ç”±äºæœ‰ä¸¤ä¸ªé˜Ÿåˆ—ï¼Œå‡†å¤‡çš„å¯¹åˆ—è¦æƒ³åŠ å…¥è¿è¡Œé˜Ÿåˆ— å¯å®šè¦åœ¨è¿è¡Œé˜Ÿåˆ—åˆ é™¤å¯¹åº”çš„è¯·æ±‚ï¼Œ!calls.remove(call)è¿™ä¸ªæ–¹æ³•å°±æ˜¯å°†æ‰§è¡Œå®Œçš„å¼‚æ­¥è¯·æ±‚ï¼Œä»æ­£åœ¨æ‰§è¡Œçš„é˜Ÿåˆ—ä¸­åˆ é™¤ã€‚ promoteCalls()æ–¹æ³•ä¸»è¦å°±æ˜¯å°†readyè¯·æ±‚é˜Ÿåˆ—ç§»åˆ°runningè¯·æ±‚é˜Ÿåˆ—çš„æ–¹æ³• runningCallsCount()è¿›è¡Œé‡æ–°è®¡ç®—è¯·æ±‚é˜Ÿåˆ—å’Œreadyé˜Ÿåˆ—çš„æ•°é‡ å…¶ä»–æ–¹æ³• è¿˜æœ‰äº›å…¶ä»–æ–¹æ³•ï¼Œå…¶å®ä¹Ÿæ¯”è¾ƒç®€å•å°±ä¸è´´æºç äº†ï¼Œå¦‚å–æ¶ˆæ‰€æœ‰è¯·æ±‚çš„æ–¹æ³•ï¼Œè·å–æœ€å¤§è¯·æ±‚æ•°é‡ã€è®¾ç½®æœ€å¤§è¯·æ±‚æ•°é‡ç­‰é…ç½®æ–¹æ³•ã€‚ æ€»ç»“ï¼š å…¶å®Dispatcherçš„ä»£ç å¹¶ä¸å¤æ‚ï¼Œä½†æ˜¯å´åœ¨è¿™ä¸ªç±»é‡Œå°è£…äº†å…³äºæ‰€æœ‰çš„è¯·æ±‚çš„ç®¡ç†ï¼Œè¿™è¦æ˜¯Dispatcherçš„æ ¸å¿ƒæ‰€åœ¨ã€‚ ","link":"http://xuanguofeng.com/post/OkHttp_No.4/"},{"title":"Androidçƒ­é—¨å¼€æºæ¡†æ¶-OkHttpæºç æ¢ç©¶ä¸‰","content":"æœ¬ç¯‡ç»§ç»­æ¢ç©¶OkHttpï¼Œè¿™æ¬¡ä¸»è¦çœ‹å¼‚æ­¥è¯·æ±‚æµç¨‹ å¼‚æ­¥è¯·æ±‚æµç¨‹ 1.åˆ›å»ºOkHttpClientå’ŒRequestå¯¹è±¡ 2.å°†Requestå°è£…æˆCallå¯¹è±¡ 3.è°ƒç”¨Callçš„enqueue()å‘é€åŒæ­¥è¯·æ±‚ 4.åœ¨callbackä¸­å¤„ç†æˆåŠŸå’Œå¤±è´¥çš„è¯·æ¬¾ æºç æ‰§è¡Œæµç¨‹ æµç¨‹åˆ†æ åŒæ­¥ä¸»è¦é€šè¿‡call.enqueueæ–¹æ³•å»æ‰§è¡Œï¼Œè¿™ä¸ªæ–¹æ³•ä¸»è¦åœ¨RealCallä¸­ @Override public void enqueue(Callback responseCallback) { synchronized (this) { if (executed) throw new IllegalStateException(&quot;Already Executed&quot;); executed = true; } captureCallStackTrace(); eventListener.callStart(this); client.dispatcher().enqueue(new AsyncCall(responseCallback)); } 1ã€å…¶å®è¿™æ®µä»£ç çš„æµç¨‹åŸºæœ¬å’ŒåŒæ­¥çš„ä¸€æ · åªä¸è¿‡æ˜¯æœ€åè¦æ‰§è¡Œenqueueæ–¹æ³•ï¼Œè€ŒåŒæ­¥çš„æ˜¯é€šè¿‡ getResponseWithInterceptorChain();ç›´æ¥è·å–resultäº†ã€‚å½“ç„¶å¼‚æ­¥ä¹Ÿæ˜¯æ‰§è¡ŒgetResponseWithInterceptorChain();è·å–resultã€‚åªä¸è¿‡åœ¨è·å–resultä¹‹å‰åšäº†ä¸€äº›å¼‚æ­¥æ“ä½œã€‚ 2ã€è·å–é€šè¿‡enqueue()æ–¹æ³•å¹¶ä¼ å…¥äº†ä¸€ä¸ªnew AsyncCall(responseCallback)è¿›è¡Œå¼‚æ­¥æ“ä½œï¼Œå…¶å®è¿™ä¸ªAsyncCallæ˜¯ä¸€ä¸ªRunnableã€‚è¿™æ—¶å¤§æ¦‚å°±æ˜ç™½äº†ã€‚ 3ã€å…ˆçœ‹ä¸‹Dispatcheré‡Œçš„è¿™ä¸ªenqueueæ–¹æ³•ã€‚è¿™ä¸ªDispatcheræ˜¯ä¸€ä¸ªè°ƒåº¦å™¨æ ¸å¿ƒç±»ï¼Œä¸‹ä¸€èŠ‚å•ç‹¬æ•´ç†ã€‚ synchronized void enqueue(AsyncCall call) { if (runningAsyncCalls.size() &lt; maxRequests &amp;&amp; runningCallsForHost(call) &lt; maxRequestsPerHost) { runningAsyncCalls.add(call); executorService().execute(call); } else { readyAsyncCalls.add(call); } } è¿™é‡Œå…¶å®ä¹Ÿå¾ˆç®€ï¼Œç”±äºæ˜¯å¼‚æ­¥ï¼Œæœ‰ä¸€ä¸ªå¼‚æ­¥è¿è¡Œé˜Ÿåˆ—ï¼Œå’Œä¸€ä¸ªå‡†å¤‡é˜Ÿåˆ—ã€‚è¿™é‡Œä¼šè¿›è¡Œæ¡ä»¶åˆ¤æ–­ï¼Œå°±æ˜¯é¦–å…ˆåˆ¤æ–­ç›®å‰è¯·æ±‚é˜Ÿåˆ—é‡Œçš„è¯·æ±‚æ•°é‡æ˜¯ä¸æ˜¯å°äºæœ€å¤§çš„æ•°é‡ï¼Œæœ€å¤§å€¼ä¸º64ã€‚å¹¶ä¸”callå¯¹åº”çš„hostæ•°ç›®ä¸åº”è¶…è¿‡maxRequestsPerHostï¼ŒmaxRequestsPerHostçš„å€¼æ˜¯5ã€‚ å¦‚æœæ»¡è¶³æ¡ä»¶å°±æ·»åŠ åˆ°è¿è¡Œçš„é˜Ÿåˆ—ä¸­ï¼Œå¦‚æœä¸æ»¡è¶³å°±æ·»åŠ åˆ°å‡†å¤‡é˜Ÿåˆ—ä¸­ã€‚ç„¶åé€šè¿‡çº¿ç¨‹æ± å®ä¾‹executorServiceè¿›è¡Œæ‰§è¡Œã€‚ AsyncCallåˆ†æ ä¸Šæ–‡æåˆ°AsyncCallå…¶å®æ˜¯NamedRunnableçš„å­ç±» è€Œ NamedRunnableåˆå®ç°Runnableæ¥å£ã€‚ /** * Runnable implementation which always sets its thread name. */ public abstract class NamedRunnable implements Runnable { protected final String name; public NamedRunnable(String format, Object... args) { this.name = Util.format(format, args); } @Override public final void run() { String oldName = Thread.currentThread().getName(); Thread.currentThread().setName(name); try { execute(); } finally { Thread.currentThread().setName(oldName); } } protected abstract void execute(); } è¿™é‡Œçœ‹åˆ°å…¶å®åœ¨runæ–¹æ³•é‡Œæ‰§è¡Œäº†executeè¿™ä¸ªæ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡ç‚¹åˆ†æNamedRunnableå®ç°ç±»çš„çš„executeæ–¹æ³•ã€‚ final class AsyncCall extends NamedRunnable { private final Callback responseCallback; AsyncCall(Callback responseCallback) { super(&quot;OkHttp %s&quot;, redactedUrl()); this.responseCallback = responseCallback; } String host() { return originalRequest.url().host(); } Request request() { return originalRequest; } RealCall get() { return RealCall.this; } @Override protected void execute() { boolean signalledCallback = false; try { Response response = getResponseWithInterceptorChain(); if (retryAndFollowUpInterceptor.isCanceled()) { signalledCallback = true; responseCallback.onFailure(RealCall.this, new IOException(&quot;Canceled&quot;)); } else { signalledCallback = true; responseCallback.onResponse(RealCall.this, response); } } catch (IOException e) { if (signalledCallback) { // Do not signal the callback twice! Platform.get().log(INFO, &quot;Callback failure for &quot; + toLoggableString(), e); } else { eventListener.callFailed(RealCall.this, e); responseCallback.onFailure(RealCall.this, e); } } finally { client.dispatcher().finished(this); } } } å…¶å®executeçš„æµç¨‹å’ŒåŒæ­¥çš„ä¹ŸåŸºæœ¬å·®ä¸å¤šäº† æœ€ä¸»è¦è¿˜æ˜¯é€šè¿‡getResponseWithInterceptorChainï¼ˆï¼‰æ–¹æ³•è¿”å›Responseï¼ŒgetResponseWithInterceptorChainè¿™ä¸ªæ–¹æ³•åé¢ä¼šå•ç‹¬è¯¦ç»†è¯´æ˜ã€‚ ç„¶åä¸»è¦æµç¨‹å°±æ˜¯å…ˆé€šè¿‡å›½æ‹¦æˆªå™¨åˆ¤æ–­æ˜¯å¦å–æ¶ˆè¯·æ±‚ï¼Œå¦‚æœå–æ¶ˆçš„è¯æ‰§è¡ŒonFailureè¿”å›ï¼Œå¦åˆ™è¿”å›onResponseå¹¶ä¼ å…¥responseã€‚ ç„¶åå°±æ˜¯å¼‚å¸¸å¤„ç†ä¹Ÿè¿”å›onFailureã€‚ æœ€åè¦æ‰§è¡Œfinishedã€‚ æ€»ç»“ï¼š å…¶å®åŒæ­¥å’Œå¼‚æ­¥çš„ä¸»è¦åŒºåˆ«åœ¨äºçº¿ç¨‹æ± çš„ä½¿ç”¨ï¼Œç„¶åå…¶ä»–æµç¨‹ä¹Ÿæ˜¯é€šè¿‡OkHttpä¸­çš„æ‹¦æˆªå™¨é“¾è¿›è¡Œè¿”å›å“åº”ã€‚åœ¨è¿™é‡Œå¯ä»¥ä½“ä¼šä¸‹è¿™ç§è®¾è®¡çš„å·§å¦™ä¹‹å¤„ã€‚ ","link":"http://xuanguofeng.com/post/OkHttp_No.3/"},{"title":"Androidçƒ­é—¨å¼€æºæ¡†æ¶-OkHttpæºç æ¢ç©¶äºŒ","content":"æœ¬ç¯‡ç»§ç»­æ¢ç©¶OkHttpï¼Œè¿™æ¬¡ä¸»è¦çœ‹åŒæ­¥è¯·æ±‚æµç¨‹ åŒæ­¥è¯·æ±‚æµç¨‹ ä½¿ç”¨æµç¨‹ 1.åˆ›å»ºOkHttpClientå’ŒRequestå¯¹è±¡ 2.å°†Requestå°è£…æˆCallå¯¹è±¡ 3.è°ƒç”¨Callçš„execute()å‘é€åŒæ­¥è¯·æ±‚ æºç æ‰§è¡Œæµç¨‹ åŒæ­¥ä¸»è¦é€šè¿‡call.executeæ–¹æ³•å»æ‰§è¡Œï¼Œè¿™ä¸ªæ–¹æ³•ä¸»è¦åœ¨RealCallä¸­ @Override public Response execute() throws IOException { synchronized (this) { if (executed) throw new IllegalStateException(&quot;Already Executed&quot;); executed = true; } //è§ è§£é‡Šå¤„1 captureCallStackTrace(); eventListener.callStart(this);//è§è§£é‡Šå¤„2 try { client.dispatcher().executed(this);//è§è§£é‡Šå¤„3 Response result = getResponseWithInterceptorChain(); if (result == null) throw new IOException(&quot;Canceled&quot;); return result; } catch (IOException e) { eventListener.callFailed(this, e); throw e; } finally { client.dispatcher().finished(this); } } è¿™æ®µä»£ç çš„æ­¥éª¤ 1.é¦–å…ˆé€šè¿‡executedåˆ¤æ–­è¿™ä¸ªæ–¹æ³•æ˜¯å¦è¢«æ‰§è¡Œï¼Œæ‰§è¡Œè¿‡çš„è¯å°±æŠ›å‡ºå¼‚å¸¸ï¼Œæ²¡æœ‰æ‰§è¡Œçš„è¯å°±è®¾ç½®executedä¸ºtrue,é˜²æ­¢ä¸‹æ¬¡æ‰§è¡Œï¼Œè¿™ä¹ˆçœ‹æ¥æ¯ä¸ªcallåªèƒ½è¢«æ‰§è¡Œä¸€æ¬¡ï¼Œå¦‚æœæƒ³è¦ä¸€ä¸ªå®Œå…¨ä¸€æ ·çš„call,å¯ä»¥è¿›è¡Œcloneæ–¹æ³•å…‹éš†ã€‚ 2.é€šè¿‡eventListener.callStart(this);æ–¹æ³•å¼€å¯äº†ä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨ï¼Œè¿™ä¸ªç›‘å¬å™¨çš„ä»‹ç»ä¹Ÿæœ‰ï¼Œä¸»è¦ç›‘æ§HTTPçš„è°ƒç”¨çš„æ•°é‡ã€å¤§å°å’ŒæŒç»­æ—¶é—´ç­‰ï¼Œè¿™ä¸ªç›‘å¬å™¨ï¼Œåœ¨å¼‚æ­¥è¯·æ±‚æ–¹æ³•ä¸­ä¹Ÿä¼šå¼€å¯ã€‚ 3.client.dispatcher().executed(this);è¿™å¥è¯å…¶å®æ˜¯å°†è¯·æ±‚æ·»åŠ åˆ°åŒæ­¥è¯·æ±‚é˜Ÿåˆ—ä¸­] /** Used by {@code Call#execute} to signal it is in-flight. */ synchronized void executed(RealCall call) { runningSyncCalls.add(call); } è¿™ä¸ª runningSyncCallså…¶å®å°±æ˜¯ä¸€ä¸ªåŒæ­¥è¯·æ±‚é˜Ÿåˆ—é›†åˆã€‚dispatcheræ˜¯OkHttpClient.Builderçš„æˆå‘˜ï¼Œåé¢ä¼šå•ç‹¬åˆ†æã€‚ 4.è°ƒç”¨ getResponseWithInterceptorChainè¿™ä¸ªæ–¹æ³•æ¥è·å–responseã€‚è¿™ä¸ªæ–¹æ³•å¯ä»¥å…ˆæµè§ˆä¸‹ åé¢ä¼šè¿›è¡Œåˆ†æã€‚ Response getResponseWithInterceptorChain() throws IOException { // Build a full stack of interceptors. List&lt;Interceptor&gt; interceptors = new ArrayList&lt;&gt;(); interceptors.addAll(client.interceptors()); interceptors.add(retryAndFollowUpInterceptor); interceptors.add(new BridgeInterceptor(client.cookieJar())); interceptors.add(new CacheInterceptor(client.internalCache())); interceptors.add(new ConnectInterceptor(client)); if (!forWebSocket) { interceptors.addAll(client.networkInterceptors()); } interceptors.add(new CallServerInterceptor(forWebSocket)); Interceptor.Chain chain = new RealInterceptorChain(interceptors, null, null, null, 0, originalRequest, this, eventListener, client.connectTimeoutMillis(), client.readTimeoutMillis(), client.writeTimeoutMillis()); return chain.proceed(originalRequest); } å…¶å®ä¸»è¦å°±æ˜¯é€šè¿‡ä¸€å±‚ä¸€å±‚çš„æ‹¦æˆªå™¨æ“ä½œï¼Œæ¯”å¦‚é‡è¯•æ‹¦æˆªå™¨ï¼Œç¼“å­˜æ‹¦æˆªå™¨ç­‰ï¼Œè¿™ä¹Ÿæ˜¯OkHttpçš„æ ¸å¿ƒæ€æƒ³ä¹‹ä¸€ï¼Œé€šè¿‡ä¸€ç³»åˆ—æ‹¦æˆªå™¨å¯ä»¥è¿›è¡Œå„ç§åŠŸèƒ½çš„æ‰©å±•å’Œå®ç°ã€‚åé¢ä¼šå•ç‹¬åˆ†æã€‚ 5.å¦‚æœresultä¸ä¸ºnullå°†ç»“æœè¿”å›ï¼Œå¦‚æœæœ‰å¼‚å¸¸çš„è¯ æ‰§è¡Œç›‘å¬çš„failedæ–¹æ³•ã€‚æœ€åæ— è®ºå¦‚ä½•éƒ½è¦é€šè¿‡dispatcherçš„finishedæ–¹æ³•é€šçŸ¥dispatcheræ‰§è¡Œå®Œæ¯•ã€‚ æ³¨æ„ï¼šåŒæ­¥å‘é€è¯·æ±‚åï¼Œå°±ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ç›´åˆ°æ”¶åˆ°è¯·æ±‚ï¼Œ æ€»ç»“ è¿™æ ·ï¼Œå…¶å®åŒæ­¥è¯·æ±‚æµç¨‹çš„è¡¨é¢æºç åŸºæœ¬å·²ç»åˆ†æå®Œæ¯•äº†ï¼Œä½†æ˜¯åœ¨è¿™æ®µä»£ç åè¿˜éšè—ç€ä¸€äº›å…¶ä»–çš„æœºåˆ¶ï¼Œæˆ‘ä»¬åé¢åˆ†æå¼‚æ­¥çš„æ—¶å€™ä¼šåˆ†æåˆ°ã€‚ ","link":"http://xuanguofeng.com/post/OkHttp_No.2/"},{"title":"Androidçƒ­é—¨å¼€æºæ¡†æ¶-Okhttpæºç æ¢ç©¶ä¸€","content":"OkHttpæ˜¯ç›®å‰å¾ˆæµè¡Œçš„ç½‘ç»œè¯·æ±‚æ¡†æ¶ã€‚æºç ä¹Ÿè®¾è®¡å¾ˆä¼˜ç§€çš„æ€æƒ³ã€‚æœ‰å¿…è¦å»æ¢ç©¶ä¸€ä¸‹æºç ã€‚ ç”±äºç¯‡å¹…è¾ƒé•¿ï¼Œåˆ†ä¸ºäº”ç¯‡æ–‡ç« ã€‚æœ¬ç¯‡æ–‡ç« å°†è®¨è®ºOkHttpçš„æ‰§è¡Œæµç¨‹åˆ†æ æ–‡ç« ç›®å½• ä¸€ã€OkHttpæ‰§è¡Œæµç¨‹åˆ†æ äºŒã€åŒæ­¥è¯·æ±‚æµç¨‹åˆ†æ ä¸‰ã€å¼‚æ­¥è¯·æ±‚æµç¨‹åˆ†æ å››ã€ä»»åŠ¡è°ƒåº¦æ ¸å¿ƒdispatcher äº”ã€OkHttpä¸­äº”å¤§æ‹¦æˆªå™¨æºç ä¸åŠŸèƒ½åˆ†æ OkHttpæ‰§è¡Œæµç¨‹åˆ†æ æµç¨‹å›¾ æµç¨‹åˆ†æ 1ã€åˆ›å»ºOkHttpClient OkHttpClientæ˜¯ä¸€ä¸ªé€šè¿‡buildæ¨¡å¼å»æ„å»ºçš„ã€‚ public Builder() { dispatcher = new Dispatcher(); protocols = DEFAULT_PROTOCOLS; connectionSpecs = DEFAULT_CONNECTION_SPECS; eventListenerFactory = EventListener.factory(EventListener.NONE); proxySelector = ProxySelector.getDefault(); cookieJar = CookieJar.NO_COOKIES; socketFactory = SocketFactory.getDefault(); hostnameVerifier = OkHostnameVerifier.INSTANCE; certificatePinner = CertificatePinner.DEFAULT; proxyAuthenticator = Authenticator.NONE; authenticator = Authenticator.NONE; connectionPool = new ConnectionPool(); dns = Dns.SYSTEM; followSslRedirects = true; followRedirects = true; retryOnConnectionFailure = true; connectTimeout = 10_000; readTimeout = 10_000; writeTimeout = 10_000; pingInterval = 0; } ç„¶åé€šè¿‡buildçš„buildæ–¹æ³•æ„å»º public OkHttpClient build() { return new OkHttpClient(this); } è¿™é‡Œä¸»è¦æ˜¯é€šè¿‡buildè®¾è®¡æ¨¡å¼é…ç½®ä¸€äº›å¸¸ç”¨çš„å‚æ•°ä¿¡æ¯ï¼Œå¦‚è¶…æ—¶æ—¶é—´ç­‰ã€‚ 2ã€åˆ›å»ºRequest public Builder() { this.method = &quot;GET&quot;; this.headers = new Headers.Builder(); } Builder(Request request) { this.url = request.url; this.method = request.method; this.body = request.body; this.tag = request.tag; this.headers = request.headers.newBuilder(); } Requestä¹Ÿæ˜¯é€šè¿‡buildæ¨¡å¼é…ç½®ä¸€äº›è¯·æ±‚ä¿¡æ¯ç­‰ï¼Œå¦‚url,è¯·æ±‚æ–¹æ³•ï¼Œè¯·æ±‚ä½“ï¼Œè¯·æ±‚å¤´ç­‰ã€‚ 3ã€åˆ›å»ºCall Call call = client.newCall(request); ä¸»è¦æ˜¯é€šè¿‡client.newCallç„¶åä¼ å…¥ä¸€ä¸ªrequestæ¥è¿›è¡Œåˆ›å»ºã€‚ @Override public Call newCall(Request request) { return RealCall.newRealCall(this, request, false); } è¿™é‡Œå…¶å®æ˜¯åˆ›å»ºäº†ä¸€ä¸ªRealCallï¼ŒRealCallä¹Ÿæ˜¯OkHttpæ¡†æ¶ä¸»è¦æµç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œä¸»è¦æ˜¯é“¾æ¥requestå’ŒResponseçš„æ¡¥æ¢ï¼Œé€šè¿‡callè¿›è¡ŒåŒæ­¥å’Œå¼‚æ­¥æ–¹æ³•çš„æ‰§è¡Œã€‚åœ¨åŒæ­¥å’Œå¼‚æ­¥çš„æ‰§è¡Œæ–¹æ³•é‡Œä¼šè¿”å›responseã€‚ä¾‹å¦‚ï¼š @Override public Response execute() throws IOException { synchronized (this) { if (executed) throw new IllegalStateException(&quot;Already Executed&quot;); executed = true; } captureCallStackTrace(); eventListener.callStart(this); try { client.dispatcher().executed(this); Response result = getResponseWithInterceptorChain(); if (result == null) throw new IOException(&quot;Canceled&quot;); return result; } catch (IOException e) { eventListener.callFailed(this, e); throw e; } finally { client.dispatcher().finished(this); } } 4ã€é€šè¿‡Callæ‰§è¡ŒåŒæ­¥æˆ–è€…å¼‚æ­¥è¯·æ±‚ï¼Œè·å–response Response response = call.execute(); System.out.println(response.body().string()); ä¸Šé¢å·²ç»è¯´è¿‡é€šè¿‡callçš„executeå¯ä»¥è¿›è¡ŒåŒæ­¥è¯·æ±‚ï¼Œç„¶åè·å–responseï¼Œè¿™ä¸ªresponseå°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„è¿”å›çš„ä¿¡æ¯ã€‚ ä¹Ÿå¯ä»¥é€šè¿‡call.enqueueæ–¹æ³•ä¼ å…¥ä¹Ÿä¸€ä¸ªç›‘å¬å™¨ï¼Œè¿›è¡Œå¼‚æ­¥è¯·æ±‚ã€‚ call.enqueue(new Callback() { @Override public void onFailure(Call call, IOException e) { //è¿”å›å¤±è´¥çš„æƒ…å†µ } @Override public void onResponse(Call call, Response response) throws IOException { //è°ƒç”¨æˆåŠŸçš„æƒ…å†µ } }); 5ã€å®Œæ•´çš„getè¯·æ±‚ï¼Œå’Œpostè¯·æ±‚ç¤ºä¾‹ get OkHttpClient client = new OkHttpClient(); String run(String url) throws IOException { Request request = new Request.Builder() .url(url) .build(); Response response = client.newCall(request).execute(); return response.body().string(); } post public static final MediaType JSON = MediaType.parse(&quot;application/json; charset=utf-8&quot;); OkHttpClient client = new OkHttpClient(); String post(String url, String json) throws IOException { RequestBody body = RequestBody.create(JSON, json); Request request = new Request.Builder() .url(url) .post(body) .build(); Response response = client.newCall(request).execute(); return response.body().string(); } 6ã€æ€»ç»“ è¿™ç¯‡åªæ˜¯ç®€å•åˆ†æOkHttpçš„ä½¿ç”¨æµç¨‹ï¼Œå…¶å®è¿˜æœ‰ä¸€éƒ¨åˆ†æ ¸å¿ƒçš„æµç¨‹æ˜¯åœ¨æºç ä¸­ä½“ç°çš„æ¯”å¦‚dispatcherè°ƒåº¦å™¨çš„ä½¿ç”¨æµç¨‹ï¼Œä¸æ‹¦æˆªå™¨çš„æ ¸å¿ƒåŠŸèƒ½ç­‰ï¼Œè¿™ä¸€éƒ¨åˆ†å°†åœ¨åé¢çš„æ€»ç»“ä¸­è¿›è¡Œå•ç‹¬åˆ†æã€‚ ","link":"http://xuanguofeng.com/post/OkHttp_No.1/"},{"title":"Androidä¼˜åŒ–-ç»˜åˆ¶ä¼˜åŒ–","content":"Androidç³»ç»Ÿæ˜¾ç¤ºåŸç† Androidåº”ç”¨ç¨‹åºæŠŠç»è¿‡æµ‹é‡ï¼Œç»˜åˆ¶ï¼Œå¸ƒå±€çš„surfaceç¼“å­˜æ•°æ®ï¼Œé€šè¿‡SufraceFilngeræŠŠæ•°æ®æ¸²æŸ“åˆ°æ˜¾ç¤ºå±å¹•ä¸Šé€šè¿‡Androidçš„åˆ·æ–°æœºåˆ¶æ¥åˆ·æ–°æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´åº”ç”¨å±‚è´Ÿè´£ç»˜åˆ¶ï¼Œç³»ç»Ÿå±‚è´Ÿè´£æ¸²æŸ“ï¼Œé€šè¿‡è¿›ç¨‹é—´é€šä¿¡æŠŠåº”ç”¨å±‚éœ€è¦ç»˜åˆ¶çš„æ•°æ®ä¼ é€’åˆ°ç³»ç»Ÿå±‚æœåŠ¡ï¼Œç³»ç»Ÿå±‚æœåŠ¡ä»–é€šè¿‡åˆ·æ–°æœºåˆ¶æŠŠæ•°æ®æ›´æ–°åˆ°å±å¹•ã€‚ åº”ç”¨å±‚ viewçš„ç»˜åˆ¶æœ‰ä¸‰ä¸ªæ ¸å¿ƒæ­¥éª¤ï¼Œé€šè¿‡Measureå’ŒLayoutæ¥ç¡®å®šå½“å‰éœ€è¦ç»˜åˆ¶çš„Viewæ‰€åœ¨çš„å¤§å°å’Œä½ç½®ï¼Œé€šè¿‡ç»˜åˆ¶ï¼ˆDrawï¼‰åˆ°surface,é€’å½’æ–¹å¼è·å–Viewçš„å¤§å°å’Œä½ç½®ï¼Œå¹¶ä»¥æ·±åº¦ä½œä¸ºä¼˜å…ˆçº§ï¼Œå±‚çº§è¶Šæ·±ï¼Œå…ƒç´ è¶Šå¤šï¼Œè€—æ—¶ä¹Ÿå°±è¶Šé•¿ã€‚ ç³»ç»Ÿå±‚ ç³»ç»Ÿå±‚ä¸»è¦æ˜¯å°†è¦æ˜¾ç¤ºçš„æ•°æ®æ¸²æŸ“åˆ°å±å¹•ä¸Šï¼ŒCPUä¸»è¦è´Ÿè´£æ•°æ®è®¡ç®—å·¥ä½œï¼ŒGPUè´Ÿè´£æ¸²æŸ“ã€‚APIä¸å…è®¸CPUå’ŒGPUç›´æ¥é€šä¿¡ï¼Œ æ‰€ä»¥é€šè¿‡ä¸­é—´çš„ä¸€ä¸ªå›¾å½¢é©±åŠ¨å™¨æ¥è¿æ¥è¿™ä¸¤éƒ¨åˆ†ã€‚å›¾å½¢é©±åŠ¨ç»´æŠ¤äº†ä¸€ä¸ªé˜Ÿåˆ—ï¼ŒcpuæŠŠ diplay listæ·»åŠ åˆ°é˜Ÿåˆ—ä¸­ï¼ŒGPUä»è¿™ä¸ªé˜Ÿåˆ—å–å‡ºæ•°æ®å¹¶è¿›è¡Œç»˜åˆ¶ï¼Œæœ€ç»ˆåœ¨å±å¹•æ˜¾ç¤ºå‡ºæ¥ã€‚ Androidé¡µé¢å¡é¡¿çš„åŸå›  ç•Œé¢ç»˜åˆ¶æ–¹é¢ ä¸»è¦åŸå› æ˜¯ç»˜åˆ¶çš„å±‚çº§æ·±ã€é¡µé¢å¤æ‚ã€åˆ·æ–°ä¸åˆç†ã€ç”±äºè¿™äº›åŸå› å¯¼è‡´å¡é¡¿çš„åœºæ™¯æ›´å¤šå‡ºç°åœ¨UIå’Œå¯åŠ¨åçš„åˆå§‹ç•Œé¢ä»¥åŠè·³è½¬åˆ°é¡µé¢çš„ç»˜åˆ¶ä¸Šã€‚ æ•°æ®å¤„ç†æ–¹é¢ åŸå› æ˜¯æ•°æ®çš„å¤„ç†é‡å¤ªå¤§ï¼Œä¸€èˆ¬åˆ†ä¸ºä¸‰ç§æƒ…å†µ æ•°æ®å¤„ç†åœ¨UIçº¿ç¨‹ æ•°æ®å¤„ç†å ç”¨CPUæå¯¼è‡´ä¸»çº¿ç¨‹æ‹¿ä¸åˆ°æ—¶é—´ç‰‡ å†…å­˜å¢åŠ å¯¼è‡´GCé¢‘ç¹ ä¼˜åŒ–æ–¹æ³• å¸ƒå±€ä¼˜åŒ– merge viewStub https://xuanguofeng.github.io/2016/06/10/Android%E5%B8%83%E5%B1%80%E4%BC%98%E5%8C%96merge%E3%80%81ViewStub%E7%9A%84%E7%94%A8%E6%B3%95/ ReativeLayoutå’ŒLinearLayout ReativeLayoutå­˜åœ¨æ€§èƒ½ä½çš„é—®é¢˜ï¼ŒåŸå› æ˜¯ReativeLayoutä¼šå¯¹å­viewåšä¸¤æ¬¡æµ‹é‡ï¼Œå¦‚æœLinearLayoutä¸­æœ‰weightå±æ€§ï¼Œä¹Ÿéœ€è¦è¿›è¡Œä¸¤æ¬¡æµ‹é‡ï¼Œå› ä¸ºæ²¡æœ‰æ›´å¤šçš„ä¾èµ–å…³ç³»ï¼Œæ‰€æœ‰ä»ç„¶ä¼šæ¯”ReativeLayoutæ•ˆç‡é«˜ï¼Œä½†æ˜¯å¦‚æœLinearyLayoutåµŒå¥—è¿‡å¤šï¼Œå±‚æ¬¡è¿‡æ·±ç°å¢åŠ å†…å­˜æ¶ˆè€—ï¼Œç”šè‡³å¼•èµ·æº¢å‡ºç­‰é—®é¢˜ã€‚åœ¨å¸ƒå±€ä¸ŠRelativeLayoutä¸å¦‚LinearLayoutå¿«ã€‚å¦‚æœåµŒå¥—è¿‡å¤šçš„è¯è¦é€‰ç”¨RelativeLayoutï¼Œå¦‚æœä¼˜åŒ–æ‰ä¸¤å±‚ä»…ä»…å¢åŠ ä¸€æ¬¡æµ‹é‡ï¼Œè¿˜æ˜¯éå¸¸å€¼å¾—çš„ã€‚ æ€»ç»“ï¼š å°½é‡ä½¿ç”¨â€‹â€‹RelativeLayoutå’ŒLinearLayout å¸ƒå±€å±‚çº§ç›¸åŒæƒ…å†µä¸‹ï¼Œä½¿ç”¨â€‹LinearLayout LinearLayoutå¦‚æœä¼šåµŒå¥—è¿‡å¤šä½¿ç”¨â€‹RelativeLayout é¿å…è¿‡åº¦ç»˜åˆ¶ è¿‡åº¦é‡ç»˜æ˜¯æŒ‡åœ¨å±å¹•ä¸Šçš„æŸä¸ªåƒç´ åœ¨åŒä¸€å¸§çš„æ—¶é—´å†…è¢«ç»˜åˆ¶äº†å¤šæ¬¡ã€‚ ä¾‹å¦‚ï¼š LIstViewä¸­æŠŠImageViewçš„Backgroundè®¾ç½®ä¸ºTransparent,åªæœ‰å½“å›¾åƒæ²¡æœ‰è·å–åˆ°æ—¶ï¼Œæ‰è®¾ç½®å¯¹åº”Backgroundå ä½å›¾ï¼Œè¿™æ ·å¯ä»¥é¿å…ç»™Avatarè®¾ç½®èƒŒæ™¯å›¾è€Œå¯¼è‡´çš„è¿‡åº¦æ¸²æŸ“ã€‚ é¿å…è¿‡åº¦ç»˜åˆ¶çš„ä¸€äº›æ–¹æ³•ï¼š 1.ç§»é™¤XMLä¸­éå¿…é¡»çš„èƒŒæ™¯ 2.ç§»é™¤windowé»˜è®¤çš„èƒŒæ™¯ 3.æŒ‰éœ€æ˜¾ç¤ºç«™ä½èƒŒæ™¯å›¾ç‰‡ã€‚ 4.è‡ªå®šä¹‰viewä¼˜åŒ–ï¼šå¯ä»¥é€šè¿‡canvas.clipRect()æ¥å¸®åŠ©ç³»ç»Ÿè¯†åˆ«é‚£äº›å¯è§çš„åŒºåŸŸã€‚â€‹â€‹S this.getWindow().setBackgroundDrawable(null);â€‹ é¡µé¢åˆ·æ–° è¦åˆç†çš„æ§åˆ¶é¡µé¢çš„åˆ·æ–°æœºåˆ¶ï¼Œå°½é‡å‡å°‘åˆ·æ–°æ¬¡æ•°å’Œç¼©å°åˆ·æ–°åŒºåŸŸã€‚ å…³äºåŠ¨ç”» Androidæä¾›äº†3ç§åŠ¨ç”»æœºåˆ¶ï¼Œå…¶ä¸­å¸§åŠ¨ç”»æ˜¯æœ€æ¶ˆè€—å†…å­˜çš„ï¼Œæ•ˆæœä¹Ÿæœ€å·®ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸æ¨èä½¿ç”¨ï¼Œè¡¥é—´åŠ¨ç”»ä¹Ÿä¼šå¯¼è‡´viewé‡ç»˜é¢‘ç¹ï¼Œè€Œä¸”äº‹ä»¶ä¹Ÿä¸ä¼šè·ŸéšåŠ¨ç”»ï¼Œæ‰€ä»¥æ¨èåŸºäºæ€§èƒ½è€ƒè™‘æ¨èä½¿ç”¨å±æ€§åŠ¨ç”»ï¼Œå±æ€§åŠ¨ç”»é€’å½’çš„æ¬¡æ•°è¦æ˜æ˜¾å°äºè¡¥é—´åŠ¨ç”»ï¼Œä¹Ÿæ²¡æœ‰è¡¥é—´åŠ¨ç”»äº‹ä»¶çš„é—®é¢˜ã€‚ ä½¿ç”¨ç¡¬ä»¶åŠ é€Ÿ Android3.0åå¼•å…¥äº†ç¡¬ä»¶åŠ é€Ÿæ¦‚å¿µï¼Œç”¨æ¥æé«˜æ¸²æŸ“é€Ÿåº¦ï¼Œå¹¶è¾¾åˆ°æ›´é¡ºç•…çš„æ•ˆæœ å¯åŠ¨ä¼˜åŒ– å¯åŠ¨ä¼˜åŒ–ä¸»è¦å°±æ˜¯åœ¨APPçš„å¯åŠ¨è¿‡ç¨‹ä¸­åšå°½é‡å°‘çš„äº‹æƒ…ï¼Œå¯åŠ¨ä¸»è¦å®Œæˆä¸‰ä»¶äº‹ï¼ŒUIå¸ƒå±€ã€ç»˜åˆ¶å’Œæ•°æ®å‡†å¤‡ï¼Œå¯åŠ¨é€Ÿåº¦å°±çš„ä¼˜åŒ–å°±æ˜¯è¦ä¼˜åŒ–è¿™ä¸ªä¸‰ä¸ªè¿‡ç¨‹ã€‚ æ€§èƒ½åˆ†æå·¥å…· Profile GPU Rendering è¿™ä¸ªå·¥å…·åœ¨å¼€å‘è€…é€‰é¡¹ä¸­å¯ä»¥æ‰“å¼€ï¼Œä¸»è¦åŠŸèƒ½ï¼š å›¾å½¢æ£€æµ‹å·¥å…·ï¼Œèƒ½å®æ—¶åæ˜ å½“å‰ç»˜åˆ¶çš„è€—æ—¶ã€‚ æ¨ªè½´è¡¨ç¤ºæ—¶é—´ï¼Œçºµè½´è¡¨ç¤ºæ¯ä¸€å¸§çš„è€—æ—¶ã€‚ éšä¹‹æ—¶é—´æ¨ç§»ï¼Œä»å·¦åˆ°å³çš„åˆ·æ–°å‘ˆç°ã€‚ æä¾›äº†ä¸€ä¸ªæ ‡å‡†çš„è€—æ—¶ã€‚ TraceView TraceViewæ˜¯Android SDKè‡ªå¸¦å·¥å…·ï¼Œç”¨æ¥åˆ†æå‡½æ•°è°ƒç”¨è¿‡ç¨‹ï¼Œå¯ä»¥å¯¹Androidçš„åº”ç”¨ç¨‹åºä»¥åŠFrameworkå±‚çš„ä»£ç è¿›è¡Œæ€§èƒ½åˆ†æã€‚ Hierarchy Viewer å¸ƒå±€ä¼˜åŒ–å·¥å…· Hierarchy Viewerå·¥å…·æä¾›äº†ä¸€ä¸ªå¯è§†åŒ–ç•Œé¢æ˜¾ç¤ºå¸ƒå±€çš„å±‚æ¬¡ç»“æ„ï¼Œç”¨æ¥æ£€æµ‹LayoutåµŒå¥—åŠç»˜åˆ¶æ—¶é—´ï¼Œä»¥å¯è§†åŒ–çš„å¸ƒå±€è§’åº¦ç›´è§‚è·å–Layoutå¸ƒå±€è®¾è®¡å’Œå„ç§å±æ€§ä¿¡æ¯ï¼Œå¼€å‘è€…åœ¨å°æ¬§å¼å’Œå¸ƒå±€UIç•Œé¢å¯ä»¥å¾ˆæ–¹ä¾¿çš„ä½¿ç”¨ã€‚ è¿‡åº¦ç»˜åˆ¶æ£€æµ‹å·¥å…· å¼€å‘è€…é€‰é¡¹ä¸­æ‰“å¼€ show GPU Overdrawé€‰é¡¹ æè¿°æ–¹å¼ï¼š æ— è‰²ï¼šæ²¡æœ‰è¿‡åº¦ç»˜åˆ¶ï¼Œæ¯ä¸ªåƒç´ ç»˜åˆ¶äº†1æ¬¡ã€‚ è“è‰²ï¼šæ¯ä¸ªåƒç´ å¤šç»˜åˆ¶äº†1æ¬¡ã€‚å¤§ç‰‡è“è‰²è¿˜æ˜¯å¯ä»¥æ¥å—çš„å¦‚æœæ•´ä¸ªçª—å£æ˜¯è“è‰²çš„ï¼Œå¯ä»¥å°è¯•ä¼˜åŒ–å‡å°‘ä¸€å±‚ç»˜åˆ¶ã€‚ ç»¿è‰²ï¼šæ¯ä¸ªåƒç´ å¤šç»˜åˆ¶äº†2æ¬¡ã€‚ æ·¡çº¢ï¼šæ¯ä¸ªåƒç´ å¤šç»˜åˆ¶äº†3æ¬¡ï¼Œä¸€èˆ¬æ¥è¯´è¿™ä¸ªåŒºåŸŸä¸è¶…è¿‡å±å¹•çš„1/4æ˜¯å¯ä»¥æ¥å—çš„ã€‚ æ·±çº¢ï¼šæ¯ä¸ªåƒç´ å¤šç»˜åˆ¶4æ¬¡æˆ–è€…æ›´å¤šã€‚ä¸¥é‡å½±å“æ€§èƒ½ï¼Œéœ€è¦ä¼˜åŒ–ï¼Œé¿å…æ·±çº¢è‰²åŒºåŸŸã€‚ ","link":"http://xuanguofeng.com/post/Androidä¼˜åŒ–-ç»˜åˆ¶ä¼˜åŒ–/"},{"title":"é‡æ¸©javaåŸºç¡€-åå°„æœºåˆ¶","content":"åå°„æ˜¯ä»€ä¹ˆï¼Ÿ åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œè·å–ä¸€ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ã€‚è¿™ç§åŠ¨æ€è·å–ä¿¡æ¯ä»¥åŠè°ƒç”¨å¯¹è±¡çš„æ–¹æ³•çš„åŠŸèƒ½ã€‚ ä½¿ç”¨åå°„æœºåˆ¶çš„ä¸€äº›æ¡†æ¶ï¼Ÿ Retrofitä¸­çš„æ³¨è§£åŠŸèƒ½ã€EventBusï¼ŒåŠ¨æ€ç”Ÿæˆæ¡†æ¶ Gsonã€‚ ä½¿ç”¨åå°„æŠ€æœ¯æŸ¥çœ‹ç±»ä¿¡æ¯ è·å–Classå¯¹è±¡çš„ä¸‰ç§æ–¹æ³• ä½¿ç”¨Object.getClassæ–¹æ³• å¦‚æœæˆ‘ä»¬èƒ½çŸ¥é“ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„getClassæ–¹æ³•è·å¾—ä¸€ä¸ªClasså¯¹è±¡ã€‚ ä¾‹å¦‚ï¼š Person person = new Person(); Class&lt;? extends Person&gt; aClass = person.getClass(); System.out.println(aClass.getName()); è¿™æ—¶å€™å°±ä¼šæ‰“å°è¿™ä¸ªå¯¹è±¡çš„å…¨åŒ…åï¼ŒaClassä¸­è¿˜æœ‰å…¶ä»–ä¿¡æ¯ã€‚ ä½¿ç”¨.classæ–¹æ³• Class&lt;? extends Person&gt; aClass = Person.class; System.out.println(aClass.getName()); System.out.println(int.class); å¦‚æœæ²¡æœ‰è·å–æŸä¸ªç±»çš„å¯¹è±¡ï¼Œæ— æ³•ä½¿ç”¨getClassæ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥åœ¨ç±»ååŠ ä¸Š.classæ¥è·å–ï¼Œè¿™ç§æ–¹å¼å¯ä»¥ç”¨äºåŸºæœ¬æ•°æ®ç±»å‹ã€‚ ä½¿ç”¨Class.forName()æ–¹æ³• è¿™ä¸ªæ–¹æ³•è¦ä½¿ç”¨ä¸€ä¸ªç±»çš„å®Œæ•´è·¯å¾„ï¼Œå°±å¯ä»¥ä½¿ç”¨Class.forName(&quot;ç±»çš„å®Œæ•´è·¯å¾„&quot;)æ¥å¾—åˆ°ç›¸åº”çš„Classã€‚ try { Class mclass1 = Class.forName(&quot;main.fanshe.Person&quot;); System.out.println(mclass1.getName()); } catch (ClassNotFoundException e) { e.printStackTrace(); } æ³¨æ„ï¼šä½¿ç”¨Classçš„newInstance()æ–¹æ³•æ¥åˆ›å»ºå¯¹åº”ç±»çš„å®ä¾‹ï¼Œéœ€è¦æœ‰é»˜è®¤çš„æ„é€ å™¨ï¼Œæ‰§è¡ŒnewInstance()æ–¹æ³•å®é™…ä¸Šå¸‚åˆ©ç”¨é»˜è®¤æ„é€ å™¨æ¥åˆ›å»ºè¯¥ç±»çš„å®ä¾‹ã€‚ Class mclass1 = Class.forName(&quot;main.fanshe.Person&quot;); Object o = mclass1.newInstance(); é€šè¿‡åå°„è·å–æˆå‘˜å˜é‡ å¸¸ç”¨è·å–æˆå‘˜å±æ€§çš„æ–¹æ³• Field[] declaredFields = mclass1.getDeclaredFields();//è·å–Classå¯¹è±¡çš„æ‰€æœ‰å±æ€§ Field[] fields = mclass1.getFields();//è·å–classå¯¹è±¡çš„publicå±æ€§ Field ageField = mclass1.getDeclaredField(&quot;age&quot;);//è·å–classæŒ‡å®šå±æ€§ Field desFiedl = mclass1.getField(&quot;name&quot;);//è·å–classæŒ‡å®šçš„publicå±æ€§ å¦‚æœè·å–åˆ°å±æ€§å¯ä»¥ç”¨è¿‡setæ–¹æ³•è¿›è¡Œä¿®æ”¹ä¾‹å¦‚ï¼š Field ageField = mclass1.getDeclaredField(&quot;age&quot;);//è·å–classæŒ‡å®šå±æ€§ ageField.setInt(o,22); å¦‚æœè¿™ä¸ªå±æ€§æ˜¯ç”¨privateä¿®é¥°çš„è¯,è¿™æ ·å†™çš„è¯ä»£ç ä¼šæŠ¥é”™ java.lang.IllegalAccessException: Class main.fanshe.Main can not access a member of class main.fanshe.Person with modifiers &quot;private&quot; at sun.reflect.Reflection.ensureMemberAccess(Reflection.java:102) at java.lang.reflect.AccessibleObject.slowCheckMemberAccess(AccessibleObject.java:296) at java.lang.reflect.AccessibleObject.checkAccess(AccessibleObject.java:288) at java.lang.reflect.Field.setInt(Field.java:946) at main.fanshe.Main.main(Main.java:50) è¿™æ—¶æˆ‘ä»¬è¦æ·»åŠ  ageField.setAccessible(true);è¿™ä¸ªæ–¹æ³•æ¥å£°æ˜è¿™ä¸ªå˜é‡æ˜¯å¯ä»¥è®¿é—®çš„å°±æ²¡é—®é¢˜äº†ï¼Œä½†æ˜¯ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ä¹Ÿå¯èƒ½ä¼šå¯¼è‡´äº›å…¶ä»–é—®é¢˜ï¼Œä¾‹å¦‚ åœ¨è¿è¡Œæ—¶è™½ç„¶ä½ é€šè¿‡åå°„ä¿®æ”¹äº†å˜é‡ a çš„å€¼ï¼Œä½†å…¶ä»–éƒ¨åˆ†å¯èƒ½è¿˜åœ¨ä½¿ç”¨åŸæ¥çš„å€¼ã€‚ é€šè¿‡åå°„è·å–æˆå‘˜æ–¹æ³• Method[] methods = mclass1.getDeclaredMethods();//è·å–classå¯¹è±¡çš„æ‰€æœ‰å£°æ˜æ–¹æ³• Method[] allMethods = mclass1.getMethods();//è·å–classå¯¹è±¡çš„æ‰€æœ‰publicå£°æ˜æ–¹æ³• Method method = mclass1.getMethod(&quot;getAge&quot;);//æ ¹æ®æ–¹æ³•åè¿”å›æ–¹æ³• Method method2 = mclass1.getMethod(&quot;getAge&quot;,String.class);//æ ¹æ®å¸¦æŒ‡å®šå½¢å‚åˆ—è¡¨çš„publicæ–¹æ³• System.out.println(method.toString()); å¯ä»¥é€šè¿‡method.invoke(o);è¿™ä¸ªæ–¹æ³•è°ƒç”¨åå°„åˆ°çš„æ–¹æ³•ã€‚ æ€»ç»“ åå°„è¿˜æœ‰å¥½å¤šå…¶ä»–æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡æŸ¥è¯¢APIè·çŸ¥ï¼Œä¾‹å¦‚è·å–æ„é€ æ–¹æ³•ç­‰ï¼ŒåŠŸèƒ½è²Œä¼¼è¿˜æ˜¯æ¯”è¾ƒå¼ºå¤§çš„ï¼Œä½†æ˜¯åå°„çš„ä¸€äº›æ“ä½œå¯èƒ½ä¼šå¼•èµ·æ€§èƒ½æ¶ˆè€—ï¼Œä¾‹å¦‚ä¿®æ”¹æŸä¸ªæˆå‘˜å˜é‡çš„æ—¶å€™ï¼Œéœ€è¦å¼•å‘éªŒè¯è®¿é—®æƒé™ç­‰é¢å¤–æ“ä½œç­‰ã€‚æ‰€ä»¥ä½¿ç”¨åå°„çš„æ—¶å€™ä¹Ÿè®¸è¦è€ƒè™‘ä¸‹æ€§èƒ½æ–¹é¢çš„é—®é¢˜ã€‚ æœ¬ç¯‡æ–‡ç« å‚è€ƒï¼šhttp://blog.csdn.net/u011240877/article/details/54604212 ","link":"http://xuanguofeng.com/post/é‡æ¸©javaåŸºç¡€-åå°„æœºåˆ¶/"},{"title":"Androidä¼˜åŒ–-å†…å­˜ä¼˜åŒ–","content":"Javaå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç»å†7ä¸ªé˜¶æ®µï¼Œåˆ†åˆ«æ˜¯åˆ›å»ºé˜¶æ®µã€åº”ç”¨é˜¶æ®µã€ä¸å¯è§é˜¶æ®µã€ä¸å¯è¾¾é˜¶æ®µã€æ”¶é›†é˜¶æ®µã€ç»ˆç»“é˜¶æ®µã€å¯¹è±¡æ§ä»¶é‡æ–°åˆ†é…é˜¶æ®µã€‚ ä¸€ã€Androidå†…å­˜ç®¡ç†æœºåˆ¶ 1ã€Javaå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ Javaå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç»å†7ä¸ªé˜¶æ®µï¼Œåˆ†åˆ«æ˜¯åˆ›å»ºé˜¶æ®µã€åº”ç”¨é˜¶æ®µã€ä¸å¯è§é˜¶æ®µã€ä¸å¯è¾¾é˜¶æ®µã€æ”¶é›†é˜¶æ®µã€ç»ˆç»“é˜¶æ®µã€å¯¹è±¡æ§ä»¶é‡æ–°åˆ†é…é˜¶æ®µã€‚ 2ã€å†…å­˜å›æ”¶æœºåˆ¶ å†…å­˜çš„ä¸‰ä¸ªåŒºåŸŸ å†…å­˜ä¼šæœ‰ä¸‰ä¸ªåŒºåŸŸï¼ŒYong Generation(å¹´è½»ä»£)ã€Old Generation(å¹´è€ä»£)ã€permanent Generationï¼ˆæŒä¹…ä»£ï¼‰ã€‚ å…¶ä¸­å¹´è½»ä»£é‡Œé¢åˆåˆ†ä¸ºä¸‰ä¸ªåŒºï¼Œedenã€S0ã€S1ã€‚ å†…å­˜çš„å¤„ç†è¿‡ç¨‹ï¼š 1.å¯¹è±¡åˆ›å»ºååœ¨EdenåŒºåŸŸï¼Œ 2.æ‰§è¡ŒGCæ—¶ï¼Œå¦‚æœå¯¹è±¡ä»ç„¶å­˜è´§ï¼Œåˆ™å¤åˆ¶åˆ°S0åŒºã€‚ 3.å½“S0åŒºæ»¡æ—¶ï¼Œæ”¹åŒºåŸŸå­˜æ´»å¯¹è±¡å°†å¤åˆ¶åˆ°S1åŒºï¼Œç„¶åS0æ¸…ç©ºï¼Œæ¥ä¸‹æ¥S0å’ŒS1è§’è‰²äº’æ¢ã€‚ 4.å½“ç¬¬ä¸‰éƒ¨è¾¾åˆ°ä¸€å®šæ¬¡æ•°åï¼Œå­˜æ´»å¯¹è±¡å°†è¢«å¤åˆ¶åˆ°Old Generationã€‚ 5.å½“è¿™ä¸ªå¯¹è±¡åœ¨Old GenerationåŒºåŸŸæŒºæºœçš„æ—¶é—´è¾¾åˆ°ä¸€å®šç¨‹åº¦æ—¶ï¼Œå®ƒä¼šè¢«ç§»åŠ¨åˆ°Old Generationï¼Œæœ€åç§¯ç´¯ä¸€å®šæ—¶é—´å†ç§»åŠ¨åˆ°Permaent GenerationåŒºåŸŸï¼ŒPermaent GenerationåŒºåŸŸä¹Ÿå­˜æ”¾ä¸€äº›é™æ€æ–‡ä»¶ã€‚ GCå›æ”¶çš„ä¸€äº›ç®—æ³• Copyingç®—æ³•ï¼šæ‰«æå‡ºå­˜æ´»çš„å¯¹è±¡ï¼Œå¹¶å¤åˆ¶åˆ°ä¸€å—æ–°çš„å®Œå…¨æœªä½¿ç”¨çš„æ§ä»¶ä¸­ï¼Œå¯¹åº”äºYoung Generationï¼Œå°±æ˜¯åœ¨Edenã€FromSpaceæˆ–ToSpaceä¹‹é—´copyã€‚ æ ‡è®°ç®—æ³•ï¼šæ‰«æå‡ºå­˜æ´»å¯¹è±¡ï¼Œç„¶åå†å›æ”¶æœªæ ‡è®°çš„å¯¹è±¡ï¼Œå›æ”¶åå¯¹ç©ºå‡ºçš„ç©ºé—´è¦ä¹ˆåˆå¹¶ï¼Œè¦ä¹ˆæ ‡è®°å‡ºæ¥ä¾¿äºä¸‹æ¬¡åˆ†é…ï¼Œä»¥å‡å°‘å†…å­˜ç¢ç‰‡å¸¦æ¥çš„æŸè€—ã€‚å¹´è€ä»£å¯¹è±¡å­˜æ´»æ—¶é—´è¾ƒé•¿è¾ƒç¨³å®šï¼Œä½¿ç”¨æ ‡è®°ç®—æ³•å›æ”¶ã€‚ GCç±»å‹ 1.kGcCauseForAllocï¼šåœ¨åˆ†é…å†…å­˜æ—¶å†…å­˜ä¸å¤Ÿæƒ…å†µä¸‹å¼•èµ·çš„GC,è¿™ç§æƒ…å†µä¸‹GCä¼šstop Worldã€‚Stop World æ˜¯ç”±äºå¹¶å‘GCæ—¶ï¼Œå…¶ä»–çº¿ç¨‹éƒ½ä¼šåœæ­¢ã€‚ 2.kGcCauseBackgroundï¼šå½“å†…å­˜è¾¾åˆ°ä¸€å®šé˜ˆå€¼çš„æ—¶å€™å¼•å‘GCï¼Œè¿™ä¸ªæ—¶å€™æ˜¯ä¸€ä¸ªåå°GC,ä¸ä¼šå¼•èµ·Stop Worldã€‚ 3.kGcCauseExplicitï¼šæ˜¾ç¤ºè°ƒç”¨æ—¶è¿›è¡Œçš„GCï¼Œå¦‚æœARTæ‰“å¼€äº†è¿™ä¸ªé€‰é¡¹ï¼Œåœ¨system.gcæ—¶ä¼šè¿›è¡ŒGCã€‚ å…¶ä»–GCæ³¨æ„äº‹é¡¹ 1.å°½é‡ä¸å»æ˜¾å¼è°ƒç”¨ system.gc() å‡å°‘ä¸å¿…è¦çš„ç³»ç»Ÿå¼€é”€ï¼Œå½±å“åº”ç”¨çš„æµç•…åº¦ã€‚ 2.å°½é‡å‡å°‘å†…å­˜æ³„éœ²ï¼Œé¿å…OOMã€‚ äºŒã€Androidå†…å­˜æ³„éœ² 1ã€ä»€ä¹ˆæ˜¯å†…å­˜æ³„éœ²ï¼Ÿ javaå¯¹è±¡æœ‰è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸï¼Œå½“è¿™ä¸ªå¯¹è±¡ä¸éœ€è¦å†ä½¿ç”¨æ—¶ï¼Œåº”è¯¥å®Œæ•´åœ°èµ°å®Œç”Ÿå‘½å‘¨æœŸï¼Œä½†å› ä¸ºæŸäº›åŸå› ï¼Œå¯¹è±¡è™½ç„¶å·²ç»ä¸å†ä½¿ç”¨ï¼Œä»ç„¶åœ¨å†…å­˜ä¸­å¹¶æ²¡æœ‰ç»“æŸæ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œè¿™å°±æ„å‘³ç€è¿™ä¸ªå¯¹è±¡å·²ç»æ³„éœ²äº†ã€‚ GCä¼šé€‰æ‹©ä¸€äº›è¿˜å­˜æ´»çš„å¯¹è±¡ä½œä¸ºå†…å­˜éå†çš„æ ¹èŠ‚ç‚¹ GC Roots,é€šè¿‡å¯¹GC Rootsçš„å¯è¾¾æ€§æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦å›æ”¶ã€‚ Androidç³»ç»Ÿè™šæ‹Ÿæœºçš„åƒåœ¾å›æ”¶æ˜¯é€šè¿‡è™šæ‹ŸæœºGCæœºåˆ¶æ¥å®ç°çš„ã€‚GCä¼šé€‰æ‹©ä¸€äº›å­˜æ´»çš„å¯¹è±¡ä½œä¸ºå†…å­˜ä¾¿åˆ©çš„è·ŸèŠ‚ç‚¹GC Roots,é€šè¿‡åˆ¤æ–­GC Rootsçš„å¯è¾¾æ€§æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦å›æ”¶ï¼Œå¦‚ä¸Šå›¾å…¶ä¸­ 1 2 3 4ç›´æ¥æˆ–é—´æ¥è¢«GC Rootså¼•ç”¨é“¾ç›¸è¿ï¼Œè¿™ç±»å¯¹è±¡è¢«è®¤ä¸ºè¿˜éœ€è¦ä½¿ç”¨çš„å¯¹è±¡ï¼Œå°±ä¸ä¼šè¢«å›æ”¶ã€‚5 6 7å°†ä¼šè¢«å›æ”¶ã€‚åˆ°é‚£æ—¶è¿™é‡Œå¦‚æœObject4 å¦‚æœä¸éœ€è¦ä½¿ç”¨çš„è¯è¿™æ—¶å€™ä¹Ÿä¸ä¼šè¢«å›æ”¶ï¼Œå°±å±äºå†…å­˜æ³„éœ²ã€‚ 2ã€å¸¸è§å†…å­˜æ³„éœ²åœºæ™¯ä»¥åŠæ³¨æ„äº‹é¡¹ ~ èµ„æºå‹å¯¹è±¡æœªå…³é—­ ~ æ³¨å†Œå¯¹è±¡æœªæ³¨é”€ ~ ç±»çš„é™æ€å˜é‡æŒæœ‰å¤§æ•°æ®å¯¹è±¡ å¦‚bitmap ~ è´¹é™æ€å†…éƒ¨ç±»çš„é™æ€å®ä¾‹ ~ Handlerä¸´æ—¶æ€§å†…å­˜æ³„éœ² ~ å®¹å™¨ä¸­çš„å¯¹è±¡æ²¡æœ‰æ¸…ç†é€ æˆçš„å†…å­˜æ³„éœ² 3ã€å†…å­˜æ³„éœ²åˆ†æå·¥å…· leakcanary ä¸‰ã€å¸¸è§æ³¨æ„äº‹é¡¹é¿å…å†…å­˜æ¶ˆè€—è¿‡å¤š 1ã€AutoBoxingè‡ªåŠ¨è£…ç®±è¿‡ç¨‹ Integer num=0; for(int i=0;i&lt;100;i++){ num+=i; â€‹â€‹}â€‹â€‹ è¿™æ®µä»£ç æ¯æ¬¡å¾ªç¯ï¼Œè™šæ‹Ÿæœºéƒ½å¿…é¡»åˆ›å»ºä¸€ä¸ªæ–°çš„æ•´æ•°å¯¹è±¡ï¼Œå¹¶æŠŠå®ƒåŠ åˆ°å…¶ä»–æ•´æ•°å¯¹è±¡å‰é¢ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„æ•´æ•°å¯¹è±¡ï¼Œæ„å‘³ç€è¦æ¶ˆè€—æ›´å¤šæ€§èƒ½ã€‚intåªæœ‰4å­—èŠ‚ï¼Œè€ŒIntegerå¯¹è±¡æœ‰16å­—èŠ‚ã€‚ 2ã€å†…å®¹å¤ç”¨ 1ã€æœ‰æ•ˆåˆ©ç”¨ç³»ç»Ÿè‡ªå¸¦èµ„æºã€‚ 2ã€è§†å›¾å¤ç”¨ï¼Œå¦‚ViewHolderã€‚ 3ã€å¯¹è±¡æ± ã€‚ 4ã€Bitmapå¯¹è±¡å¤ç”¨ã€‚ 3ã€ä½¿ç”¨æœ€ä¼˜çš„æ•°æ®ç±»å‹ 1ã€å½“å¯¹è±¡çš„æ•°ç›®åœ¨1000ä»¥å†…ä¸”ç‰¹åˆ«å¤šè®¿é—®è€Œåˆ é™¤å’Œæ’å…¥ä¸é«˜çš„æ—¶å€™å°½é‡ç”¨ArrayMapæ›¿ä»£HashMapã€‚ 2ã€æšä¸¾çš„æœ€å¤§ä¼˜ç‚¹æ˜¯å®‰å…¨ã€æ˜“è¯»ï¼Œä½†æ˜¯å†…å­˜æ¶ˆè€—æ˜¯å®šä¹‰å¸¸é‡çš„ä¸‰å€ä»¥ä¸Šã€‚å¯ä»¥ä½¿ç”¨æ³¨è§£æ–¹å¼æ¥æ£€æŸ¥å®‰å…¨ã€‚ 3ã€ä½¿ç”¨IntDefå’ŒStringDefæ£€æŸ¥ç±»å‹å®‰å…¨ã€‚ 4ã€LruCacheå»ºè®®ä½¿ç”¨è¿™ä¸ªç¼“å­˜æœºåˆ¶ï¼Œä½†æ˜¯æ—¢ä¸èƒ½åˆ†é…å¤ªå¤§ï¼Œä¹Ÿä¸èƒ½åˆ†é…å¤ªå°ã€‚ 4ã€å›¾ç‰‡çš„å†…å­˜ä¼˜åŒ– è®¾ç½®ä½å›¾è§„æ ¼ï¼Œä½¿ç”¨inSampleSizeå®ç°ä½å›¾ç¼©æ”¾å’Œå‹ç¼©ã€‚ä½¿ç”¨ç¼“å­˜æœºåˆ¶ç­‰ã€‚ å››ã€å†…å­˜åˆ†æå·¥å…· 1ã€Memory Monitor è¿™ä¸ªæ˜¯ä¸€ä¸ªæˆ‘ä»¬å¼€å‘è¿‡ç¨‹ä¸­å¾ˆå¸¸ç”¨çš„å†…å­˜ã€CPUã€ç½‘ç»œçš„åˆ†æå·¥å…·ã€‚ ç•Œé¢å¾ˆç›´è§‚ï¼Œå·¦ä¸Šè§’æœ‰è¿è¡Œçš„æœºå‹å’Œé¡¹ç›®åŒ…åï¼Œç„¶åæœ€ç›´è§‚çš„åŠ¨æ€å›¾ï¼Œåˆ†åˆ«æ˜¯CPUã€Memoryã€NetWorkã€‚ç‚¹è¿›å»å¯ä»¥è¿›å…¥çš„Memoryã€‚ è¿™é‡Œå¯ä»¥æ¸…æ™°çš„çœ‹åˆ°é¢œè‰²å¯¹åº”åŒºåŸŸå ç”¨çš„å†…å­˜å¤§å°ã€‚ é€šè¿‡è¿™ä¸¤å¼ å›¾ å†…å­˜çš„å¤§éƒ¨åˆ†ä¿¡æ¯éƒ½èƒ½æŸ¥é˜…åˆ°ã€‚æˆ‘ä»¬åœ¨æ“ä½œAPPåŠ è½½å›¾ç‰‡ç­‰æ“ä½œæ—¶å€™èƒ½çœ‹åˆ°å†…å­˜ä¸Šå‡ã€å’Œä¸‹é™ï¼Œå¦‚æœæ“ä½œAPPåå‘ç°å†…å­˜ä¸ä¼šä¸‹é™å¯èƒ½å°±æ˜¯æˆ‘ä»¬æœ‰äº›å¯¹è±¡æ²¡æœ‰åŠæ—¶é‡Šæ”¾ï¼Œä¹Ÿæœ‰å¯èƒ½å¯¼è‡´å†…å­˜æ³„éœ²ã€‚ è¿˜æœ‰å¯¹åº”çš„æ¨¡æ‹ŸGCï¼ŒæŸ¥çœ‹æ—¶é—´æ®µå…·ä½“å†…å­˜ä¿¡æ¯ä»¥åŠä¸€æ®µæ—¶é—´çš„å†…å­˜è¿½è¸ªç­‰å·¥å…·å¯ä»¥ä½¿ç”¨ã€‚å¯ä»¥å®šä½åˆ°å…·ä½“çš„ä»£ç è¡Œã€‚å¦‚ä¸‹å›¾ï¼š è¿™é‡Œæœ‰ä¸€ä¸ªShallow sizeè¿™ä¸ªå±æ€§çš„æ¦‚å¿µï¼š Shallow sizeå°±æ˜¯å¯¹è±¡æœ¬èº«å ç”¨å†…å­˜çš„å¤§å°ï¼Œä¸åŒ…å«å…¶å¼•ç”¨çš„å¯¹è±¡ã€‚å¸¸è§„å¯¹è±¡ï¼ˆéæ•°ç»„ï¼‰çš„Shallow sizeæœ‰å…¶æˆå‘˜å˜é‡çš„æ•°é‡å’Œç±»å‹å†³å®šã€‚æ•°ç»„çš„shallow sizeæœ‰æ•°ç»„å…ƒç´ çš„ç±»å‹ï¼ˆå¯¹è±¡ç±»å‹ã€åŸºæœ¬ç±»å‹ï¼‰å’Œæ•°ç»„é•¿åº¦å†³å®šã€‚ 2ã€Heap Viewrer å¦‚æœæ˜¯Android Studioçš„è¯é€šè¿‡Tools-&gt;Android-&gt;Android Device Monitoræ‰¾åˆ°è¿™ä¸ªå·¥å…·ã€‚ è¿›å…¥åé€‰æ‹©è¿è¡ŒAPPçš„åŒ…åç„¶åç‚¹å‡»update HeapæŒ‰é’®ï¼Œè¿™æ—¶å€™ä¼šåœ¨æ¯æ¬¡gcæ—¶å±•ç¤ºæ•°æ®ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥åœ¨åé¢æ‰‹åŠ¨GCï¼Œå¦‚æœåœ¨æ“ä½œé¡µé¢è¿™æ—¶å€™å¯èƒ½ä¼šå‘ç°å°å¡é¡¿ï¼Œå› ä¸ºåœ¨GCæ—¶ï¼Œå¯èƒ½å¯¼è‡´å…¶ä»–çº¿ç¨‹åœæ­¢å·¥ä½œï¼Œè¿™æ—¶å¯ä»¥æ¸…æ™°çœ‹åˆ°è¡¨ä¸­å†…å­˜ä¿¡æ¯ï¼š å¤´éƒ¨æ€»è§ˆè§†å›¾ï¼š æ ‡é¢˜ å«ä¹‰ Heap Size å †æ ˆåˆ†é…ç»™APPçš„å†…å­˜å¤§å°ã€‚ Allocated å·²åˆ†é…ä½¿ç”¨çš„å†…å­˜å¤§å°ã€‚ Free ç©ºé—²çš„å†…å­˜å¤§å°ã€‚ %Used Allocated/Heap Size çš„ä½¿ç”¨ç‡ã€‚ #Object å¯¹è±¡æ•°é‡ ä¸‹é¢è¯¦æƒ…è§†å›¾ï¼š æ ‡é¢˜ å«ä¹‰ free ç©ºé—²çš„å¯¹è±¡ data object æ•°æ®å¯¹è±¡ï¼ŒJavaç±»ç±»å‹å¯¹è±¡ï¼Œæ˜¯æœ€ä¸»è¦çš„è§‚å¯Ÿå¯¹è±¡ã€‚ class object javaç±»ç±»å‹çš„å¼•ç”¨å¯¹è±¡ã€‚ 1-byte array(byte[],boolean[]) ä¸€å­—èŠ‚çš„æ•°ç»„å¯¹è±¡ã€‚ 2-byte array(short[],char[]) ä¸¤å­—èŠ‚çš„æ•°ç»„å¯¹è±¡ã€‚ 4-byte array(object[],int[],float[]) 4å­—èŠ‚çš„æ•°ç»„å¯¹è±¡ã€‚ 8-byte array(long[],double[]) 8å­—èŠ‚çš„æ•°ç»„å¯¹è±¡ã€‚ non-java object éJavaå¯¹è±¡ã€‚ æ¯ä¸ªç±»å‹çš„æ•°æ®å€¼å¯¹åº”ï¼š æ ‡é¢˜ å«ä¹‰ Count æ•°é‡ Total Size æ€»å…±å ç”¨çš„å†…å­˜çš„å¤§å° Smallest å°†å¯¹è±¡å ç”¨å†…å­˜ä»å°åˆ°å¤§æ’åˆ—ï¼Œæ’åœ¨ç¬¬ä¸€ä¸ªå¯¹è±¡å ç”¨å†…å­˜å¤§å° Largest å°†å¯¹è±¡å ç”¨å†…å­˜ä»å°åˆ°å¤§æ’åˆ—ï¼Œæ’åœ¨æœ€åä¸€ä¸ªå¯¹è±¡å ç”¨çš„å†…å­˜å¤§å°ã€‚ Median å°†å¯¹è±¡å ç”¨å†…å­˜ä»å°åˆ°å¤§æ’åˆ—ï¼Œæ’åœ¨æ€»ç›‘çš„å¯¹è±¡å ç”¨çš„å†…å­˜å¤§å°ã€‚ Average å¹³å‡å€¼ ","link":"http://xuanguofeng.com/post/Androidä¼˜åŒ–-å†…å­˜ä¼˜åŒ–/"},{"title":"RxJavaç®€å•ä½¿ç”¨","content":"ä¸€ä¸ªåœ¨ Java VM ä¸Šä½¿ç”¨å¯è§‚æµ‹çš„åºåˆ—æ¥ç»„æˆå¼‚æ­¥çš„ã€åŸºäºäº‹ä»¶çš„ç¨‹åºçš„åº“ï¼Œæ˜¯é€šè¿‡ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼ã€‚ å…¶å®ä¸ªäººè®¤ä¸ºä¸»è¦çœ‹å…¶ä¸­çš„å‡ ä¸ªå…³é”®è¯å°±å¯ä»¥äº†æœ‰ï¼šå¼‚æ­¥ï¼Œäº‹ä»¶ï¼Œè§‚å¯Ÿè€…æ¨¡å¼ï¼Œçœ‹åˆ°è¿™å‡ ä¸ªå…³é”®è¯å…¶å®å¤§æ¦‚å¯¹è¿™ä¸ªä¸œè¥¿ä¹Ÿå°±æœ‰äº†åŸºæœ¬çš„å°è±¡ã€‚ RxJavaæœ€ç›´è§‚çš„ä½¿ç”¨æ€»ç»“ ä¸€ã€RxJavaæ˜¯ä»€ä¹ˆï¼Ÿ RxJava is a Java VM implementation of Reactive Extensions: a library for composing asynchronous and event-based programs by using observable sequences. ä¸€ä¸ªåœ¨ Java VM ä¸Šä½¿ç”¨å¯è§‚æµ‹çš„åºåˆ—æ¥ç»„æˆå¼‚æ­¥çš„ã€åŸºäºäº‹ä»¶çš„ç¨‹åºçš„åº“ï¼Œæ˜¯é€šè¿‡ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼ã€‚ å…¶å®ä¸ªäººè®¤ä¸ºä¸»è¦çœ‹å…¶ä¸­çš„å‡ ä¸ªå…³é”®è¯å°±å¯ä»¥äº†æœ‰ï¼šå¼‚æ­¥ï¼Œäº‹ä»¶ï¼Œè§‚å¯Ÿè€…æ¨¡å¼ï¼Œçœ‹åˆ°è¿™å‡ ä¸ªå…³é”®è¯å…¶å®å¤§æ¦‚å¯¹è¿™ä¸ªä¸œè¥¿ä¹Ÿå°±æœ‰äº†åŸºæœ¬çš„å°è±¡ã€‚ äºŒã€RxJavaç›¸å…³èµ„æ–™ Githubåœ°å€ https://github.com/ReactiveX/RxJava æ–‡æ¡£åœ°å€ https://www.gitbook.com/book/mcxiaoke/rxdocs/details ä¼˜ç§€åšæ–‡ http://gank.io/post/560e15be2dca930e00da1083#toc_1 ä¸‰ã€è§‚å¯Ÿè€…æ¨¡å¼ å…¶å®è§‚å¯Ÿè€…æ¨¡å¼å¾ˆç®€å•ã€‚ä¸€ä¸ªä¾‹å­ï¼š å¥½å¤šç½‘ç«™çš„æ–‡ç« æ˜¯æ”¯æŒç”¨æˆ·è®¢é˜…çš„ï¼Œå¦‚æœæœ‰æ›´æ–°å°±ä¼šå‘é‚®ä»¶ç»™ç”¨æˆ·ï¼Œè¿™ä¸ªæ¨¡å¼å°±å¯ä»¥ç”¨è§‚å¯Ÿè€…æ¨¡å¼æ¥å½¢å®¹ã€‚ å¦‚ ç½‘ç«™è¢«çœ‹åšè¢«è§‚å¯Ÿè€…ï¼Œç”¨æˆ·è¢«çœ‹åšè§‚å¯Ÿè€…ï¼Œç„¶åè¢«è§‚å¯Ÿè€…å°†è§‚å¯Ÿè€…è®¢é˜…ï¼ˆè¿™é‡Œæœ‰ç‚¹ç½‘ç«™è®¢é˜…ç”¨æˆ·çš„æ„æ€ï¼Œè™½ç„¶å­—é¢æ„æ€æ˜¯è¿™æ ·ï¼Œä½†æ˜¯æˆ‘ä»¬ç†è§£å¯ä»¥æŒ‰ç…§æ­£å¸¸æ€ç»´ç†è§£ï¼Œæ˜¯è®©è§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…å…³è”èµ·æ¥ï¼‰ï¼Œå½“æœ‰æ›´æ–°çš„æ—¶å€™è¢«è§‚å¯Ÿè€…é€šçŸ¥è§‚å¯Ÿè€…ã€‚ä»è€Œäº§ç”Ÿè§‚å¯Ÿè€…ä¸­è§‚çœ‹æ–‡ç« çš„äº‹ä»¶ã€‚ å››ã€RxJavaä½¿ç”¨ ä¸€ã€åŸºæœ¬ä½¿ç”¨ åœ¨RxJavaä¸­æœ‰ä¸‰ä¸ªåŸºæœ¬çš„æ¦‚å¿µã€‚Observableã€Observerã€subscribe()ã€‚ è¿™ä¸‰ä¸ªæ¦‚å¿µä»å­—é¢æ„ä¹‰ä¹ŸåŸºæœ¬èƒ½çŒœæµ‹ã€‚ Observable:ä»£è¡¨ç€è¢«è§‚å¯Ÿè€…ï¼Œä¹Ÿå°±æ˜¯ä¸Šæ–‡ä¸­ç½‘ç«™ã€‚ Observer:ä»£è¡¨ç€è§‚å¯Ÿè€…ï¼Œä¹Ÿå°±æ˜¯ä¸Šæ–‡ä¸­çš„ç”¨æˆ·ã€‚ subscribe:è¿™æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è®¢é˜…ã€‚ Observable&lt;String&gt; observable = Observable.create(new ObservableOnSubscribe&lt;String&gt;() { @Override public void subscribe(@NonNull ObservableEmitter&lt;String&gt; observableEmitter) throws Exception { observableEmitter.onNext(&quot;1&quot;); } }); Observer&lt;String&gt; observer = new Observer&lt;String&gt;() { @Override public void onSubscribe(@NonNull Disposable disposable) { Log.e(TAG, &quot;onSubscribe&quot;); } @Override public void onNext(@NonNull String s) { Log.e(TAG, &quot;onNext---&gt;&quot;+s); } @Override public void onError(@NonNull Throwable throwable) { Log.e(TAG, &quot;onError&quot;); } @Override public void onComplete() { Log.e(TAG, &quot;onComplete&quot;); } }; observable.subscribe(observer); è¿è¡Œç»“æœå¦‚ä¸‹ï¼š 10-23 02:38:52.525 3820-3820/com.xuanguofeng.rxjava E/MainActivity----&gt;: onSubscribe 10-23 02:38:52.525 3820-3820/com.xuanguofeng.rxjava E/MainActivity----&gt;: onNext---&gt;1 å¤§æ¦‚æµç¨‹å°±æ˜¯è¿™æ · è¢«è§‚å¯Ÿè€…(ç½‘ç«™)å¯ä»¥é€šè¿‡onNext()æ–¹æ³•å‘Šè¯‰è§‚å¯Ÿè€…(ç”¨æˆ·)ï¼Œæ–°é—»ç»™ä½ å‘è¿‡å»äº†ä½ çœ‹ä¸‹å§ï¼Œç„¶åè§‚å¯Ÿè€…(ç”¨æˆ·)ä¹Ÿé€šè¿‡onNextæ–¹æ³•é‡Œé¢çš„å‚æ•°è¿›è¡Œâ€œçœ‹æ–°é—»â€ã€‚ è¿™é‡Œè¿˜æœ‰å¦å¤–å‡ ä¸ªæ–¹æ³• onSubscribe()ï¼ŒonNext(),onError()ï¼ŒonComplete()æˆ‘ä»¬åˆ†åˆ«è¯•è¯• å…ˆçœ‹onComplete() Observable&lt;String&gt; observable = Observable.create(new ObservableOnSubscribe&lt;String&gt;() { @Override public void subscribe(@NonNull ObservableEmitter&lt;String&gt; observableEmitter) throws Exception { observableEmitter.onNext(&quot;1&quot;); observableEmitter.onNext(&quot;2&quot;); observableEmitter.onNext(&quot;3&quot;); observableEmitter.onComplete(); observableEmitter.onNext(&quot;4&quot;); observableEmitter.onNext(&quot;5&quot;); } }); æŠŠè¢«è§‚å¯Ÿè€…é‡Œçš„æ—¶é—´ä¿®æ”¹ä¸€ä¸‹çœ‹ä¸‹è§‚å¯Ÿè€…é‡Œçš„ç»“æœ 10-23 03:09:58.640 4281-4281/? E/MainActivity----&gt;: onSubscribe 10-23 03:09:58.641 4281-4281/? E/MainActivity----&gt;: onNext---&gt;1 10-23 03:09:58.641 4281-4281/? E/MainActivity----&gt;: onNext---&gt;2 10-23 03:09:58.641 4281-4281/? E/MainActivity----&gt;: onNext---&gt;3 10-23 03:09:58.641 4281-4281/? E/MainActivity----&gt;: onComplete ä¼šå‘ç°åé¢çš„4 5äº‹ä»¶ä¸è§äº† è¿™å°±æ˜¯ä»£è¡¨ç€å¦‚æœè°ƒç”¨äº†è¿™ä¸ªæ–¹æ³•å…¶å®äº‹ä»¶è¿˜æ˜¯åœ¨ç»§ç»­å‘é€ï¼Œåªæ˜¯æˆ‘ä»¬çš„è§‚å¯Ÿè€…é‡Œé¢ä¸æ¥æ”¶äº†ã€‚ è¿™ä¸ªæµç¨‹å’ŒonError()æ˜¯ä¸€æ ·çš„å½“è°ƒç”¨onError()çš„æ—¶å€™,onError()ä¹Ÿæ˜¯è¢«è§‚å¯Ÿè€…å¯ä»¥ç»§ç»­å‘äº‹ä»¶ï¼Œä½†æ˜¯åé¢ä¸ä¼šå†æ¥æ”¶ã€‚ è¿™ä¸¤ä¸ªäº‹ä»¶onCompleteå’ŒonErrorå¯ä»¥ä¸å‘é€ã€‚ onCompleteå’ŒonErrorè¿™ä¸¤ä¸ªæ–¹æ³•å”¯ä¸€å¹¶ä¸”äº’æ–¥ï¼Œå°±æ˜¯ä¸èƒ½å¤šå‘ï¼Œä¹Ÿä¸èƒ½åŒæ—¶å‘ã€‚ onSubscribeè¿™ä¸ªæ–¹å¯ä»¥çœ‹åˆ°æ€»æ˜¯åœ¨ç¬¬ä¸€ä¸ªè°ƒç”¨ï¼Œå³ä½¿æ²¡æœ‰ä»»ä½•äº‹ä»¶å‘é€ã€‚ å½“ç„¶ä¹Ÿå¯ä»¥å†™æˆè¿™æ ·ï¼Œå°±æ˜¯RxJavaä¸­è¢«å¹¿æ³›æµä¼ çš„é“¾å¼è°ƒç”¨ã€‚ Observable.create(new ObservableOnSubscribe&lt;String&gt;() { @Override public void subscribe(@NonNull ObservableEmitter&lt;String&gt; observableEmitter) throws Exception { observableEmitter.onNext(&quot;1&quot;); observableEmitter.onNext(&quot;2&quot;); observableEmitter.onNext(&quot;3&quot;); observableEmitter.onComplete(); observableEmitter.onNext(&quot;4&quot;); observableEmitter.onNext(&quot;5&quot;); } }).subscribe(new Observer&lt;String&gt;() { @Override public void onSubscribe(@NonNull Disposable disposable) { Log.e(TAG, &quot;onSubscribe&quot;); } @Override public void onNext(@NonNull String s) { Log.e(TAG, &quot;onNext---&gt;&quot;+s); } @Override public void onError(@NonNull Throwable throwable) { Log.e(TAG, &quot;onError&quot;); } @Override public void onComplete() { Log.e(TAG, &quot;onComplete&quot;); } }); äºŒã€å¼‚æ­¥ RxJavaåœ¨ä»‹ç»çš„æ—¶å€™æœ‰ä¸€ä¸ªå…³é”®è¯æ˜¯å¼‚æ­¥ï¼Œé‚£ä¹ˆå°±è¦åœ¨è€ƒè™‘ä¸€ä¸ªé—®é¢˜ï¼ŒRxJavaå¦‚æœè¿›è¡Œä¸åŒçº¿ç¨‹çš„æ“ä½œå‘¢ï¼Ÿ å…¶å®ä¸Šé¢æ‰€åšçš„æ“ä½œï¼Œéƒ½æ˜¯åœ¨å½“å‰çº¿ç¨‹å®Œæˆï¼Œåœ¨å½“å‰çº¿ç¨‹å‘é€äº‹ä»¶ï¼Œåœ¨å½“å‰çº¿ç¨‹å¤„ç†äº‹ä»¶ï¼Œæ€ä¹ˆè¯æ˜ä»–ä»¬æ˜¯åœ¨åŒä¸€ä¸ªçº¿ç¨‹å‘¢?åˆ†åˆ«åœ¨å‘é€å’Œå¤„ç†çš„äº‹ä»¶é‡Œå¢åŠ ä¸€ä¸ªè·å–çº¿ç¨‹idçš„logã€‚æ‰“å°å¦‚ä¸‹ï¼š 10-23 03:40:02.965 10588-10588/com.xuanguofeng.rxjava E/MainActivity----&gt;: onSubscribe 10-23 03:40:02.965 10588-10588/com.xuanguofeng.rxjava E/MainActivity----&gt;: onSubscribe-&gt;çº¿ç¨‹id-----&gt;1 10-23 03:40:02.965 10588-10588/com.xuanguofeng.rxjava E/MainActivity----&gt;: onNext---&gt;1 10-23 03:40:02.965 10588-10588/com.xuanguofeng.rxjava E/MainActivity----&gt;: onNext-&gt;çº¿ç¨‹id-----&gt;1 10-23 03:40:02.965 10588-10588/com.xuanguofeng.rxjava E/MainActivity----&gt;: subscribe-&gt;çº¿ç¨‹id---&gt;1 æ— è®ºæ˜¯å‘é€è¿˜æ˜¯æ¥æ”¶éƒ½åœ¨idä¸º1çš„çº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯uiçº¿ç¨‹ã€‚ Observable.create(new ObservableOnSubscribe&lt;String&gt;() { @Override public void subscribe(@NonNull ObservableEmitter&lt;String&gt; observableEmitter) throws Exception { observableEmitter.onNext(&quot;1&quot;); observableEmitter.onNext(&quot;2&quot;); observableEmitter.onNext(&quot;3&quot;); Log.e(TAG, &quot;subscribe-&gt;çº¿ç¨‹id---&gt;&quot; + Thread.currentThread().getId()); } }).subscribeOn(Schedulers.newThread()) .observeOn(AndroidSchedulers.mainThread()) .subscribe(new Observer&lt;String&gt;() { @Override public void onSubscribe(@NonNull Disposable disposable) { Log.e(TAG, &quot;onSubscribe&quot;); Log.e(TAG, &quot;onSubscribe-&gt;çº¿ç¨‹id-----&gt;&quot; + Thread.currentThread().getId()); } @Override public void onNext(@NonNull String s) { Log.e(TAG, &quot;onNext---&gt;&quot; + s); Log.e(TAG, &quot;onNext-&gt;çº¿ç¨‹id-----&gt;&quot; + Thread.currentThread().getId()); } @Override public void onError(@NonNull Throwable throwable) { Log.e(TAG, &quot;onError&quot;); } @Override public void onComplete() { Log.e(TAG, &quot;onComplete&quot;); } }); æ‰“å°ç»“æœ 10-23 03:43:26.774 10588-10588/com.xuanguofeng.rxjava E/MainActivity----&gt;: onSubscribe 10-23 03:43:26.774 10588-10588/com.xuanguofeng.rxjava E/MainActivity----&gt;: onSubscribe-&gt;çº¿ç¨‹id-----&gt;1 10-23 03:43:26.775 10588-14670/com.xuanguofeng.rxjava E/MainActivity----&gt;: subscribe-&gt;çº¿ç¨‹id---&gt;248 10-23 03:43:26.846 10588-10588/com.xuanguofeng.rxjava E/MainActivity----&gt;: onNext---&gt;1 10-23 03:43:26.846 10588-10588/com.xuanguofeng.rxjava E/MainActivity----&gt;: onNext-&gt;çº¿ç¨‹id-----&gt;1 10-23 03:43:26.846 10588-10588/com.xuanguofeng.rxjava E/MainActivity----&gt;: onNext---&gt;2 10-23 03:43:26.846 10588-10588/com.xuanguofeng.rxjava E/MainActivity----&gt;: onNext-&gt;çº¿ç¨‹id-----&gt;1 10-23 03:43:26.846 10588-10588/com.xuanguofeng.rxjava E/MainActivity----&gt;: onNext---&gt;3 10-23 03:43:26.846 10588-10588/com.xuanguofeng.rxjava E/MainActivity----&gt;: onNext-&gt;çº¿ç¨‹id-----&gt;1 å¯ä»¥çœ‹åˆ° å‘é€çš„çº¿ç¨‹idæ˜¯248ï¼Œè€Œå¤„ç†äº‹ä»¶çš„çº¿ç¨‹æ˜¯1ã€‚ä»”ç»†çœ‹ä¸‹ä»£ç å˜åŒ–åœ¨äº .subscribeOn(Schedulers.newThread()) .observeOn(AndroidSchedulers.mainThread()) é“¾å¼è°ƒç”¨äº†è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œä¹Ÿå¾ˆç›´è§‚ä¸€ä¸ªæ˜¯åœ¨ä»€ä¹ˆçº¿ç¨‹å‘é€ï¼Œå¦ä¸€ä¸ªæ˜¯åœ¨ä»€ä¹ˆçº¿ç¨‹å¤„ç†ï¼Œè¿™é‡Œæ–°å»ºäº†ä¸€ä¸ªçº¿ç¨‹å‘é€ï¼Œç„¶ååœ¨UIçº¿ç¨‹è¿›è¡Œæ¥æ”¶å¤„ç†ã€‚ RxJavaä¸­æœ‰å››ä¸ªçº¿ç¨‹å¯ä»¥è®©æˆ‘ä»¬é€‰æ‹©ï¼š Schedulers.io():IOçº¿ç¨‹ï¼Œä¸»è¦ç”¨äºç½‘ç»œè¯»å†™ Schedulers.computation()ï¼šä»£è¡¨CPUè®¡ç®—å¯†é›†å‹çš„æ“ä½œ, ä¾‹å¦‚éœ€è¦å¤§é‡è®¡ç®—çš„æ“ä½œ Schedulers.newThread()ï¼šè¿™ä¸ªå½“ç„¶æ˜¯ä»£è¡¨åˆ›å»ºä¸€ä¸ªæ–°çš„å¸¸è§„çº¿ç¨‹ AndroidSchedulers.mainThread()ï¼šè¿™ä¸ªä»£è¡¨Androidä¸­çš„UIçº¿ç¨‹ï¼Œå¯ä»¥åœ¨è¿™é‡Œæ›´æ–°é¡µé¢æ“ä½œ ","link":"http://xuanguofeng.com/post/RxJavaç®€å•ä½¿ç”¨/"},{"title":"AndroidåŠ¨ç”»çš„åˆ†ç±»ä¸ä½¿ç”¨æ€»ç»“ï¼ˆå‚ç…§å®˜æ–¹apiï¼‰","content":"ä¸ºä»€ä¹ˆä½¿ç”¨åŠ¨ç”»è‡ªä»Android5.0ä»¥åï¼ŒGoogleå®£å¸ƒäº†Material Designçš„è®¾è®¡è¯­è¨€ï¼Œä¹Ÿå¢åŠ äº†å¾ˆå¤šåŠ¨ç”»æ•ˆæœï¼Œä½¿å¾—appçœ‹èµ·æ¥æ›´è‡ªç„¶ç¾è§‚ï¼Œäº¤äº’ä½“éªŒæ›´å¥½ã€‚åœ¨æˆ‘ä»¬çš„appé‡Œå¦‚æœé€‚å½“çš„ä½¿ç”¨åŠ¨ç”»çš„è¯ï¼Œä¼šç»™appå¸¦æ¥æ›´æ£’çš„äº¤äº’ä½“éªŒï¼Œå½“ç„¶å¦‚æœåŠ¨ç”»ç”¨çš„ä¸åˆé€‚æˆ–è€…æ»¥ç”¨çš„è¯ï¼Œä¹Ÿä¼šå¸¦æ¥æ›´ç³Ÿçš„ä½“éªŒã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨äº†è§£åŠ¨ç”»æœºåˆ¶çš„æƒ…å†µä¸‹é€‚å½“çš„ä½¿ç”¨åŠ¨ç”»æ‰æ˜¯é”¦ä¸Šæ·»èŠ±ã€‚ è¿™é‡Œæä¾›Googleå¯¹Material Designå¯¹ä»‹ç»åœ°å€ï¼šhttps://material.io/guidelines/motion/material-motion.html# Androidä¸­åŠ¨ç”»çš„åˆ†ç±» Android framework æä¾›äº†2ä¸­åŠ¨ç”»æ¡†æ¶ï¼šå±æ€§åŠ¨ç”»å’Œè§†å›¾åŠ¨ç”»ã€‚ä¸¤ç§åŠ¨ç”»æ¡†æ¶éƒ½æ˜¯å¯è¡Œçš„ï¼Œä½†ä¸€èˆ¬æ¥è¯´å±æ€§åŠ¨ç”»æ˜¯é¦–é€‰çš„æ–¹æ³•ï¼Œå› ä¸ºå®ƒä½¿ç”¨èµ·æ¥æ›´çµæ´»ä¹Ÿæä¾›äº†æ›´å¤šçš„ç‰¹æ€§ï¼Œé™¤äº†è¿™ä¸¤ç§åŠ¨ç”»æ¡†æ¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¸§åŠ¨ç”»ï¼ˆDrawable animationï¼‰ï¼Œå¸§åŠ¨ç”»å…è®¸åŠ è½½å¹¶å±•ç¤ºä¸€å¼ ä¸€å¼ çš„å¯æç»˜èµ„æºç»„æˆåŠ¨ç”»ã€‚ Property Animationï¼ˆå±æ€§åŠ¨ç”»ï¼‰ å±æ€§åŠ¨ç”»æ˜¯åœ¨Android3.0ä¹‹åæä¾›çš„åŠ¨ç”»ï¼Œå¯ä»¥å¯¹ä¸€ä¸ªå¯¹è±¡çš„å±æ€§è¿›è¡Œæ“ä½œï¼Œä»è€Œè¾¾åˆ°åŠ¨ç”»çš„æ•ˆæœï¼ŒåŒ…æ‹¬æ²¡æœ‰è¢«æ¸²æŸ“åˆ°å±å¹•ä¸Šçš„ï¼Œè¯¥ç³»ç»Ÿæ˜¯å¯æ‰©å±•çš„ï¼Œè®©æ‚¨å¯ä»¥å°†å®šåˆ¶ç±»å‹çš„å±æ€§è¿›è¡ŒåŠ¨ç”»åŒ–ã€‚ View Animationï¼ˆè§†å›¾åŠ¨ç”»ï¼‰ è§†å›¾åŠ¨ç”»æ˜¯è¾ƒè€çš„ç³»ç»Ÿï¼Œåªèƒ½ç”¨äºè§†å›¾ï¼Œè®¾ç½®å’Œæä¾›è¶³å¤Ÿçš„èƒ½åŠ›æ¥æ»¡è¶³è®¸å¤šåº”ç”¨ç¨‹åºçš„éœ€æ±‚æ˜¯ç›¸å¯¹å®¹æ˜“çš„ Drawable Animationï¼ˆå¸§åŠ¨ç”»ï¼‰ å¯ç»˜åˆ¶çš„åŠ¨ç”»éœ€è¦ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ˜¾ç¤ºå¯ç»˜åˆ¶çš„èµ„æºï¼Œå°±åƒèƒ¶å·ä¸€æ ·ã€‚å¦‚æœæ‚¨å¸Œæœ›ç”¨å¯ç»˜åˆ¶çš„èµ„æºæ¥è¡¨ç¤ºæ›´å®¹æ˜“è¡¨ç¤ºçš„åŠ¨ç”»ï¼Œæ¯”å¦‚ä½å›¾çš„è¿›å±•ï¼Œé‚£ä¹ˆè¿™ç§åŠ¨ç”»æ–¹æ³•æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ è§†å›¾åŠ¨ç”»ä¸å±æ€§åŠ¨ç”»çš„åŒºåˆ«ï¼ˆHow Property Animation Differs from View Animationï¼‰ åªèƒ½æ”¯æŒç®€å•çš„ç¼©æ”¾ã€å¹³ç§»ã€æ—‹è½¬ã€é€æ˜åº¦åŸºæœ¬çš„åŠ¨ç”»ï¼Œä¸”æœ‰ä¸€å®šçš„å±€é™æ€§ã€‚ è§†å›¾åŠ¨ç”»ç³»ç»Ÿçš„å¦ä¸€ä¸ªç¼ºç‚¹æ˜¯å®ƒåªä¿®æ”¹äº†è§†å›¾è¢«ç»˜åˆ¶çš„åœ°æ–¹ï¼Œè€Œä¸æ˜¯å®é™…çš„è§†å›¾æœ¬èº«ã€‚ä¾‹å¦‚å¯¹ä¸€ä¸ªimageviewæ·»åŠ äº‹ä»¶åï¼Œå¹³ç§»é‚£ä¹ˆäº‹ä»¶è¿˜æ˜¯ä¼šåœ¨ä¹‹å‰çš„ä½ç½®ã€‚ å±æ€§åŠ¨ç”»å°†ä¸å­˜åœ¨è¿™äº›é™åˆ¶ï¼Œæ‚¨å¯ä»¥å¯¹ä»»ä½•å¯¹è±¡(è§†å›¾å’Œéè§†å›¾)çš„ä»»ä½•å±æ€§è¿›è¡ŒåŠ¨ç”»ï¼Œå¹¶ä¸”å¯¹è±¡æœ¬èº«å®é™…ä¸Šæ˜¯è¢«ä¿®æ”¹çš„ã€‚è§†å›¾åŠ¨ç”»çš„ä½¿ç”¨æ¯”è¾ƒç®€å•ã€‚ å±æ€§åŠ¨ç”»çš„ä½¿ç”¨ ObjectAnimator ObjectAnimatoræ˜¯å±æ€§åŠ¨ç”»æ¡†æ¶ä¸­æœ€é‡è¦çš„å®è¡Œç±»ï¼Œåˆ›å»ºä¸€ä¸ªObjectAnimatoråªéœ€è¦é€šè¿‡é™æ€å·¥å‚ç±»ç›´æ¥è¿”å›ä¸€ä¸ªObjectAnimatorå¯¹è±¡å³å¯ã€‚å‚æ•°åŒ…å«ä¸€ä¸ªå¯¹è±¡å’Œå¯¹è±¡çš„å±æ€§åå­—ï¼Œä½†æ˜¯è¿™ä¸ªå±æ€§å¿…é¡»æœ‰getå’Œsetå‡½æ•°ï¼Œå†…éƒ¨ä¼šé€šè¿‡åå°„æœºåˆ¶æ¥è°ƒç”¨setå‡½æ•°ä¿®æ”¹å¯¹è±¡çš„å±æ€§å€¼ã€‚ ä¾‹å¦‚ï¼šä¸€ä¸ªå›¾ç‰‡å¹³ç§»çš„åŠ¨ç”» ObjectAnimator anim = ObjectAnimator .ofFloat(view, &quot;translationX&quot;, 300) .setDuration(500); anim.start(); é€šè¿‡è¿™æ®µä»£ç å°±èƒ½ä½¿å¾—è¿™ä¸ªviewè¿›è¡Œå¹³ç§»åŠ¨ç”»ã€‚ ofFloatæºç ï¼š public static &lt;T&gt; ObjectAnimator ofArgb(T target, Property&lt;T, Integer&gt; property, int... values) { ObjectAnimator animator = ofInt(target, property, values); animator.setEvaluator(ArgbEvaluator.getInstance()); return animator; } ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æˆ‘ä»¬è¦æ“çºµçš„viewï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¦æ“çºµçš„å±æ€§ã€‚ æœ€åä¸€ä¸ªæ˜¯ä¸€ä¸ªå¯å˜æ•°ç»„å‚æ•°ï¼Œéœ€è¦ç©¿è¿›å»è¯¥å±æ€§å˜åŒ–çš„ä¸€ä¸ªå–å€¼è¿‡ç¨‹ï¼Œè¿™é‡Œè®¾ç½®äº†ä¸€ä¸ªå‚æ•°ï¼Œå³å˜åŒ–åˆ°300ã€‚ å¸¸ç”¨çš„å±æ€§ï¼š å±æ€§åç§° å±æ€§æè¿° translationXå’ŒtranslationY è¿™ä¸¤ä¸ªå±æ€§ä½œä¸ºä¸€ç§å¢é‡æ¥æ§åˆ¶ç€viewå¯¹è±¡ä»å®ƒå¸ƒå±€å®¹å™¨çš„å·¦ä¸Šè§’åæ ‡åç§»çš„ä½ç½® ratation,rotationX,rotationY è¿™ä¸‰ä¸ªå±æ€§æ§åˆ¶viewå¯¹è±¡å›´ç»•æ”¯ç‚¹è¿›è¡Œ2Då’Œ3Dæ—‹è½¬ scaleX,scaleY è¿™ä¸¤ä¸ªå±æ€§æ§åˆ¶ç€viewå¯¹è±¡å›´ç»•å®ƒçš„æŒ‡ç‚¹è¿›è¡Œ2Dç¼©æ”¾ pivotX,pivotY è¿™ä¸¤ä¸ªå±æ€§æ§åˆ¶ç€viewå¯¹è±¡çš„æ”¯ç‚¹ä½ç½®ï¼Œå›´ç»•è¿™ä¸ªæ”¯ç‚¹è¿›è¡Œæ—‹è½¬å’Œç¼©æ”¾å˜æ¢å¤„ç†ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯¥è´¨ç‚¹çš„ä½ç½®å°±æ˜¯viewå¯¹è±¡çš„ä¸­å¿ƒç‚¹ x,y è¿™ä¸¤ä¸ªç®€å•å®ç”¨çš„å±æ€§ï¼Œå®ƒæè¿°äº†viewå¯¹è±¡åœ¨å®ƒçš„å®¹å™¨ä¸­çš„æœ€ç»ˆä½ç½®ï¼Œå®ƒæ˜¯æœ€åˆçš„ç»„å¥¥ä¸Šäº¤åæ ‡å’ŒtranslationXï¼ŒtranslationYå€¼çš„ç´¯ç§¯å’Œã€‚ alpha å®ƒè¡¨ç¤ºviewå¯¹è±¡çš„alphaé€æ˜åº¦ã€‚é»˜è®¤å€¼æ˜¯1ï¼ˆä¸é€æ˜ï¼‰ï¼Œ0ä»£è¡¨å®Œå…¨é€æ˜ï¼ˆä¸å¯è§ï¼‰ã€‚ ValueAnimator ValueAnimatorç±»å…è®¸æ‚¨é€šè¿‡æŒ‡å®šä¸€ç»„intã€floatæˆ–é¢œè‰²å€¼æ¥æ¿€æ´»åŠ¨ç”»çš„æŒç»­æ—¶é—´ï¼Œä»è€Œç›‘å¬æ•°å€¼çš„å˜åŒ–å®ŒæˆåŠ¨ç”»çš„å˜æ¢ã€‚ ValueAnimator animation = ValueAnimator.ofFloat(0, 100); animation.setTarget(view); animation.setDuration(1000); animation.start(); animation.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { @Override public void onAnimationUpdate(ValueAnimator animation) { Float value = animation.getAnimatedFraction(); Log.e(&quot;tag&quot;, String.valueOf(value)); } }); åŠ¨ç”»äº‹ä»¶çš„ç›‘å¬ objectAnimatorå¯ä»¥ç›‘å¬åŠ¨ç”»ä»å¼€å§‹åˆ°ç»“æŸçš„å››ä¸ªè¿‡ç¨‹ã€‚ anim.addListener(new Animator.AnimatorListener() { @Override public void onAnimationStart(Animator animation) { } @Override public void onAnimationEnd(Animator animation) { } @Override public void onAnimationCancel(Animator animation) { } @Override public void onAnimationRepeat(Animator animation) { } }); ä¸è¿‡å¤§éƒ¨åˆ†æ—¶å€™æˆ‘ä»¬éœ€è¦å…³å¿ƒåŠ¨ç”»ç»“æŸæ—¶ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è¿™æ ·ï¼š anim.addListener(new AnimatorListenerAdapter() { @Override public void onAnimationEnd(Animator animation) { super.onAnimationEnd(animation); } }); AnimatorSet AnimatorSetå¯ä»¥å®ç°å¤šç§åŠ¨ç”»çš„å±•ç¤ºã€‚ AnimatorSet set=new AnimatorSet(); set.setDuration(1000); set.playTogether(anim1,anim2); set.start(); é™¤äº†set.playTogetherï¼ˆï¼‰æ–¹æ³•ï¼Œè¿˜æœ‰playSequentially(),set.play().with(),set.play().before(),set.play().after()ç­‰æ–¹æ³•æ¥æ§åˆ¶å¤šä¸ªåŠ¨ç”»çš„ååŒå·¥ä½œæ–¹å¼ï¼Œä»è€Œæ§åˆ¶é¡ºåºã€‚ è§†å›¾åŠ¨ç”»çš„ä½¿ç”¨ åœ¨3.0ä¹‹å‰ï¼Œè§†å›¾åŠ¨ç”»æ˜¯è¢«å¹¿æ³›åº”ç”¨ï¼Œä½†3.0åå±æ€§åŠ¨ç”»çš„å‡ºç°ï¼Œä½¿å¾—è§†å›¾åŠ¨ç”»çš„ç¼ºç‚¹ä¹Ÿå°±è¢«æ”¾å¤§äº†ã€‚ä¸»è¦ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯å½“è§†å›¾ç§»åŠ¨åï¼Œå…¶å“åº”äº‹ä»¶çš„ä½ç½®è¿˜ä¾ç„¶åœ¨åŠ¨ç”»å‰çš„åœ°æ–¹ï¼Œæ‰€ä»¥è§†å›¾åŠ¨ç”»åªèƒ½åšæ™®é€šçš„åŠ¨ç”»å±•ç¤ºæ•ˆæœï¼Œé¿å…äº¤äº’çš„å‘ç”Ÿã€‚ ä¸»è¦æä¾›äº†AlphaAnimation,RotateAnimation,TranslateAnimation,ScaleAnimationå››ç§åŠ¨ç”»æ–¹å¼ï¼Œä¹Ÿæä¾›äº†AnimationSetåŠ¨ç”»é›†åˆï¼Œæ··åˆä½¿ç”¨å¤šç§åŠ¨ç”»ã€‚ RotateAnimationï¼ˆæ—‹è½¬åŠ¨ç”»ï¼‰ RotateAnimation rotateAnimation=new RotateAnimation(0,360,100,100); rotateAnimation.setDuration(1000); view.startAnimation(rotateAnimation); å‚æ•°åˆ†åˆ«ä¸ºæ—‹è½¬çš„èµ·å§‹è§’åº¦å’Œæ—‹è½¬ä¸­å¿ƒç‚¹çš„åæ ‡ã€‚ TranslateAnimationï¼ˆä½ç§»åŠ¨ç”»ï¼‰ ScaleAnimationï¼ˆç¼©æ”¾åŠ¨ç”»ï¼‰ æ€»ç»“ï¼šå…¶å®æ¯ç§åŠ¨ç”»çš„çš„ä½¿ç”¨æ–¹å¼åŸºæœ¬ç›¸åŒï¼Œæ— éå°±æ˜¯ä¸€äº›å‚æ•°çš„ç‰¹æ€§ä¸åŒã€‚ ","link":"http://xuanguofeng.com/post/AndroidåŠ¨ç”»çš„åˆ†ç±»ä¸ä½¿ç”¨æ€»ç»“ï¼ˆå‚ç…§å®˜æ–¹apiï¼‰/"},{"title":"Javaå¸¸ç”¨æ’åºç®—æ³•å†’æ³¡æ’åºä¸é€‰æ‹©æ’åºæ€»ç»“","content":"æ’åºç®—æ³•æœ‰å¥½å¤šç§ï¼Œä¹Ÿåœ¨ç‰¹æ®Šçš„åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¯¹æˆ‘ä»¬çš„æ•°æ®è¿›è¡Œæ’åºï¼Œè¿™é‡Œå¯¹ç»å…¸çš„æ’åºåšä¸€ä¸ªè®°å½•æ•´ç†ã€‚ ä¸€å†’æ³¡æ’åº åŸç†åˆ†æ å†’æ³¡æ’åºå…¶å®å°±æ˜¯å¯¹ä¸€ç»„æ•°ä»¥ç±»ä¼¼å†’æ³¡å¯¹å½¢å¼ï¼Œè¿›è¡Œä»å¤§åˆ°å°æˆ–è€…ä»å°åˆ°å¤§çš„æ’åºï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯å†’æ³¡å‘¢ï¼Ÿ å…¶å®ä¹Ÿç®€å•ï¼Œæ¯”å¦‚æœ‰ä¸€ç»„æ•°å­—ï¼š3ï¼Œ9ï¼Œ6ï¼Œ2 ä»¥ä¸Šå›¾åªæ¯”è¾ƒäº†ç¬¬ä¸€è½®ï¼Œä¼šå†’å‡ºä¸€ä¸ªè¾ƒå¤§å¤§ï¼Œä¾æ­¤ç±»æ¨è¿›è¡Œæ¯”è¾ƒã€‚ ä»¥æ­¤æ¯”è¾ƒä¸¤ä¸ªæ•°å­—ï¼Œå°†è¾ƒè¾ƒå°çš„æ•°å­—ä¸€ä¸ªä¸€ä¸ªå†’ä¸Šæ¥ï¼Œå°†ç›¸åçš„è¾ƒå¤§çš„æ•°å­—å¾€ä¸‹æ²‰ï¼Œç„¶åå†…å±‚å¾ªç¯æ¯ä¸€è½®æ¯”è¾ƒå°±ä¼šå†’å‡ºæ¥ä¸€ä¸ªæœ€å¤§æ•°å­—ï¼Œè¿™æ ·æœ‰2å±‚å¾ªç¯å³å¯ï¼Œå¤–å±‚å¾ªç¯å®Œåï¼Œæ‰€æœ‰çš„æ•°å­—å°±å†’å®Œäº†ã€‚ ä»£ç å®ç°ï¼ˆjavaï¼‰ public class MPTest { public static void main(String[] args) { int [] numbers={3,9,6,2}; int temp=0; for(int i=0;i&lt;numbers.length-1;i++){ for(int j=0;j&lt;numbers.length-1-i;j++){ï¼/å†…å±‚å¾ªç¯ä¸€æ¬¡å†’æ³¡å‡ºä¸€ä¸ªæ¯”è¾ƒå°çš„æ•°ä¸Šæ¥ if(numbers[j]&gt;numbers[j+1]){//å¦‚æœç¬¬ä¸€ä¸ªæ•°å­—æ¯”ç¬¬äºŒä¸ªå¤§åˆ™äº¤æ¢ä½ç½® temp=numbers[j]; numbers[j]=numbers[j+1]; numbers[j+1]=temp; } } } for(int i=0;i&lt;numbers.length;i++){ System.out.println(&quot;ç¬¬&quot;+i+&quot;ä¸ªæ•°å­—æ˜¯ï¼š&quot;+numbers[i]); } } } è¾“å‡ºç»“æœæ˜¯ï¼š ç¬¬0ä¸ªæ•°å­—æ˜¯ï¼š2 ç¬¬1ä¸ªæ•°å­—æ˜¯ï¼š3 ç¬¬2ä¸ªæ•°å­—æ˜¯ï¼š6 ç¬¬3ä¸ªæ•°å­—æ˜¯ï¼š9 äºŒé€‰æ‹©æ’åº åŸç†åˆ†æ é€‰æ‹©æ’åºå…¶å®å…¶å®æ€è·¯ä¹Ÿæ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œä¹Ÿæ˜¯2å±‚å¾ªç¯ã€‚ ä¸»è¦æ€è·¯æ˜¯è®°å½•ä¸€ä¸ªæœ€å°å€¼ï¼Œç„¶åå†…å±‚å¾ªç¯å¦‚æœæœ‰æ¯”å®ƒå°çš„å°±è·Ÿè¿™ä¸ªæœ€å°å€¼äº¤æ¢ä½ç½®ï¼Œè¿™æ ·å°±èƒ½ç¡®å®šç¬¬ä¸€ä½æœ€å°å€¼ï¼Œç„¶åç¬¬äºŒæ¬¡å¾ªç¯ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä»¥æ­¤ç±»æ¨å°±èƒ½æŒ‰ç…§ç”±å°åˆ°å¤§æ’åºã€‚ è¿˜æ˜¯å¯¹è¿™å‡ ä¸ªæ•°å­—è¿›è¡Œæ’åºï¼š3 9 6 2 ç¬¬ä¸€æ¬¡å¾ªç¯ï¼š2 9 6 3 ç¬¬äºŒæ¬¡å¾ªç¯ï¼š2 3 6 9 ä»£ç å®ç°ï¼ˆjavaï¼‰ public class XZTest { public static void main(String[] args) { int[] numbers = {3, 9, 6, 2}; int temp=0; for (int i = 0; i &lt; numbers.length; i++) { int min = i; for (int j = i + 1; j &lt; numbers.length; j++) { if(numbers[j]&lt; numbers[min]){ min=j; } } if(i!=min){ temp=numbers[i]; numbers[i]=numbers[min]; numbers[min]=temp; } } for(int i=0;i&lt;numbers.length;i++){ System.out.println(&quot;ç¬¬&quot;+i+&quot;ä¸ªæ•°å­—æ˜¯ï¼š&quot;+numbers[i]); } } } è¾“å‡ºç»“æœæ˜¯ä¸€æ ·å¯¹ï¼š ç¬¬0ä¸ªæ•°å­—æ˜¯ï¼š2 ç¬¬1ä¸ªæ•°å­—æ˜¯ï¼š3 ç¬¬2ä¸ªæ•°å­—æ˜¯ï¼š6 ç¬¬3ä¸ªæ•°å­—æ˜¯ï¼š9 ","link":"http://xuanguofeng.com/post/Javaå¸¸ç”¨æ’åºç®—æ³•å†’æ³¡æ’åºä¸é€‰æ‹©æ’åºæ€»ç»“/"},{"title":"Material Designé£æ ¼è¾“å…¥æ ·å¼TextInputLayoutä½¿ç”¨","content":"TextInputLayoutæ˜¯GoogleåŸºäºMaterial Designé£æ ¼å‡ºç°çš„ä¸€ä¸ªæ–‡æœ¬è¾“å…¥å¸ƒå±€ã€‚ä¸»è¦ç‰¹ç‚¹åœ¨æ ·å¼ä¸Šï¼Œå®˜æ–¹ç¬¬ä¸€å¥ä»‹ç»æ˜¯å½“è¾“å…¥çš„æ–‡æœ¬æ˜¾ç¤ºæˆ–è€…éšè—çš„æ—¶å€™ï¼ŒEditTextæ˜¾ç¤ºæµ®åŠ¨æ ‡ç­¾çš„å¸ƒå±€ã€‚ å…ˆçœ‹çœ‹æ ·å¼ æ ·å¼å…¶å®æ˜¯æœ‰åŠ¨ç”»æ•ˆæœçš„ ä½¿ç”¨æ–¹æ³• å¼•å…¥åŒ…ç¯å¢ƒ ç”±äºè¿™ä¸ªæ§ä»¶åœ¨è¿™ä¸ªandroid.support.design.widgetåŒ…ä¸‹ï¼Œæ‰€ä»¥è¦æŸ¥çœ‹æ˜¯å¦å·²ç»å¼•å…¥äº†: compile â€˜com.android.support:design:22.2.0â€™ compile â€˜com.android.support:appcompat-v7:22.2.0â€™ ç‰ˆæœ¬å¯æ ¹æ®éœ€æ±‚è‡ªè¡Œè°ƒæ•´ åœ¨å¸ƒå±€ä¸­åŠ å…¥ä»£ç  &lt;android.support.design.widget.TextInputLayout android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;wrap_content&quot;&gt; &lt;android.support.design.widget.TextInputEditText android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;wrap_content&quot; android:hint=&quot;@string/form_username&quot;/&gt; &lt;/android.support.design.widget.TextInputLayout&gt; æ ·å¼ä¿®æ”¹ å°†é»˜è®¤çš„AppThemeä¸»ä½“æ·»åŠ å¦‚ä¸‹å±æ€§ &lt;item name=&quot;android:textColorHint&quot;&gt;@colorcommonTextColorWhite&lt;/item&gt; &lt;item name=&quot;colorControlNormal&quot;&gt;@colorcommonTextColorWhite&lt;/item&gt; &lt;item name=&quot;colorControlActivated&quot;&gt;@colorcommonTextColorWhite&lt;/item&gt; &lt;item name=&quot;colorControlHighlight&quot;&gt;@colorcommonTextColorWhite&lt;/item&gt; è§£é‡Šï¼š å±æ€§ å«ä¹‰ android:textColorHint æç¤ºå­—ä½“çš„é¢œè‰² colorControlNormal ä¸‹åˆ’çº¿æ²¡æœ‰è·å–ç„¦ç‚¹ï¼Œä¹Ÿå°±æ˜¯é»˜è®¤çš„é¢œè‰² colorControlActivated ç‚¹å‡»æ—¶ä¸‹åˆ’çº¿çš„é¢œè‰² è®¡æ•°å™¨åŠŸèƒ½ ä½¿ç”¨ TextInputLayoutè¿˜å®ç°äº†è¾“å…¥æ—¶å€™è®°å½•è¾“å…¥å­—ç¬¦æ•°çš„åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®å‚æ•°å®ç°,å¯¼å…¥å¦‚ä¸‹ç¯å¢ƒ xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot; æ·»åŠ å¦‚ä¸‹å±æ€§ app:counterEnabled=&quot;true&quot; app:counterMaxLength=&quot;11&quot; app:counterTextAppearance=&quot;@style/text_style&quot; å±æ€§ å«ä¹‰ app:counterEnabled æ˜¯å¦å¼€å¯æ­¤åŠŸèƒ½ app:counterMaxLength è®¡æ•°å™¨é™åˆ¶çš„æœ€å¤§å€¼ app:counterTextAppearance è®¡æ•°å™¨çš„å­—ä½“æ ·å¼ é”™è¯¯æç¤ºåŠŸèƒ½ TextInputLayoutè¿˜æœ‰ä¸ªé”™è¯¯æç¤ºçš„åŠŸèƒ½ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡apiä½¿ç”¨ã€‚ æ·»åŠ å¦‚ä¸‹ä»£ç  app:errorEnabled=&quot;true&quot; app:errorTextAppearance=&quot;@style/error_text_style&quot; åœ¨javaä»£ç ä¸­è®¾ç½® textInputLayout.setError(&quot;è¿™æ˜¯textInputLayoutçš„é”™è¯¯æç¤º&quot;); mobile.setError(&quot;è¿™æ˜¯EditTextçš„é”™è¯¯æç¤º&quot;); å¯†ç å¯è§†åŠŸèƒ½ å°†inputTypeçš„ç±»å‹è®¾ç½®ä¸ºpasswordä¹‹åï¼Œå¯ä»¥é€šè¿‡è®¾ç½®å¦‚ä¸‹å±æ€§ã€‚è€Œä¸”é»˜è®¤æ•ˆæœæ”¯æŒMaterial Designæ•ˆæœå’Œé»˜è®¤åŠ¨ç”»ï¼Œä¹Ÿæ˜¯é…·é…·çš„ã€‚ app:passwordToggleEnabled=&quot;true&quot; app:passwordToggleTint=&quot;@color/colorAccent&quot; å±æ€§ å«ä¹‰ app: passwordToggleEnabled æ˜¯å¦å¼€å¯å¯†ç å¯è§†çš„åŠŸèƒ½ app: passwordToggleTint ä¿®æ”¹æç¤ºå›¾æ ‡çš„é¢œè‰² æ€»ç»“ googleç»§Android5.0åå‡ºäº†ä¸€ç³»åˆ—Material Designé£æ ¼çš„æ§ä»¶ï¼Œä¹Ÿå¼•èµ·äº†éƒ¨åˆ†webç«¯ä¸Androidç«¯çš„çš„Material Designé£æ ¼åŒ–ã€‚ä¸ªäººè®¤ä¸ºè¿™ä¹Ÿæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„è®¾è®¡è¯­è¨€ã€‚å¦‚æœåˆ©ç”¨çš„å¥½ï¼Œå°†ä¼šå¯¹APPçš„äº¤äº’å¾ˆæœ‰åˆ©ã€‚ ","link":"http://xuanguofeng.com/post/Designé£æ ¼æ–‡æœ¬è¾“å…¥æ ·å¼TextInputLayoutçš„ä½¿ç”¨ (xuanguoengdeMBP çš„å†²çªå‰¯æœ¬ 2020-03-17)/"},{"title":"Material Designé£æ ¼è¾“å…¥æ ·å¼TextInputLayoutä½¿ç”¨","content":"TextInputLayoutæ˜¯GoogleåŸºäºMaterial Designé£æ ¼å‡ºç°çš„ä¸€ä¸ªæ–‡æœ¬è¾“å…¥å¸ƒå±€ã€‚ä¸»è¦ç‰¹ç‚¹åœ¨æ ·å¼ä¸Šï¼Œå®˜æ–¹ç¬¬ä¸€å¥ä»‹ç»æ˜¯å½“è¾“å…¥çš„æ–‡æœ¬æ˜¾ç¤ºæˆ–è€…éšè—çš„æ—¶å€™ï¼ŒEditTextæ˜¾ç¤ºæµ®åŠ¨æ ‡ç­¾çš„å¸ƒå±€ã€‚ å…ˆçœ‹çœ‹æ ·å¼ æ ·å¼å…¶å®æ˜¯æœ‰åŠ¨ç”»æ•ˆæœçš„ ä½¿ç”¨æ–¹æ³• å¼•å…¥åŒ…ç¯å¢ƒ ç”±äºè¿™ä¸ªæ§ä»¶åœ¨è¿™ä¸ªandroid.support.design.widgetåŒ…ä¸‹ï¼Œæ‰€ä»¥è¦æŸ¥çœ‹æ˜¯å¦å·²ç»å¼•å…¥äº†: compile â€˜com.android.support:design:22.2.0â€™ compile â€˜com.android.support:appcompat-v7:22.2.0â€™ ç‰ˆæœ¬å¯æ ¹æ®éœ€æ±‚è‡ªè¡Œè°ƒæ•´ åœ¨å¸ƒå±€ä¸­åŠ å…¥ä»£ç  &lt;android.support.design.widget.TextInputLayout android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;wrap_content&quot;&gt; &lt;android.support.design.widget.TextInputEditText android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;wrap_content&quot; android:hint=&quot;@string/form_username&quot;/&gt; &lt;/android.support.design.widget.TextInputLayout&gt; æ ·å¼ä¿®æ”¹ å°†é»˜è®¤çš„AppThemeä¸»ä½“æ·»åŠ å¦‚ä¸‹å±æ€§ &lt;item name=&quot;android:textColorHint&quot;&gt;@colorcommonTextColorWhite&lt;/item&gt; &lt;item name=&quot;colorControlNormal&quot;&gt;@colorcommonTextColorWhite&lt;/item&gt; &lt;item name=&quot;colorControlActivated&quot;&gt;@colorcommonTextColorWhite&lt;/item&gt; &lt;item name=&quot;colorControlHighlight&quot;&gt;@colorcommonTextColorWhite&lt;/item&gt; è§£é‡Šï¼š å±æ€§ å«ä¹‰ android:textColorHint æç¤ºå­—ä½“çš„é¢œè‰² colorControlNormal ä¸‹åˆ’çº¿æ²¡æœ‰è·å–ç„¦ç‚¹ï¼Œä¹Ÿå°±æ˜¯é»˜è®¤çš„é¢œè‰² colorControlActivated ç‚¹å‡»æ—¶ä¸‹åˆ’çº¿çš„é¢œè‰² è®¡æ•°å™¨åŠŸèƒ½ ä½¿ç”¨ TextInputLayoutè¿˜å®ç°äº†è¾“å…¥æ—¶å€™è®°å½•è¾“å…¥å­—ç¬¦æ•°çš„åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®å‚æ•°å®ç°,å¯¼å…¥å¦‚ä¸‹ç¯å¢ƒ xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot; æ·»åŠ å¦‚ä¸‹å±æ€§ app:counterEnabled=&quot;true&quot; app:counterMaxLength=&quot;11&quot; app:counterTextAppearance=&quot;@style/text_style&quot; å±æ€§ å«ä¹‰ app:counterEnabled æ˜¯å¦å¼€å¯æ­¤åŠŸèƒ½ app:counterMaxLength è®¡æ•°å™¨é™åˆ¶çš„æœ€å¤§å€¼ app:counterTextAppearance è®¡æ•°å™¨çš„å­—ä½“æ ·å¼ é”™è¯¯æç¤ºåŠŸèƒ½ TextInputLayoutè¿˜æœ‰ä¸ªé”™è¯¯æç¤ºçš„åŠŸèƒ½ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡apiä½¿ç”¨ã€‚ æ·»åŠ å¦‚ä¸‹ä»£ç  app:errorEnabled=&quot;true&quot; app:errorTextAppearance=&quot;@style/error_text_style&quot; åœ¨javaä»£ç ä¸­è®¾ç½® textInputLayout.setError(&quot;è¿™æ˜¯textInputLayoutçš„é”™è¯¯æç¤º&quot;); mobile.setError(&quot;è¿™æ˜¯EditTextçš„é”™è¯¯æç¤º&quot;); å¯†ç å¯è§†åŠŸèƒ½ å°†inputTypeçš„ç±»å‹è®¾ç½®ä¸ºpasswordä¹‹åï¼Œå¯ä»¥é€šè¿‡è®¾ç½®å¦‚ä¸‹å±æ€§ã€‚è€Œä¸”é»˜è®¤æ•ˆæœæ”¯æŒMaterial Designæ•ˆæœå’Œé»˜è®¤åŠ¨ç”»ï¼Œä¹Ÿæ˜¯é…·é…·çš„ã€‚ app:passwordToggleEnabled=&quot;true&quot; app:passwordToggleTint=&quot;@color/colorAccent&quot; å±æ€§ å«ä¹‰ app: passwordToggleEnabled æ˜¯å¦å¼€å¯å¯†ç å¯è§†çš„åŠŸèƒ½ app: passwordToggleTint ä¿®æ”¹æç¤ºå›¾æ ‡çš„é¢œè‰² æ€»ç»“ googleç»§Android5.0åå‡ºäº†ä¸€ç³»åˆ—Material Designé£æ ¼çš„æ§ä»¶ï¼Œä¹Ÿå¼•èµ·äº†éƒ¨åˆ†webç«¯ä¸Androidç«¯çš„çš„Material Designé£æ ¼åŒ–ã€‚ä¸ªäººè®¤ä¸ºè¿™ä¹Ÿæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„è®¾è®¡è¯­è¨€ã€‚å¦‚æœåˆ©ç”¨çš„å¥½ï¼Œå°†ä¼šå¯¹APPçš„äº¤äº’å¾ˆæœ‰åˆ©ã€‚ ","link":"http://xuanguofeng.com/post/Designé£æ ¼æ–‡æœ¬è¾“å…¥æ ·å¼TextInputLayoutçš„ä½¿ç”¨/"},{"title":"å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨-android StudioæŠ€å·§ä¸æ’ä»¶","content":"æœ¬ç« æ˜¯æ€»ç»“Android Studioçš„æŠ€å·§ä¸æ’ä»¶ï¼Œä¿—è¯è¯´å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ï¼Œå¯¹Android Studioä½¿ç”¨çš„å¾—å¿ƒåº”æ‰‹çš„è¯ï¼Œå°†ä¼šå¤§å¤§æå‡å·¥ä½œæ•ˆç‡ä¸å¼€å‘æ•ˆç‡ã€‚ Android Studioå¸¸ç”¨æŠ€å·§ å¤šçª—å£æ‹†åˆ†å¼€å‘ åº”ç”¨åœºæ™¯ï¼šä¾‹å¦‚å¼€å‘Activityè¦å‚è€ƒxmlæˆ–è€…éœ€è¦åŒæ—¶ç¼–å†™String.xmlæ–‡ä»¶çš„æ—¶å€™ã€‚å¯ä»¥æ‹†åˆ†æ¨ªå‘ã€çºµå‘ã€‚ ä½¿ç”¨æ–¹å¼ï¼šèœå•æ ---&gt;window---&gt;Editor Tabs---&gt;Split Horizontally(æ¨ªå‘) æŸ¥çœ‹ä¸€ä¸ªç±»çš„çš„ç»“æ„ åº”ç”¨åœºæ™¯ï¼šæœ‰æ—¶å€™éœ€è¦æŸ¥çœ‹è¿™ä¸ªç±»çš„å¤§æ¦‚ç»“æ„æ–¹æ³•ç­‰ã€‚ ä½¿ç”¨æ–¹å¼:å¿«æ·é”® mac:commmand+F12 win:ctrl+F12 æŸ¥çœ‹ä¸€ä¸ªæ–¹æ³•è¢«å“ªé‡Œè°ƒç”¨ å¿«æ·é”®ï¼šMac: option+ f7 win: alt+f7 æˆ–è€…å•å‡»å³é”®é€‰æ‹© find usages åœºæ™¯ï¼šä¸è§£é‡Šäº†åº”è¯¥å¾ˆå¸¸ç”¨ æŸ¥çœ‹ä¸€ä¸ªæ–¹æ³•æè¿°æ³¨é‡Š å¿«æ·é”®ï¼š mac: f1 å°†ä»£ç æ·»åŠ ä¹¦ç­¾ åœºæ™¯ï¼šç»å¸¸ä¼šéœ€è¦è®°ä¸‹è¿™ä¸ªä½ç½®ä»£ç ä»¥åæ–¹ä¾¿æ—¶æŸ¥çœ‹ã€‚ å¿«æ·é”® ï¼šmac :f3 win : f11 Android Studio ä»£ç åˆ†æåŠŸèƒ½ ä½¿ç”¨åœºæ™¯ï¼šgoogleå»ºè®®çš„ä»£ç ï¼Œåº”è¯¥ä¸ä¼šå¤ªå·®å§ã€‚ ä½¿ç”¨æ–¹å¼ï¼šèœå•æ ----&gt;Analyze----&gt;Inspect Code ä¼šæœ‰äº›å»ºè®®æ€§çš„æç¤ºã€‚ ä»£ç æ¨¡æ¿ ä½¿ç”¨åœºæ™¯ï¼šæœ‰äº›ä»£ç æ˜¯ç»å¸¸ä½¿ç”¨åˆ°çš„æ ¼å¼ï¼Œå¤ç”¨æ€§å¾ˆå¼ºã€‚ ä¾‹å¦‚ï¼šåˆ¤ç©ºï¼Œå¾ªç¯ï¼Œå¿«é€Ÿç¼–å†™swichç­‰ã€‚ ####é¢„è§ˆæ–¹æ³•å®šä¹‰ åœºæ™¯ï¼šæœ‰æ—¶å€™æƒ³çœ‹ä¸€ä¸ªæ–¹æ³•æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œä¼šå¿«é€Ÿå¼¹å‡ºä¸€ä¸ªæ¡†ã€‚ å¿«æ·é”®ï¼šmac: command+Y ####ç»™æ–­ç‚¹è®¾ç½®æ¡ä»¶ ä¾‹å¦‚ï¼šforå¾ªç¯åªæƒ³=5çš„æ—¶å€™æ‰“æ–­ç‚¹ å•å‡»æ–­ç‚¹å³é”®æ—¢å¯ä»¥è®¾ç½®æ¡ä»¶ã€‚ ####è¿è¡Œè¿‡ç¨‹ä¸­å¿«é€Ÿæ–­ç‚¹ ä¾‹å¦‚ï¼šappæ­£åœ¨è¿è¡Œï¼Œå‡ºç°bugä¸æƒ³é‡æ–°è·‘é¡¹ç›®çš„æ—¶å€™ã€‚ ####å¿«é€ŸæŸ¥çœ‹æ–¹æ³•è¯¦æƒ… command+B ####æŸ¥æ‰¾å‚æ•°å®šä¹‰ä¸æ–‡æ¡£ command +P Android Studioå¸¸ç”¨æ’ä»¶ Translation å¿«é€Ÿç¿»è¯‘ è®¾ç½®å¿«æ·é”®å¯ä»¥ç›´æ¥ç¿»è¯‘åŒ…æ‹¬logï¼Œè‹±æ±‰ æ±‰è‹±ã€‚ ADB WIFI å¯ä»¥æ— çº¿è°ƒè¯•çš„ä¸€ä¸ªæ’ä»¶ GsonFormat å¿«é€Ÿå®ç°beanç±»ã€‚ ","link":"http://xuanguofeng.com/post/å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨-android StudioæŠ€å·§ä¸æ’ä»¶ (xuanguoengdeMBP çš„å†²çªå‰¯æœ¬ 2020-03-17)/"},{"title":"å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨-android StudioæŠ€å·§ä¸æ’ä»¶","content":"æœ¬ç« æ˜¯æ€»ç»“Android Studioçš„æŠ€å·§ä¸æ’ä»¶ï¼Œä¿—è¯è¯´å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ï¼Œå¯¹Android Studioä½¿ç”¨çš„å¾—å¿ƒåº”æ‰‹çš„è¯ï¼Œå°†ä¼šå¤§å¤§æå‡å·¥ä½œæ•ˆç‡ä¸å¼€å‘æ•ˆç‡ã€‚ Android Studioå¸¸ç”¨æŠ€å·§ å¤šçª—å£æ‹†åˆ†å¼€å‘ åº”ç”¨åœºæ™¯ï¼šä¾‹å¦‚å¼€å‘Activityè¦å‚è€ƒxmlæˆ–è€…éœ€è¦åŒæ—¶ç¼–å†™String.xmlæ–‡ä»¶çš„æ—¶å€™ã€‚å¯ä»¥æ‹†åˆ†æ¨ªå‘ã€çºµå‘ã€‚ ä½¿ç”¨æ–¹å¼ï¼šèœå•æ ---&gt;window---&gt;Editor Tabs---&gt;Split Horizontally(æ¨ªå‘) æŸ¥çœ‹ä¸€ä¸ªç±»çš„çš„ç»“æ„ åº”ç”¨åœºæ™¯ï¼šæœ‰æ—¶å€™éœ€è¦æŸ¥çœ‹è¿™ä¸ªç±»çš„å¤§æ¦‚ç»“æ„æ–¹æ³•ç­‰ã€‚ ä½¿ç”¨æ–¹å¼:å¿«æ·é”® mac:commmand+F12 win:ctrl+F12 æŸ¥çœ‹ä¸€ä¸ªæ–¹æ³•è¢«å“ªé‡Œè°ƒç”¨ å¿«æ·é”®ï¼šMac: option+ f7 win: alt+f7 æˆ–è€…å•å‡»å³é”®é€‰æ‹© find usages åœºæ™¯ï¼šä¸è§£é‡Šäº†åº”è¯¥å¾ˆå¸¸ç”¨ æŸ¥çœ‹ä¸€ä¸ªæ–¹æ³•æè¿°æ³¨é‡Š å¿«æ·é”®ï¼š mac: f1 å°†ä»£ç æ·»åŠ ä¹¦ç­¾ åœºæ™¯ï¼šç»å¸¸ä¼šéœ€è¦è®°ä¸‹è¿™ä¸ªä½ç½®ä»£ç ä»¥åæ–¹ä¾¿æ—¶æŸ¥çœ‹ã€‚ å¿«æ·é”® ï¼šmac :f3 win : f11 Android Studio ä»£ç åˆ†æåŠŸèƒ½ ä½¿ç”¨åœºæ™¯ï¼šgoogleå»ºè®®çš„ä»£ç ï¼Œåº”è¯¥ä¸ä¼šå¤ªå·®å§ã€‚ ä½¿ç”¨æ–¹å¼ï¼šèœå•æ ----&gt;Analyze----&gt;Inspect Code ä¼šæœ‰äº›å»ºè®®æ€§çš„æç¤ºã€‚ ä»£ç æ¨¡æ¿ ä½¿ç”¨åœºæ™¯ï¼šæœ‰äº›ä»£ç æ˜¯ç»å¸¸ä½¿ç”¨åˆ°çš„æ ¼å¼ï¼Œå¤ç”¨æ€§å¾ˆå¼ºã€‚ ä¾‹å¦‚ï¼šåˆ¤ç©ºï¼Œå¾ªç¯ï¼Œå¿«é€Ÿç¼–å†™swichç­‰ã€‚ ####é¢„è§ˆæ–¹æ³•å®šä¹‰ åœºæ™¯ï¼šæœ‰æ—¶å€™æƒ³çœ‹ä¸€ä¸ªæ–¹æ³•æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œä¼šå¿«é€Ÿå¼¹å‡ºä¸€ä¸ªæ¡†ã€‚ å¿«æ·é”®ï¼šmac: command+Y ####ç»™æ–­ç‚¹è®¾ç½®æ¡ä»¶ ä¾‹å¦‚ï¼šforå¾ªç¯åªæƒ³=5çš„æ—¶å€™æ‰“æ–­ç‚¹ å•å‡»æ–­ç‚¹å³é”®æ—¢å¯ä»¥è®¾ç½®æ¡ä»¶ã€‚ ####è¿è¡Œè¿‡ç¨‹ä¸­å¿«é€Ÿæ–­ç‚¹ ä¾‹å¦‚ï¼šappæ­£åœ¨è¿è¡Œï¼Œå‡ºç°bugä¸æƒ³é‡æ–°è·‘é¡¹ç›®çš„æ—¶å€™ã€‚ ####å¿«é€ŸæŸ¥çœ‹æ–¹æ³•è¯¦æƒ… command+B ####æŸ¥æ‰¾å‚æ•°å®šä¹‰ä¸æ–‡æ¡£ command +P Android Studioå¸¸ç”¨æ’ä»¶ Translation å¿«é€Ÿç¿»è¯‘ è®¾ç½®å¿«æ·é”®å¯ä»¥ç›´æ¥ç¿»è¯‘åŒ…æ‹¬logï¼Œè‹±æ±‰ æ±‰è‹±ã€‚ ADB WIFI å¯ä»¥æ— çº¿è°ƒè¯•çš„ä¸€ä¸ªæ’ä»¶ GsonFormat å¿«é€Ÿå®ç°beanç±»ã€‚ ","link":"http://xuanguofeng.com/post/å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨-android StudioæŠ€å·§ä¸æ’ä»¶/"},{"title":"Androidæ²‰æµ¸å¼çŠ¶æ€æ æ–¹æ³•æ€»ç»“","content":"ä¸ºä»€ä¹ˆç”¨æ²‰æµ¸å¼çŠ¶æ€æ ï¼Ÿ ä¹Ÿä¸çŸ¥é“ä»ä»€ä¹ˆæ—¶å€™å¼€å§‹å¤§éƒ¨åˆ†çš„Appå·²ç»å…¨éƒ¨å‘æ²‰æµ¸å¼çŠ¶æ€æ é æ‹¢ï¼Œè¿™ç§æ•ˆæœåº”è¯¥æ˜¯æƒ³è®©æœ€é¡¶éƒ¨çš„çŠ¶æ€æ å’Œé¡¹ç›®çš„æ ‡é¢˜æ è¿‡æ¸¡æ¯”è¾ƒèå’Œå§ã€‚ ä¸è¿‡æ²‰æµ¸å¼çŠ¶æ€æ è¿™ç§å«æ³•å¯èƒ½ä¸å¤ªå¦¥å½“ã€‚ æœ¬ç¯‡æ–‡ç« å‚è€ƒéƒ­éœ–çš„åšå®¢ã€‚ éƒ­éœ–åšå®¢åœ°å€ï¼šAndroidçŠ¶æ€æ å¾®æŠ€å·§ï¼Œå¸¦ä½ çœŸæ­£ç†è§£æ²‰æµ¸å¼æ¨¡å¼ ç¬¬ä¸€ç§å®ç°æ–¹å¼ å…¶å®ä¸»è¦å®ç°çš„å°±æ˜¯é¡¶éƒ¨çŠ¶æ€æ å’Œtoolbarçš„é¢œè‰²ä¸€è‡´è¾¾åˆ°æ•ˆæœã€‚ &lt;resources&gt; &lt;!-- Base application theme. --&gt; &lt;style name=&quot;AppTheme&quot; parent=&quot;Theme.AppCompat.Light.DarkActionBar&quot;&gt; &lt;!-- Customize your theme here. --&gt; &lt;item name=&quot;colorPrimary&quot;&gt;@color/colorPrimary&lt;/item&gt; &lt;item name=&quot;colorPrimaryDark&quot;&gt;@color/colorPrimaryDark&lt;/item&gt; &lt;item name=&quot;colorAccent&quot;&gt;@color/colorAccent&lt;/item&gt; &lt;/style&gt; &lt;/resources&gt; å…¶ä¸­ colorPrimaryDarkè¿™ä¸ªå‚æ•°å°±æ˜¯è®¾ç½®çŠ¶æ€æ çš„é¢œè‰²ï¼Œè®¾ç½®çŠ¶æ€æ å’Œtoolbaræˆ–è€…è‡ªå®šä¹‰çš„æ ‡é¢˜æ é¢œè‰²ä¸€è‡´çš„è¯ä¼šæ˜¾ç¤º ç¬¬äºŒç§å®ç°æ–¹å¼ ç¬¬äºŒç§å®ç°æ–¹å¼æ˜¯æŠŠä¸»é¢˜å¸ƒå±€å¾€ä¸Šç§»åŠ¨ï¼ŒæŠŠå¸ƒå±€ä»å±å¹•çš„å·¦ä¸Šè§’å¼€å§‹è®¡ç®—ã€‚æ‰€ä»¥è¿™ç§æ–¹å¼éœ€è¦æ³¨æ„ï¼ŒæŠŠé¡¶éƒ¨çŠ¶æ€æ çš„é«˜åº¦è¦è®¡ç®—åœ¨å‡ºæ¥ã€‚ if (Build.VERSION.SDK_INT &gt;= 21) { View decorView = getWindow().getDecorView(); int option = View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN | View.SYSTEM_UI_FLAG_LAYOUT_STABLE; decorView.setSystemUiVisibility(option); getWindow().setStatusBarColor(Color.TRANSPARENT); } //éšè—æ ‡é¢˜æ  ActionBar actionBar = getSupportActionBar(); actionBar.hide(); ç¬¬ä¸‰ç§å®ç°æ–¹å¼ ç¬¬ä¸‰ç§è¡¨é¢çœ‹æ¥æ˜¯å…¨å±çš„æ–¹å¼ï¼Œç„¶åå¯ä»¥é€šè¿‡æ»‘åŠ¨é¡¶éƒ¨æ¥å®ç°çŠ¶æ€æ çš„å¼¹å‡ºï¼Œç„¶åä¼šè‡ªåŠ¨éšè—æ‰ã€‚è¿™ç§æ¨¡å¼ä¹Ÿæ˜¯çœŸæ­£æ„ä¹‰çš„æ²‰æµ¸å¼çŠ¶æ€æ ã€‚ gitæ•ˆæœï¼šhttp://note.youdao.com/share/?id=fdc645c84ad9cd4e4ba0841b116a703c&amp;type=note#/ å®ç°æ–¹å¼ï¼šåœ¨Activityä¸­å®ç°å¦‚ä¸‹æ–¹æ³• @Override public void onWindowFocusChanged(boolean hasFocus) { super.onWindowFocusChanged(hasFocus); if (hasFocus &amp;&amp; Build.VERSION.SDK_INT &gt;= 19) { View decorView = getWindow().getDecorView(); decorView.setSystemUiVisibility( View.SYSTEM_UI_FLAG_LAYOUT_STABLE | View.SYSTEM_UI_FLAG_LAYOUT_HIDE_NAVIGATION | View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN | View.SYSTEM_UI_FLAG_HIDE_NAVIGATION | View.SYSTEM_UI_FLAG_FULLSCREEN | View.SYSTEM_UI_FLAG_IMMERSIVE_STICKY); } } ","link":"http://xuanguofeng.com/post/Androidæ²‰æµ¸å¼çŠ¶æ€æ æ–¹æ³•æ€»ç»“/"},{"title":"Androidä¸­åˆ›å»ºsoåº“å­˜å‚¨å¯†é’¥ï¼ŒNDKç¯å¢ƒæ­å»ºä¸jniä»‹ç»","content":"ä»‹ç» soåº“ä»‹ç»ï¼šAndroidå¼€å‘ä¸­ç»å¸¸ä¼šè§åˆ°jinLibsæ–‡ä»¶å¤¹ä¸‹çš„soåº“æ–‡ä»¶ï¼Œå°±ç®—ç”¨ç¬¬ä¸‰æ–¹çš„sdkä¹Ÿä¼šç»å¸¸çœ‹åˆ°soåº“ï¼Œsoåº“æ˜¯ä¸€ä¸ªç”¨c/c++è¯­è¨€äº›çš„å‡½æ•°åº“ã€‚Androidä¸­å¯ä»¥ç”¨è¿‡ä½¿ç”¨jniçš„æ–¹å¼æ¥è°ƒå–soåº“ã€‚åœ¨æŸäº›æ–¹é¢soå‡½æ•°åº“å¯èƒ½ä¼šæ›´é«˜æ•ˆæ›´å®‰å…¨ã€‚ JNIä»‹ç»ï¼šJava Native Interfaceï¼Œå®ƒæ˜¯Javaå¹³å°çš„ä¸€ä¸ªç‰¹æ€§(å¹¶ä¸æ˜¯Androidç³»ç»Ÿç‰¹æœ‰çš„)ã€‚å…¶å®ä¸»è¦æ˜¯å®šä¹‰äº†ä¸€äº›JNIå‡½æ•°ï¼Œè®©å¼€å‘è€…å¯ä»¥é€šè¿‡è°ƒç”¨è¿™äº›å‡½æ•°å®ç°Javaä»£ç è°ƒç”¨C/C++çš„ä»£ç ï¼ŒC/C++çš„ä»£ç ä¹Ÿå¯ä»¥è°ƒç”¨Javaçš„ä»£ç ï¼ŒJNIä¹Ÿæœ‰äº›è‡ªå·±çš„è¯­æ³•å’Œå‡½æ•°ã€‚ NDKä»‹ç»ï¼šNDKæ˜¯ä¸€ç³»åˆ—å·¥å…·çš„é›†åˆã€‚å®ƒæä¾›äº†ä¸€ç³»åˆ—çš„å·¥å…·ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿå¼€å‘Cï¼ˆæˆ–C++ï¼‰çš„åŠ¨æ€åº“ï¼Œå¹¶èƒ½è‡ªåŠ¨å°†soå’Œjavaåº”ç”¨ä¸€èµ·æ‰“åŒ…æˆapkã€‚ä»¥ä¸‹æ˜¯googleå®˜æ–¹å¯¹äºNDKçš„ä»‹ç» The Native Development Kit (NDK) is a set of tools that allows you to use C and C++ code with Android, and provides platform libraries you can use to manage native activities and access physical device components, such as sensors and touch input. The NDK may not be appropriate for most novice Android programmers who need to use only Java code and framework APIs to develop their apps. However, the NDK can be useful for cases in which you need to do one or more of the following: Squeeze extra performance out of a device to achieve low latency or run computationally intensive applications, such as games or physics simulations. Reuse your own or other developers' C or C++ libraries. åœ¨AndroidStudioä¸­é…ç½®NDKç¯å¢ƒ 1.ä¸‹è½½ ä¹Ÿå¯ä»¥ç›´æ¥åœ¨å®˜æ–¹ç½‘ç«™ä¸‹è½½zipä¸è¿‡éœ€è¦ç§‘å­¦ä¸Šç½‘å“¦ï¼ å®˜ç½‘åœ°å€ï¼šhttps://developer.android.com/ndk/downloads/index.html local.propertiesæ–‡ä»¶ä¸­å‡ºç°ndk.diråˆ™é…ç½®æˆåŠŸã€‚ 2.é…ç½®gradle.propertiesæ–‡ä»¶ï¼Œæ·»åŠ android.useDeprecatedNdk=true è¿™æ ·NDKç¯å¢ƒå°±æ­å»ºokäº†ã€‚ Javaã€C/C++ä»£ç ç¼–å†™ä»¥åŠsoçš„ç”Ÿæˆä¸ä½¿ç”¨ 1.åˆ›å»ºå¯¹åº”çš„javaç±» package com.xuanguofeng.t2_ndk; public class JniUtil { static { //jniutilè¿™ä¸ªå‚æ•°å¯¹åº”ç€cçš„æ–‡ä»¶åï¼Œä»¥åŠåé¢çš„é…ç½®åä»¥åŠsoçš„åº“åç§° System.loadLibrary(&quot;jniutil&quot;); } //c/c++ä¸­è¦å¯¹åº”å®ç°çš„æ–¹æ³•ï¼Œå¿…é¡»å£°æ˜native public native String getKey(String key); } 2.å¯¹é¡¹ç›®è¿›è¡Œç¼–è¯‘ ç¼–è¯‘åå¯¹é¡¹ç›®ä¼šåœ¨æ–‡ä»¶å¤¹ä¸‹å‡ºç°classæ–‡ä»¶ 2.ç”Ÿæˆ.hæ–‡ä»¶ æ‰“å¼€Android Studioçš„Terminalä¹Ÿå¯ä»¥åœ¨å¯¹åº”ç›®å½•çš„å‘½ä»¤çª—å£ä¸­ï¼Œåˆ‡æ¢åˆ°é¡¹ç›®çš„app/src/mainç›®å½•ä¸‹ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š javah -d jni -classpath ç¼–è¯‘åçš„classæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ .hæ–‡ä»¶ä¼šåœ¨appç›®å½•ä¸‹çš„jniæ–‡ä»¶å¤¹ä¸­ï¼Œå¦‚æœåœ¨ä¸åŒçš„ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤ä¼šåœ¨ä¸åŒçš„ç›®å½•ä¸­ç”Ÿæˆjniæ–‡ä»¶å¤¹ 3.ç¼–å†™.c/.cppæ–‡ä»¶ .c/.cppæ–‡ä»¶çš„æ–‡ä»¶åè¦ä¸ä¹‹å‰åœ¨javaç±»ä¸­å®šä¹‰çš„System.loadLibrary(&quot;jniutil&quot;);ä¸­çš„â€œjniutilâ€ä¸€è‡´ã€‚ è¯´æ˜ï¼š.cæ–‡ä»¶å¯¹åº”çš„cè¯­è¨€,.cppå¯¹åº”çš„æ˜¯c++è¯­è¨€ã€‚ #include&quot;com_xuanguofeng_t2_ndk_JniUtil.h&quot; #include&lt;stdio.h&gt; #include&lt;stdlib.h&gt; char *RELEASE_SIGN = &quot;330818b310f300d0660355040a0c0ce7acace4b880e8bda6e7bd9131b7f5d1bd5e607ecdc1d9a0fef8eec91b621d6071a10af23135bd3d7115865f3e5859d8f7d44b78479adeb071f48d91eb162aced5510cddc106734d152c75db1622cfdb935d7213817589d7c4a33f829c9d74ff0dd008caa9f705e30550be64fe22887373644bbb63134ec1aff680171214643cb8d1c7e5...&quot;; char *APK_SIGN_ERROR = &quot;ç­¾åä¸ä¸€è‡´&quot;; char *a = &quot;a&quot;; #... è¿™é‡Œå¯ä»¥å®šä¹‰æ›´å¤šçš„å¹²æ‰°å­—ç¬¦ char *b = &quot;b&quot;; char *c = &quot;c&quot;; char *d = &quot;d&quot;; char *e = &quot;e&quot;; char *f = &quot;f&quot;; char *g = &quot;g&quot;; char *x = &quot;x&quot;; char *y = &quot;y&quot;; char *z = &quot;z&quot;; char *i1 = &quot;1&quot;; char *i2 = &quot;2&quot;; char *i3 = &quot;3&quot;; char *i4 = &quot;4&quot;; char *i5 = &quot;5&quot;; char *i6 = &quot;6&quot;; char *i7 = &quot;7&quot;; char *i8 = &quot;8&quot;; char *i9 = &quot;9&quot;; char *i0 = &quot;0&quot;; JNIEXPORT jstring JNICALL Java_com_xuanguofeng_t2_1ndk_JniUtil_getKey (JNIEnv *env, jobject obj, jstring appkey) { char *rtn = NULL; jclass clsstring = env-&gt;FindClass(&quot;java/lang/String&quot;); jstring strencode = env-&gt;NewStringUTF(&quot;utf-8&quot;); jmethodID mid = env-&gt;GetMethodID(clsstring, &quot;getBytes&quot;, (Ljava/lang/String;)[B&quot;); jbyteArray barr = (jbyteArray) env-&gt;CallObjectMethod(appkey, mid, strencode); jsize alen = env-&gt;GetArrayLength(barr); jbyte *ba = env-&gt;GetByteArrayElements(barr, JNI_FALSE); if (alen &gt; 0) { rtn = (char *) malloc(alen + 1); memcpy(rtn, ba, alen); rtn[alen] = 0; } env-&gt;ReleaseByteArrayElements(barr, ba, 0); if (strcmp(RELEASE_SIGN, rtn) == 0) { char ack[6] = &quot;&quot;; strcat(ack, i1); strcat(ack, i2); strcat(ack, i3); strcat(ack, i4); strcat(ack, i5); strcat(ack, i6); return env-&gt;NewStringUTF(ack); } else { return env-&gt;NewStringUTF(APK_SIGN_ERROR); } } ä»£ç è¯´æ˜ï¼š RELEASE_SIGNæ˜¯å®šä¸€ä¸ªäº†ä¸€ä¸ªkeyçš„å˜é‡ï¼Œè¿™ä¸ªkeyå›ºå®šåœ¨soé‡Œé¢ æ˜¯é€šè¿‡keystoreæ–‡ä»¶ç”Ÿæˆçš„åé¢ä¼šè®²è§£æ–¹æ³•ã€‚åŸå› æ˜¯å¦‚æœç›´æ¥å•çº¯çš„è¿”å›å¯†é’¥ï¼Œæ‹¿åˆ°soä¸€æ ·ä¸æ˜¯é‚£ä¹ˆå®‰å…¨ï¼Œåªæœ‰é€šè¿‡å¯¹åº”çš„ç­¾åæ–‡ä»¶éªŒè¯é€šè¿‡åæ‰ä¼šè¿”å›å…·ä½“çš„å¯†é’¥ã€‚è¿™é‡Œè¿”å›çš„ackå˜é‡åˆ™æ˜¯è¦è¿”å›ç»™javaçš„å¯†é’¥ã€‚ è¯´æ˜ï¼šç”±äºæœ¬æ¬¡ä¸æ€ä¹ˆæ‡‚cæ‰€ä»¥åªæ˜¯é€šè¿‡æŸ¥è¯¢èµ„æ–™ç®€å•çš„å¯¹å¯†é’¥è¿›è¡Œæ‰“ä¹±æ‹¼æ¥ã€‚è¯»è€…å¯è‡ªè¡Œä¼˜åŒ–cç®—æ³•ã€‚å¦‚æœ‰å»ºè®®æˆ–è€…çº æ­£æ¬¢è¿ç•™è¨€ã€‚ 4.åœ¨appç›®å½•ä¸‹çš„build.gradleæ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç  ndk { moduleName &quot;jniutil&quot; abiFilters 'armeabi', 'x86', 'armeabi-v7a' } æ³¨æ„ï¼šæ­¤å¤„çš„moduleNameè¿˜æ˜¯ä¸ä¹‹å‰é…ç½®çš„ System.loadLibrary(&quot;jniutil&quot;); ä¸­çš„jniutilä¸€ç›´ã€‚ 5.åœ¨activityè°ƒç”¨åº“ä¸­çš„æ–¹æ³•ã€‚ package com.xuanguofeng.t2_ndk; import android.content.pm.PackageInfo; import android.content.pm.PackageManager; import android.content.pm.Signature; import android.support.v7.app.AppCompatActivity; import android.os.Bundle;import android.util.Log; import android.widget.TextView; public class MainActivity extends AppCompatActivity { private TextView textView; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); textView= (TextView) findViewById(R.id.text); try { PackageInfo packageInfo = getPackageManager().getPackageInfo(getPackageName(), PackageManager.GET_SIGNATURES); Signature[] signs = packageInfo.signatures; Signature sign = signs[0]; textView.setText(new JniUtil().getKey(sign.toCharsString())); } catch (Exception e) { e.printStackTrace(); } }} ä»£ç è¯´æ˜ï¼š sign.toCharsString()è¿™ä¸ªæ–¹æ³•å°±æ˜¯è·å–keystoreä¸­çš„å€¼æ¥å’Œsoåº“ä¸­çš„è¿›è¡Œæ¯”è¾ƒã€‚å¼€å‘æ—¶å€™debugçš„å’Œæ­£å¼å‘å¸ƒçš„keystoreå€¼æ˜¯ä¸ä¸€æ ·çš„æ‰€ä»¥è¦æ³¨æ„æ›´æ¢ã€‚ è¿™æ—¶å€™ç‚¹å‡»è¿è¡Œé¡¹ç›®å¦‚æœç­¾åä¸€è‡´å°±ä¼šæ‰“å°å¯†é’¥ï¼Œå¦‚æœä¸ä¸€è‡´å°±ä¼šæ‰“å°ç­¾åé”™è¯¯ã€‚ 6.soçš„ä½¿ç”¨ åœ¨mainæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºjniLibsæœ‰çš„é¡¹ç›®ä¼šæ”¾åœ¨libsä¸­ï¼Œä½†æ˜¯éœ€è¦åœ¨gradleä¸­é…ç½®ç›®å½•ï¼Œå…¶å®æ˜¯ä¸€æ ·çš„ï¼Œå¤åˆ¶æˆ‘ä»¬ä¹‹å‰ç”Ÿæˆçš„soæ–‡ä»¶ã€‚å¤åˆ¶å¯¹åº”çš„JniUtilç±»æ³¨æ„ï¼ŒåŒ…åè¦ä¸ä¹‹å‰åˆ›å»ºçš„soæ—¶çš„åŒ…åä¸€è‡´ã€‚ä¹‹å‰çš„jniæ–‡ä»¶ä¸‹çš„.hå’Œc/c++æºæ–‡ä»¶ä»¥åŠgradleé‡Œé¢é…ç½®çš„ndkä¿¡æ¯ä¹Ÿéƒ½ä¸éœ€è¦äº†ã€‚ å½“ç„¶ å…³äºndkï¼Œjniï¼Œsoçš„ç›¸å…³çŸ¥è¯†å¯èƒ½è¿˜æœ‰å¾ˆå¤šæ¨èå‡ ç¯‡æ–‡ç« ç»™å¤§å®¶å‚è€ƒã€‚ jniè®²è§£ï¼šhttp://www.jianshu.com/p/aba734d5b5cd NDKä¸‹è½½ï¼šhttps://developer.android.com/ndk/downloads/index.html googleå®˜æ–¹NDKä»‹ç»ï¼šhttps://developer.android.google.cn/ndk/guides/index.html ","link":"http://xuanguofeng.com/post/Androidä¸­åˆ›å»ºsoåº“å­˜å‚¨å¯†é’¥ï¼ŒNDKç¯å¢ƒæ­å»ºä¸jniä»‹ç»/"},{"title":"AndroidåŠ¨ç”»å…±äº«å…ƒç´ (ä¾‹åˆ—è¡¨å›¾ç‰‡æ”¾å¤§åˆ°è¯¦æƒ…å›¾ç‰‡åŠ¨ç”»)","content":"ä»€ä¹ˆæ˜¯å…±äº«å…ƒç´  ç®€å•æ¥è¯´å…±äº«å…ƒç´ å°±æ˜¯ä¸¤ä¸ªActivityä¸­éƒ½æ‹¥æœ‰æ­¤å…ƒç´ ï¼Œåœ¨ç¬¬äºŒä¸ªActivityä¸­è¿›è¡Œå¼ºè°ƒè€Œå±•ç¤ºä¸€äº›çš„åŠ¨ç”»æ•ˆæœã€‚ä¾‹å¦‚åœ†æŒ‰é’®çš„æ¼‚ç§»åŠ¨ç”»ã€‚å›¾ç‰‡çš„æ”¾å¤§åŠ¨ç”»ã€‚ ä¸ºä»€ä¹ˆä½¿ç”¨å…±äº«å…ƒç´  ä¸»è¦æ˜¯å› ä¸ºåœ¨Android5.0ä»¥ågoogleæ¨å‡ºäº† Material Designçš„è®¾è®¡é£æ ¼ï¼Œåœ¨Adnroid 5.0ä¹‹åçš„apiä¸­ä¹Ÿæ·»åŠ äº†å¾ˆå¤šå…³äºè¿™ä¸ªé£æ ¼çš„ä¸»é¢˜ä»¥åŠæ§ä»¶ï¼Œä¹Ÿæ›´æ¨å´‡ä¸¤ä¸ªæ§ä»¶ä¹‹é—´çš„è‡ªç„¶çš„è½¬åœºåŠ¨ç”»ã€‚ä½¿é¡µé¢æ›´åŠ è‡ªç„¶ï¼Œç‚«ä¸½ã€‚ æ•ˆæœå±•ç¤º ç®€ä¹¦ä¼¼ä¹å¥½åƒä¸æ”¯æŒgifè¯·æ‰“å¼€æŸ¥çœ‹æ•ˆæœï¼š http://note.youdao.com/noteshare?id=dcb19ac9c6b32e297c1441fa1bab821f ä½¿ç”¨æ–¹æ³• 1.åœ¨ç¬¬ä¸€ä¸ªActivityä¸­çš„æ§ä»¶æ·»åŠ å¦‚ä¸‹å±æ€§ï¼š android:transitionName=&quot;button&quot; &lt;ImageView android:id=&quot;@+id/s2&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;150dp&quot; android:background=&quot;#00ff00&quot; android:transitionName=&quot;image&quot; /&gt; 2.åœ¨ç¬¬äºŒä¸ªActivityä¸­åŒæ ·æ·»åŠ è¿™ä¸ªå±æ€§ï¼š æ³¨æ„ï¼šè¿™ä¸ªåå­—å¿…é¡»ä¸€è‡´ã€‚ 3.ä½¿ç”¨intnetè·³è½¬å³å¯ startActivity(intent, ActivityOptions.makeSceneTransitionAnimation( MainActivity.this,v,&quot;image&quot;).toBundle()); è¿™é‡Œçš„imageå‚æ•°å°±æ˜¯åœ¨android:transitionNameé…ç½®çš„ã€‚è¿™æ ·æˆ‘ä»¬ä¾¿å®ç°æ­¤åŠŸèƒ½ã€‚å…¶å®å¾ˆç®€å•ã€‚ è¿™ä¸ªå±æ€§åº”è¯¥è¿˜æ”¯æŒå…¶ä»–çš„ä¸€äº›æ§ä»¶ï¼Œæ¯”å¦‚æŒ‰é’®buttonç­‰ï¼Œå…·ä½“çš„æ•ˆæœåº”è¯¥ä¹Ÿè¿˜æœ‰å…¶ä»–çš„æ•ˆæœï¼Œå¯ä»¥è‡ªè¡ŒæŸ¥é˜…å®˜æ–¹apiã€‚ ","link":"http://xuanguofeng.com/post/AndroidåŠ¨ç”»å…±äº«å…ƒç´ (ä¾‹åˆ—è¡¨å›¾ç‰‡æ”¾å¤§åˆ°è¯¦æƒ…å›¾ç‰‡åŠ¨ç”»)/"},{"title":"Androidæ‹ç…§æˆ–ä»ç³»ç»Ÿç›¸å†Œè·å–å›¾ç‰‡","content":"æ¦‚è¿° åœ¨åšAndroidå¼€å‘ä¸­è¿˜æ˜¯ä¼šç»å¸¸é€‰æ‹©ç…§ç‰‡ç„¶ååšä¸Šä¼ æ“ä½œçš„ã€‚ä½†æ˜¯å…¶ä¸­é€‰æ‹©ç…§ç‰‡ç³»ç»Ÿçš„æœ‰ä¸¤ç§æ–¹å¼ï¼Œç¬¬ä¸€ç§æ˜¯æ‹ç…§ã€ç¬¬äºŒç§æ˜¯ä»ç›¸å†Œä¸­é€‰æ‹©ã€‚è¿™é‡Œåˆ†åˆ«ä»‹ç»ä¸‹ã€‚ å…¶ä¸­æ‹ç…§æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä»ç³»ç»Ÿç›¸å†Œé€‰æ‹©æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¼šåˆ†åˆ«ä»‹ç»å’Œåˆ†æã€‚ æ‹ç…§è·å–ç…§ç‰‡çš„æ–¹æ³• åˆšæ‰è¯´è¿‡ä¼šä»‹ç»ä¸¤ç§æ–¹æ³•ï¼Œå…¶å®æ— è®ºå‡ ç§æ–¹æ³•åŸç†éƒ½æ˜¯ä¸€ä¸ªã€‚å°±æ˜¯é€šè¿‡intentå‘å‡ºéšå¼æ„å›¾è°ƒç”¨ç³»ç»Ÿçš„ç…§ç›¸æœºï¼Œç„¶ååœ¨è·å–åˆ°ä»ç›¸æœºè¿”å›çš„å›¾ç‰‡ï¼Œè¿™é‡Œçš„ä¸¤ç§ä¸»è¦æ˜¯è¿”å›æ–¹å¼æœ‰ä¸¤ç§ã€‚ 1ã€ç›´æ¥è¿”å›å›¾ç‰‡ã€‚ 2ã€æå‰åˆ›å»ºå¥½å­˜æ”¾å›¾ç‰‡çš„Uriç„¶åæ‹ç…§è¿”å›åå­˜å‚¨èµ·æ¥ã€‚ ç¬¬ä¸€ç§æ‹ç…§æ–¹æ³•ï¼š Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE); startActivityForResult(intent, TAKE_PHOTO_REQUEST); æ²¡é”™ï¼Œç®€å•çš„ä¸¤è¡Œä»£ç å°±å¯ä»¥è°ƒå–æ‘„åƒå¤´è¿›è¡Œæ‹ç…§äº†ï¼Œè¿™æ—¶å€™æˆ‘ä»¬æ˜¯é€šè¿‡IntentæŒ‡å®šactivion: MediaStore.ACTION_IMAGE_CAPTUREå»æŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„ç¨‹åºã€‚ç›¸æœºé‡Œé¢ä¼šå¯¹è¿™ä¸ªactionåšå¤„ç†ï¼Œè¿™ä¸€æ­¥å±äºintentçš„æ“ä½œäº†ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚ case TAKE_PHOTO_REQUEST: if (resultCode == RESULT_CANCELED) { Toast.makeText(MainActivity.this, &quot;å–æ¶ˆäº†æ‹ç…§&quot;, Toast.LENGTH_LONG).show(); return; } Bitmap photo = data.getParcelableExtra(&quot;data&quot;); iv_image.setImageBitmap(photo); break; ä¸Šé¢çš„ä»£ç æ˜¯onActivityResultä¸­çš„å¤„ç†ï¼Œåˆ¤æ–­requestååšæ‹ç…§è¿”å›å¤„ç†ï¼Œå…¶ä¸­dataç›´æ¥è¿”å›Bitmap,ä¸è¿‡è¿™é‡Œè¦æ³¨æ„ä¸€ç‚¹å°±æ˜¯ï¼Œè¿™ä¸ªBitmapä¼šç»è¿‡ç³»ç»Ÿå‹ç¼©ã€‚æ‰€ä»¥æœ‰æ—¶å€™å¯èƒ½çœ‹èµ·æ¥ç…§ç‰‡å¹¶æ²¡æœ‰é‚£ä¹ˆæ¸…æ™°ã€‚ä¹Ÿæ­£æ˜¯ç”±äºæ˜¯ç³»ç»Ÿå‹ç¼©çš„åŸå› ï¼Œè¿™ä¸ªå›¾ç‰‡åŸºæœ¬ä¸ä¼šå¾ˆå¤§ï¼ŒåŸºæœ¬ä¸ä¼šOOMã€‚ ç¬¬äºŒç§æ‹ç…§è·å–ç…§ç‰‡æ–¹æ³•ï¼š ç¬¬äºŒç§æ–¹æ³•å…¶å®ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡æˆ‘ä»¬äº‹å…ˆå®šä¹‰å¥½uri,ç„¶åå›¾ç‰‡ä¼šå­˜å‚¨åˆ°è¿™ä¸ªuriä¸­ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªuriåœ¨æœ¬åœ°æ‰¾åˆ°å…·ä½“çš„å›¾ç‰‡ï¼Œç„¶ååšå¤„ç†ï¼Œå±•ç¤ºã€‚ private static Uri createImageUri(Context context) { String name = &quot;takePhoto&quot; + System.currentTimeMillis(); ContentValues contentValues = new ContentValues(); contentValues.put(MediaStore.Images.Media.TITLE, name); contentValues.put(MediaStore.Images.Media.DISPLAY_NAME, name + &quot;.jpeg&quot;); contentValues.put(MediaStore.Images.Media.MIME_TYPE, &quot;image/jpeg&quot;); Uri uri = context.getContentResolver().insert(MediaStore.Images.Media.EXTERNAL_CONTENT_URI, contentValues); return uri; } ä¸Šè¿°ä»£ç æ˜¯åˆ›å»ºä¸€ä¸ªuriç”¨æ¥å­˜å‚¨æ‹ç…§åçš„ç…§ç‰‡ã€‚ public static void delteImageUri(Context context, Uri uri) { context.getContentResolver().delete(uri, null, null); } ä¸Šè¿°ä»£ç æ˜¯ç”¨æ¥åˆ é™¤ä¸€ä¸ªæœ¬åœ°uri btn_take_photo.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View view) { imageUri = createImageUri(MainActivity.this); Intent intent = new Intent(); intent.setAction(MediaStore.ACTION_IMAGE_CAPTURE); intent.putExtra(MediaStore.EXTRA_OUTPUT, imageUri);//å¦‚æœä¸è®¾ç½®EXTRA_OUTPUT getData() è·å–çš„æ˜¯bitmapæ•°æ® æ˜¯å‹ç¼©åçš„ startActivityForResult(intent, TAKE_PHOTO_REQUEST_ONE); } }); ç„¶åé€šè¿‡ä¸Šè¿°ä»£ç åˆ›å»ºimageUriç„¶åå‘èµ·æ‹ç…§ï¼Œæ–¹å¼åŒæ ·ç”¨Intent,å¯å‚ç¬¬ä¸€ç§æ–¹æ³•ã€‚ if (resultCode == RESULT_CANCELED) { delteImageUri(MainActivity.this,imageUri); return; } case TAKE_PHOTO_REQUEST_ONE: iv_image.setImageURI(imageUri); break; æœ€åå°±æ˜¯è·å–æ‹ç…§çš„ç…§ç‰‡åšå¤„ç†æˆ–è€…æ˜¾ç¤ºã€‚ å…¶ä¸­å¦‚æœå–æ¶ˆçš„è¯å°±åˆ é™¤åˆ›å»ºçš„ruiã€‚ Bitmap bitmap=MediaStore.Images.Media.getBitmap(getContentResolver(),imageUri); iv_image.setImageBitmap(bitmap); è¿˜å¯ä»¥ç›´æ¥é€šè¿‡MediaStoreè·å–bitmapè¿›è¡Œè®¾ç½®ã€‚ ä»¥ä¸Šæ–¹æ³•ç»æµ‹è¯•åœ¨å¯ä»¥æ­£å¸¸è·å–ç…§ç‰‡ã€‚ ä½†æ˜¯è¿™æ ·è¿˜ä¼šæœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¦‚æœå›¾ç‰‡è¿‡å¤§çš„æƒ…å†µä¸‹ï¼Œä¼šæœ‰å¼‚å¸¸ã€‚ W/OpenGLRenderer: Bitmap too large to be uploaded into a texture (3120x4208, max=4096x4096) å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œä¼šç›´æ¥æŠ¥bitmapçš„è¿‡å¤§è€Œæ— æ³•æ˜¾ç¤ºå›¾ç‰‡ã€‚ ç¬¬ä¸€ç§å¤„ç†æ–¹æ³•å°±æ˜¯å¯¹å›¾ç‰‡è¿›è¡Œå¤„ç†ã€‚ è¿™é‡Œä»‹ç»ç¬¬äºŒç§å¤„ç†æ–¹å¼ï¼Œå°±æ˜¯ç”¨ä¸åŒçš„æ–¹å¼å»åˆ›å»ºå­˜å‚¨å›¾ç‰‡çš„æ–‡ä»¶ã€‚ public class TakePhotoUtils { /** * æ‹ç…§ */ public static Uri takePhoto(Activity mActivity, int flag) throws IOException { //æŒ‡å®šæ‹ç…§intent Intent takePictureIntent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE); Uri imageUri = null; if (takePictureIntent.resolveActivity(mActivity.getPackageManager()) != null) { String sdcardState = Environment.getExternalStorageState(); File outputImage = null; if (Environment.MEDIA_MOUNTED.equals(sdcardState)) { outputImage = createImageFile(mActivity); } else { Toast.makeText(mActivity.getApplicationContext(), &quot;å†…å­˜å¼‚å¸¸&quot;, Toast.LENGTH_SHORT).show(); } try { if (outputImage.exists()) { outputImage.delete(); } outputImage.createNewFile(); } catch (IOException e) { e.printStackTrace(); } if (outputImage != null) { imageUri = Uri.fromFile(outputImage); takePictureIntent.putExtra(MediaStore.EXTRA_OUTPUT, imageUri); mActivity.startActivityForResult(takePictureIntent, flag); } } return imageUri; } public static File createImageFile(Activity mActivity) throws IOException { String timeStamp = new SimpleDateFormat(&quot;yyyyMMdd_HHmmss&quot;).format(new Date()); String imageFileName = &quot;JPEG_&quot; + timeStamp;//åˆ›å»ºä»¥æ—¶é—´å‘½åçš„æ–‡ä»¶åç§° File storageDir = getOwnCacheDirectory(mActivity, &quot;takephoto&quot;);//åˆ›å»ºä¿å­˜çš„è·¯å¾„ File image = new File(storageDir.getPath(), imageFileName + &quot;.jpg&quot;); if (!image.exists()) { try { //åœ¨æŒ‡å®šçš„æ–‡ä»¶å¤¹ä¸­åˆ›å»ºæ–‡ä»¶ image.createNewFile(); } catch (Exception e) { } } return image; } /** * æ ¹æ®ç›®å½•åˆ›å»ºæ–‡ä»¶å¤¹ * @param context * @param cacheDir * @return */ public static File getOwnCacheDirectory(Context context, String cacheDir) { File appCacheDir = null; //åˆ¤æ–­sdå¡æ­£å¸¸æŒ‚è½½å¹¶ä¸”æ‹¥æœ‰æƒé™çš„æ—¶å€™åˆ›å»ºæ–‡ä»¶ if ( Environment.MEDIA_MOUNTED.equals(Environment.getExternalStorageState()) &amp;&amp; hasExternalStoragePermission(context)) { appCacheDir = new File(Environment.getExternalStorageDirectory(), cacheDir); } if (appCacheDir == null || !appCacheDir.exists() &amp;&amp; !appCacheDir.mkdirs()) { appCacheDir = context.getCacheDir(); } return appCacheDir; } /** * æ£€æŸ¥æ˜¯å¦æœ‰æƒé™ * @param context * @return */ private static boolean hasExternalStoragePermission(Context context) { int perm = context.checkCallingOrSelfPermission(&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;); return perm == 0; } } ä»£ç æ²¡ä»€ä¹ˆéš¾ç‚¹ï¼Œç®€å•å†™äº†ä¸€ä¸ªå·¥å…·ç±»ï¼Œé‡Œé¢å°è£…äº†ä¸€ä¸ªæ‹ç…§çš„æ–¹æ³•ï¼Œå¹¶è¿”å›ä¸€ä¸ªå­˜å‚¨æ‹ç…§åçš„è·¯å¾„ã€‚ è·¯å¾„æ˜¯è‡ªå·±åˆ¶å®šæ–‡ä»¶å¤¹ååˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œç”¨äºå­˜å‚¨ç…§ç‰‡ã€‚æ–‡ä»¶åæ˜¯æ ¹æ®æ—¶é—´å‘½åçš„ï¼Œä»¥å…é‡å¤ã€‚ if (resultCode == RESULT_CANCELED) { Toast.makeText(MainActivity.this, &quot;ç‚¹å‡»å–æ¶ˆä»ç›¸å†Œé€‰æ‹©&quot;, Toast.LENGTH_LONG).show(); return; } Bitmap bitmap = BitmapFactory.decodeFile(imageUri.getPath(), getOptions(imageUri.getPath())); iv_image.setImageBitmap(bitmap); ç„¶ååœ¨onActivityResultçš„æ–¹æ³•ä¸­è¿›è¡Œå¤„ç†ï¼Œè¿™é‡Œä¹Ÿæœ€å¥½å¯¹å›¾ç‰‡è¿›è¡Œä¸‹å‹ç¼©å¤„ç†ã€‚ç„¶åå°±å¯ä»¥æ­£å¸¸æ˜¾ç¤ºæ‹ç…§åçš„å›¾ç‰‡äº†ã€‚ /** * è·å–å‹ç¼©å›¾ç‰‡çš„options * * @return */ public static BitmapFactory.Options getOptions(String path) { BitmapFactory.Options options = new BitmapFactory.Options(); options.inJustDecodeBounds = true; BitmapFactory.decodeFile(path, options); options.inPreferredConfig = Bitmap.Config.RGB_565; options.inSampleSize = 4; //æ­¤é¡¹å‚æ•°å¯ä»¥æ ¹æ®éœ€æ±‚è¿›è¡Œè®¡ç®— options.inJustDecodeBounds = false; return options; } è¿™é‡Œçš„åªæ˜¯ç®€å•çš„å¤„ç†æ–¹æ³•ï¼ŒæŒ‰ç…§æŒ‡å®šå‚æ•°å‹ç¼©ä¸‹ï¼Œè¿™é‡Œçš„inSapleSizesæ˜¯éœ€è¦æ ¹æ®è‡ªå·±éœ€æ±‚è¿›è¡Œç®—æ³•çš„ã€‚ è¿™æ ·åŸºæœ¬å°±å¯ä»¥é€šè¿‡æ‹ç…§æ¥è·å–ç…§ç‰‡äº† ä»ç›¸å†Œé€‰æ‹©ç…§ç‰‡æ¥å±•ç¤º å…¶å®æ‹ç…§ä¸»è¦ä¹Ÿæ˜¯é€šè¿‡intentæ¥è°ƒç”¨ç³»ç»Ÿç›¸å†Œï¼Œç„¶åé€šè¿‡è¿”å›æ•°æ®åœ¨onActivityResultä¸­è¿›è¡Œå¤„ç†ã€‚ public void pickImageFromAlbum() { Intent intent = new Intent(); intent.setAction(Intent.ACTION_GET_CONTENT); intent.setType(&quot;image/*&quot;); startActivityForResult(intent, 111); } public void pickImageFromAlbum2() { Intent intent = new Intent(); intent.setAction(Intent.ACTION_PICK); intent.setData(MediaStore.Images.Media.EXTERNAL_CONTENT_URI); startActivityForResult(intent, 222); } å¦‚å›¾ä¸¤ç§æ–¹å¼å‡å¯ä»¥è°ƒç”¨ç³»ç»Ÿç›¸å†Œè¿›è¡Œé€‰æ‹©ç…§ç‰‡ã€‚ if (resultCode == RESULT_CANCELED) { Toast.makeText(MainActivity.this, &quot;ç‚¹å‡»å–æ¶ˆä»ç›¸å†Œé€‰æ‹©&quot;, Toast.LENGTH_LONG).show(); return; } try { Uri imageUri = data.getData(); Log.e(&quot;TAG&quot;, imageUri.toString()); iv_image.setImageURI(imageUri); } catch (Exception e) { e.printStackTrace(); } ç„¶åè¿”å›çš„å¤„ç†æ–¹å¼åŸºæœ¬æ˜¯ä¸€æ ·çš„ æ‹¿åˆ°uriåè¿›è¡Œå¯¹å›¾ç‰‡å¤„ç†å°±å¥½äº†ã€‚è¿™é‡Œè¯´æ˜ä¸‹å¦‚æœå›¾ç‰‡è¿‡å¤§å¯èƒ½ä¹Ÿéœ€è¦è¿›è¡ŒäºŒæ¬¡å¤„ç†ã€‚ å¦‚æœ¬ç¯‡æœ‰é”™è¯¯æ¬¢è¿å¤§å®¶ç•™è¨€æŒ‡æ­£ã€‚ demoæºç åœ°å€:https://github.com/xuanguofeng/TakeAndChoosePhoto ","link":"http://xuanguofeng.com/post/Androidæ‹ç…§æˆ–ä»ç³»ç»Ÿç›¸å†Œè·å–å›¾ç‰‡/"},{"title":"Androidå¸ƒå±€ä¼˜åŒ–mergeã€ViewStubçš„ç”¨æ³•","content":"æè¿° ç”±äºåœ¨Androidå¼€å‘å·¥ç¨‹ä¸­éœ€è¦å¼€å‘å¾ˆå¤šç•Œé¢ï¼Œæ¯ä¸ªç•Œé¢åˆæ˜¯ä»¥xmlå¸ƒå±€çš„å½¢å¼è¿›è¡ŒåŠ è½½ã€‚æ‰€ä»¥åœ¨åŠ è½½è¿™äº›å¸ƒå±€æ–‡ä»¶çš„æ—¶å€™æ˜¯ä¸€ä¸ªå¼€é”€å¾ˆå¤§çš„è¿‡ç¨‹ã€‚å› æ­¤æˆ‘ä»¬åœ¨å†™å¸ƒå±€æ–‡ä»¶çš„æ—¶å€™éœ€è¦è€ƒè™‘ä¸€äº›ä¼˜åŒ–æ¥åŠ å¿«ç¨‹åºçš„æ€§èƒ½. æ€§èƒ½æ–¹é¢ä¼˜åŒ– å°½é‡é¿å…å¤šå±‚æ¬¡çš„åµŒå¥—ï¼Œå› ä¸ºå¸ƒå±€å¯ä»¥æ— é™åˆ¶çš„è¿›è¡ŒåµŒå¥—ã€‚æ‰€ä»¥å†™èµ·æ¥éš¾å…æœ‰äº›è‚†æ— å¿Œæƒ®ï¼Œä½†æ˜¯å¸ƒå±€ç»“æ„å°½é‡è¦é¿å…å¤šå±‚æ¬¡çš„åµŒå¥—æ¥å‡å°‘å¼€é”€ã€‚æ•°é‡åº”æœ€å¤šä¸è¦è¶…è¿‡10å±‚ã€‚ ä½¿ç”¨mergeæ ‡ç­¾ å¦‚å›¾ï¼Œä½¿ç”¨mergeæ ‡ç­¾å¯ä»¥å‡å°‘å¤šä½™çš„å±‚æ¬¡ç»“æ„ï¼Œå¤šç”¨äºä¸€ä¸ªå¸ƒå±€éœ€è¦åŒ…å«å¦ä¸€ä¸ªå¸ƒå±€çš„æ—¶å€™ï¼Œæˆ–è€…è¿™ä¸€ä¸ªå¸ƒå±€ç”¨åˆ°çš„é‡å¤æ ·å¼æ¯”è¾ƒå¤šã€‚åœ¨åŠ è½½mergeæ ‡ç­¾çš„æ—¶å€™ï¼Œä¸ä¼šåŠ è½½çˆ¶æ§ä»¶ï¼Œåªä¼šåŠ è½½mergeæ ‡ç­¾ä¸­çš„å­viewã€‚mergeæ ‡ç­¾ç»“åˆincludeä¸€èµ·ä½¿ç”¨å¯ä»¥çµæ´»çš„ã€å¯å¤ç”¨æ€§å¼ºçš„åˆ›å»ºå¸ƒå±€ã€‚ é¿å…è¿‡å¤šçš„viewï¼Œå¡«å……æ¯ä¸ªviewéƒ½è¦èŠ±è´¹ä¸€äº›èµ„æºå’Œæ—¶é—´ï¼Œä¸ºäº†æ›´å¿«é€ŸåŠ è½½ï¼Œåº”å°½é‡å‡å°‘viewçš„åŠ è½½ã€‚å¦‚æœå¸ƒå±€åŒ…å«çš„viewä¸ªæ•°è¶…è¿‡80ï¼Œå¡«å……å¸ƒå±€èŠ±è´¹çš„æ—¶é—´å°†æˆä¸ºä¸€ä¸ªæ˜¾è‘—çš„é—®é¢˜ã€‚ ä½¿ç”¨ViewStub ViewStubæœ‰ä¸€ä¸ªæ¯”è¾ƒå¤§çš„ä¼˜ç‚¹å°±æ˜¯å½“ä½ ç”¨åˆ°è¿™ä¸ªå¸ƒå±€çš„æ—¶å€™æ‰ä¼šå»åŠ è½½ï¼Œä¾‹å¦‚æˆ‘ä»¬åœ¨å¸ƒå±€é‡Œå†™äº†ViewStubå¹¶å¼•ç”¨ä¸€ä¸ªæˆ‘ä»¬å†™å¥½çš„å¸ƒå±€ã€‚è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬çš„activityä¸­ä½¿ç”¨çš„æ—¶å€™ï¼Œå¿…é¡»å…ˆè®¾ç½®visibleã€‚ è¿™æ ·è¿™ä¸ªå¸ƒå±€æ‰ä¼šè¢«åŠ è½½æ˜¾ç¤ºã€‚å¦åˆ™æ˜¯ä¸ä¼šæ˜¾ç¤ºçš„ã€‚ä¸ºäº†é˜²æ­¢éƒ½findViewById æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨inflate()æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªviewï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¯¹è¿™ä¸ªviewè¿›è¡Œæ“ä½œã€‚ ä»£ç å¯è§†æ€§çš„ä¼˜åŒ–ã€‚ å†™å¸ƒå±€çš„æ—¶å€™ï¼Œå¯ä»¥å°½é‡åœ¨çˆ¶æ§ä»¶ä¸­åšæ“ä½œï¼Œè¿™æ ·ä¼šå½±å“åˆ°æ¯ä¸ªå­viewã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ç»å¸¸å†™è·ç¦»å·¦è¾¹è·ï¼Œè¿™ä¸ªæ—¶å€™ä¸€ä¸ªåœ¨çˆ¶æ¯å±€ä¸­å†™ä¸€æ¬¡ï¼Œè€Œä¸æ˜¯åœ¨æ¯ä¸ªå­æ§ä»¶ä¸­éƒ½å†™ä¸€éã€‚ å†™çº¿æ€§å¸ƒå±€çš„æ—¶å€™å¯ä»¥ä½¿ç”¨æƒé‡ï¼Œè¿™æ ·ä¹Ÿä¼šå¯¹å±å¹•é€‚é…èµ·ä½œç”¨ã€‚ Android studioä¸­å¯ä»¥ç›´æ¥å¯¹å¤šæ¬¡é‡ç”¨çš„ç©ºé—´è¿›è¡Œå±æ€§æŠ½å–ã€‚ å¦‚å›¾ï¼ŒæŠ½å–çš„å±æ€§å°†ä¼šåœ¨styleä¸­ï¼Œæˆ‘ä»¬åœ¨å¸ƒå±€æ–‡ä»¶ä¸­å°±å¯ä»¥ç›´æ¥å¼•ç”¨ã€‚å¤šæ¬¡éœ€è¦ç”¨åˆ°è¿™ä¸ªå±æ€§çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨ä¸€è¡Œä»£ç å¼•ç”¨å³å¯ã€‚ ä½¿ç”¨includeæ ‡ç­¾ï¼Œæ¥å¼•ç”¨æ¯”è¾ƒå¤æ‚ï¼Œæˆ–è€…æŠ½è±¡çš„å¸ƒå±€æ–‡ä»¶ã€‚ ","link":"http://xuanguofeng.com/post/Androidå¸ƒå±€ä¼˜åŒ–mergeã€ViewStubçš„ç”¨æ³•/"}]}